(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Cn(t){const e=Object.create(null);for(const s of t.split(","))e[s]=1;return s=>s in e}const me={},$s=[],vt=()=>{},dl=()=>!1,ti=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Tn=t=>t.startsWith("onUpdate:"),Ne=Object.assign,En=(t,e)=>{const s=t.indexOf(e);s>-1&&t.splice(s,1)},ul=Object.prototype.hasOwnProperty,de=(t,e)=>ul.call(t,e),X=Array.isArray,As=t=>si(t)==="[object Map]",ta=t=>si(t)==="[object Set]",Z=t=>typeof t=="function",_e=t=>typeof t=="string",jt=t=>typeof t=="symbol",Ee=t=>t!==null&&typeof t=="object",sa=t=>(Ee(t)||Z(t))&&Z(t.then)&&Z(t.catch),ra=Object.prototype.toString,si=t=>ra.call(t),hl=t=>si(t).slice(8,-1),ia=t=>si(t)==="[object Object]",Sn=t=>_e(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,zs=Cn(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ri=t=>{const e=Object.create(null);return s=>e[s]||(e[s]=t(s))},fl=/-(\w)/g,ft=ri(t=>t.replace(fl,(e,s)=>s?s.toUpperCase():"")),gl=/\B([A-Z])/g,rs=ri(t=>t.replace(gl,"-$1").toLowerCase()),ii=ri(t=>t.charAt(0).toUpperCase()+t.slice(1)),_i=ri(t=>t?`on${ii(t)}`:""),Qt=(t,e)=>!Object.is(t,e),Ar=(t,...e)=>{for(let s=0;s<t.length;s++)t[s](...e)},na=(t,e,s,r=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:r,value:s})},zi=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Qn;const ni=()=>Qn||(Qn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ae(t){if(X(t)){const e={};for(let s=0;s<t.length;s++){const r=t[s],i=_e(r)?bl(r):ae(r);if(i)for(const n in i)e[n]=i[n]}return e}else if(_e(t)||Ee(t))return t}const pl=/;(?![^(]*\))/g,ml=/:([^]+)/,vl=/\/\*[^]*?\*\//g;function bl(t){const e={};return t.replace(vl,"").split(pl).forEach(s=>{if(s){const r=s.split(ml);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Te(t){let e="";if(_e(t))e=t;else if(X(t))for(let s=0;s<t.length;s++){const r=Te(t[s]);r&&(e+=r+" ")}else if(Ee(t))for(const s in t)t[s]&&(e+=s+" ");return e.trim()}const wl="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",yl=Cn(wl);function oa(t){return!!t||t===""}const aa=t=>!!(t&&t.__v_isRef===!0),Ie=t=>_e(t)?t:t==null?"":X(t)||Ee(t)&&(t.toString===ra||!Z(t.toString))?aa(t)?Ie(t.value):JSON.stringify(t,ca,2):String(t),ca=(t,e)=>aa(e)?ca(t,e.value):As(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((s,[r,i],n)=>(s[Ri(r,n)+" =>"]=i,s),{})}:ta(e)?{[`Set(${e.size})`]:[...e.values()].map(s=>Ri(s))}:jt(e)?Ri(e):Ee(e)&&!X(e)&&!ia(e)?String(e):e,Ri=(t,e="")=>{var s;return jt(t)?`Symbol(${(s=t.description)!=null?s:e})`:t};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ke;class la{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ke,!e&&Ke&&(this.index=(Ke.scopes||(Ke.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,s;if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].pause();for(e=0,s=this.effects.length;e<s;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,s;if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].resume();for(e=0,s=this.effects.length;e<s;e++)this.effects[e].resume()}}run(e){if(this._active){const s=Ke;try{return Ke=this,e()}finally{Ke=s}}}on(){Ke=this}off(){Ke=this.parent}stop(e){if(this._active){this._active=!1;let s,r;for(s=0,r=this.effects.length;s<r;s++)this.effects[s].stop();for(this.effects.length=0,s=0,r=this.cleanups.length;s<r;s++)this.cleanups[s]();if(this.cleanups.length=0,this.scopes){for(s=0,r=this.scopes.length;s<r;s++)this.scopes[s].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function da(t){return new la(t)}function ua(){return Ke}function xl(t,e=!1){Ke&&Ke.cleanups.push(t)}let be;const $i=new WeakSet;class ha{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ke&&Ke.active&&Ke.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,$i.has(this)&&($i.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||ga(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,eo(this),pa(this);const e=be,s=bt;be=this,bt=!0;try{return this.fn()}finally{ma(this),be=e,bt=s,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)$n(e);this.deps=this.depsTail=void 0,eo(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?$i.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Xi(this)&&this.run()}get dirty(){return Xi(this)}}let fa=0,Xs,Js;function ga(t,e=!1){if(t.flags|=8,e){t.next=Js,Js=t;return}t.next=Xs,Xs=t}function _n(){fa++}function Rn(){if(--fa>0)return;if(Js){let e=Js;for(Js=void 0;e;){const s=e.next;e.next=void 0,e.flags&=-9,e=s}}let t;for(;Xs;){let e=Xs;for(Xs=void 0;e;){const s=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){t||(t=r)}e=s}}if(t)throw t}function pa(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function ma(t){let e,s=t.depsTail,r=s;for(;r;){const i=r.prevDep;r.version===-1?(r===s&&(s=i),$n(r),Cl(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=i}t.deps=e,t.depsTail=s}function Xi(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(va(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function va(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===ir))return;t.globalVersion=ir;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!Xi(t)){t.flags&=-3;return}const s=be,r=bt;be=t,bt=!0;try{pa(t);const i=t.fn(t._value);(e.version===0||Qt(i,t._value))&&(t._value=i,e.version++)}catch(i){throw e.version++,i}finally{be=s,bt=r,ma(t),t.flags&=-3}}function $n(t,e=!1){const{dep:s,prevSub:r,nextSub:i}=t;if(r&&(r.nextSub=i,t.prevSub=void 0),i&&(i.prevSub=r,t.nextSub=void 0),s.subs===t&&(s.subs=r,!r&&s.computed)){s.computed.flags&=-5;for(let n=s.computed.deps;n;n=n.nextDep)$n(n,!0)}!e&&!--s.sc&&s.map&&s.map.delete(s.key)}function Cl(t){const{prevDep:e,nextDep:s}=t;e&&(e.nextDep=s,t.prevDep=void 0),s&&(s.prevDep=e,t.nextDep=void 0)}let bt=!0;const ba=[];function is(){ba.push(bt),bt=!1}function ns(){const t=ba.pop();bt=t===void 0?!0:t}function eo(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const s=be;be=void 0;try{e()}finally{be=s}}}let ir=0;class Tl{constructor(e,s){this.sub=e,this.dep=s,this.version=s.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class An{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!be||!bt||be===this.computed)return;let s=this.activeLink;if(s===void 0||s.sub!==be)s=this.activeLink=new Tl(be,this),be.deps?(s.prevDep=be.depsTail,be.depsTail.nextDep=s,be.depsTail=s):be.deps=be.depsTail=s,wa(s);else if(s.version===-1&&(s.version=this.version,s.nextDep)){const r=s.nextDep;r.prevDep=s.prevDep,s.prevDep&&(s.prevDep.nextDep=r),s.prevDep=be.depsTail,s.nextDep=void 0,be.depsTail.nextDep=s,be.depsTail=s,be.deps===s&&(be.deps=r)}return s}trigger(e){this.version++,ir++,this.notify(e)}notify(e){_n();try{for(let s=this.subs;s;s=s.prevSub)s.sub.notify()&&s.sub.dep.notify()}finally{Rn()}}}function wa(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)wa(r)}const s=t.dep.subs;s!==t&&(t.prevSub=s,s&&(s.nextSub=t)),t.dep.subs=t}}const Nr=new WeakMap,ps=Symbol(""),Ji=Symbol(""),nr=Symbol("");function Ue(t,e,s){if(bt&&be){let r=Nr.get(t);r||Nr.set(t,r=new Map);let i=r.get(s);i||(r.set(s,i=new An),i.map=r,i.key=s),i.track()}}function Ft(t,e,s,r,i,n){const o=Nr.get(t);if(!o){ir++;return}const a=c=>{c&&c.trigger()};if(_n(),e==="clear")o.forEach(a);else{const c=X(t),d=c&&Sn(s);if(c&&s==="length"){const l=Number(r);o.forEach((u,p)=>{(p==="length"||p===nr||!jt(p)&&p>=l)&&a(u)})}else switch((s!==void 0||o.has(void 0))&&a(o.get(s)),d&&a(o.get(nr)),e){case"add":c?d&&a(o.get("length")):(a(o.get(ps)),As(t)&&a(o.get(Ji)));break;case"delete":c||(a(o.get(ps)),As(t)&&a(o.get(Ji)));break;case"set":As(t)&&a(o.get(ps));break}}Rn()}function El(t,e){const s=Nr.get(t);return s&&s.get(e)}function Cs(t){const e=oe(t);return e===t?e:(Ue(e,"iterate",nr),ut(t)?e:e.map(je))}function oi(t){return Ue(t=oe(t),"iterate",nr),t}const Sl={__proto__:null,[Symbol.iterator](){return Ai(this,Symbol.iterator,je)},concat(...t){return Cs(this).concat(...t.map(e=>X(e)?Cs(e):e))},entries(){return Ai(this,"entries",t=>(t[1]=je(t[1]),t))},every(t,e){return kt(this,"every",t,e,void 0,arguments)},filter(t,e){return kt(this,"filter",t,e,s=>s.map(je),arguments)},find(t,e){return kt(this,"find",t,e,je,arguments)},findIndex(t,e){return kt(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return kt(this,"findLast",t,e,je,arguments)},findLastIndex(t,e){return kt(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return kt(this,"forEach",t,e,void 0,arguments)},includes(...t){return Ii(this,"includes",t)},indexOf(...t){return Ii(this,"indexOf",t)},join(t){return Cs(this).join(t)},lastIndexOf(...t){return Ii(this,"lastIndexOf",t)},map(t,e){return kt(this,"map",t,e,void 0,arguments)},pop(){return js(this,"pop")},push(...t){return js(this,"push",t)},reduce(t,...e){return to(this,"reduce",t,e)},reduceRight(t,...e){return to(this,"reduceRight",t,e)},shift(){return js(this,"shift")},some(t,e){return kt(this,"some",t,e,void 0,arguments)},splice(...t){return js(this,"splice",t)},toReversed(){return Cs(this).toReversed()},toSorted(t){return Cs(this).toSorted(t)},toSpliced(...t){return Cs(this).toSpliced(...t)},unshift(...t){return js(this,"unshift",t)},values(){return Ai(this,"values",je)}};function Ai(t,e,s){const r=oi(t),i=r[e]();return r!==t&&!ut(t)&&(i._next=i.next,i.next=()=>{const n=i._next();return n.value&&(n.value=s(n.value)),n}),i}const _l=Array.prototype;function kt(t,e,s,r,i,n){const o=oi(t),a=o!==t&&!ut(t),c=o[e];if(c!==_l[e]){const u=c.apply(t,n);return a?je(u):u}let d=s;o!==t&&(a?d=function(u,p){return s.call(this,je(u),p,t)}:s.length>2&&(d=function(u,p){return s.call(this,u,p,t)}));const l=c.call(o,d,r);return a&&i?i(l):l}function to(t,e,s,r){const i=oi(t);let n=s;return i!==t&&(ut(t)?s.length>3&&(n=function(o,a,c){return s.call(this,o,a,c,t)}):n=function(o,a,c){return s.call(this,o,je(a),c,t)}),i[e](n,...r)}function Ii(t,e,s){const r=oe(t);Ue(r,"iterate",nr);const i=r[e](...s);return(i===-1||i===!1)&&Hn(s[0])?(s[0]=oe(s[0]),r[e](...s)):i}function js(t,e,s=[]){is(),_n();const r=oe(t)[e].apply(t,s);return Rn(),ns(),r}const Rl=Cn("__proto__,__v_isRef,__isVue"),ya=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(jt));function $l(t){jt(t)||(t=String(t));const e=oe(this);return Ue(e,"has",t),e.hasOwnProperty(t)}class xa{constructor(e=!1,s=!1){this._isReadonly=e,this._isShallow=s}get(e,s,r){if(s==="__v_skip")return e.__v_skip;const i=this._isReadonly,n=this._isShallow;if(s==="__v_isReactive")return!i;if(s==="__v_isReadonly")return i;if(s==="__v_isShallow")return n;if(s==="__v_raw")return r===(i?n?Fl:Sa:n?Ea:Ta).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=X(e);if(!i){let c;if(o&&(c=Sl[s]))return c;if(s==="hasOwnProperty")return $l}const a=Reflect.get(e,s,Se(e)?e:r);return(jt(s)?ya.has(s):Rl(s))||(i||Ue(e,"get",s),n)?a:Se(a)?o&&Sn(s)?a:a.value:Ee(a)?i?_a(a):ai(a):a}}class Ca extends xa{constructor(e=!1){super(!1,e)}set(e,s,r,i){let n=e[s];if(!this._isShallow){const c=ws(n);if(!ut(r)&&!ws(r)&&(n=oe(n),r=oe(r)),!X(e)&&Se(n)&&!Se(r))return c?!1:(n.value=r,!0)}const o=X(e)&&Sn(s)?Number(s)<e.length:de(e,s),a=Reflect.set(e,s,r,Se(e)?e:i);return e===oe(i)&&(o?Qt(r,n)&&Ft(e,"set",s,r):Ft(e,"add",s,r)),a}deleteProperty(e,s){const r=de(e,s);e[s];const i=Reflect.deleteProperty(e,s);return i&&r&&Ft(e,"delete",s,void 0),i}has(e,s){const r=Reflect.has(e,s);return(!jt(s)||!ya.has(s))&&Ue(e,"has",s),r}ownKeys(e){return Ue(e,"iterate",X(e)?"length":ps),Reflect.ownKeys(e)}}class Al extends xa{constructor(e=!1){super(!0,e)}set(e,s){return!0}deleteProperty(e,s){return!0}}const Il=new Ca,Dl=new Al,Hl=new Ca(!0);const Zi=t=>t,Tr=t=>Reflect.getPrototypeOf(t);function Pl(t,e,s){return function(...r){const i=this.__v_raw,n=oe(i),o=As(n),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,d=i[t](...r),l=s?Zi:e?Qi:je;return!e&&Ue(n,"iterate",c?Ji:ps),{next(){const{value:u,done:p}=d.next();return p?{value:u,done:p}:{value:a?[l(u[0]),l(u[1])]:l(u),done:p}},[Symbol.iterator](){return this}}}}function Er(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function kl(t,e){const s={get(i){const n=this.__v_raw,o=oe(n),a=oe(i);t||(Qt(i,a)&&Ue(o,"get",i),Ue(o,"get",a));const{has:c}=Tr(o),d=e?Zi:t?Qi:je;if(c.call(o,i))return d(n.get(i));if(c.call(o,a))return d(n.get(a));n!==o&&n.get(i)},get size(){const i=this.__v_raw;return!t&&Ue(oe(i),"iterate",ps),Reflect.get(i,"size",i)},has(i){const n=this.__v_raw,o=oe(n),a=oe(i);return t||(Qt(i,a)&&Ue(o,"has",i),Ue(o,"has",a)),i===a?n.has(i):n.has(i)||n.has(a)},forEach(i,n){const o=this,a=o.__v_raw,c=oe(a),d=e?Zi:t?Qi:je;return!t&&Ue(c,"iterate",ps),a.forEach((l,u)=>i.call(n,d(l),d(u),o))}};return Ne(s,t?{add:Er("add"),set:Er("set"),delete:Er("delete"),clear:Er("clear")}:{add(i){!e&&!ut(i)&&!ws(i)&&(i=oe(i));const n=oe(this);return Tr(n).has.call(n,i)||(n.add(i),Ft(n,"add",i,i)),this},set(i,n){!e&&!ut(n)&&!ws(n)&&(n=oe(n));const o=oe(this),{has:a,get:c}=Tr(o);let d=a.call(o,i);d||(i=oe(i),d=a.call(o,i));const l=c.call(o,i);return o.set(i,n),d?Qt(n,l)&&Ft(o,"set",i,n):Ft(o,"add",i,n),this},delete(i){const n=oe(this),{has:o,get:a}=Tr(n);let c=o.call(n,i);c||(i=oe(i),c=o.call(n,i)),a&&a.call(n,i);const d=n.delete(i);return c&&Ft(n,"delete",i,void 0),d},clear(){const i=oe(this),n=i.size!==0,o=i.clear();return n&&Ft(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{s[i]=Pl(i,t,e)}),s}function In(t,e){const s=kl(t,e);return(r,i,n)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?r:Reflect.get(de(s,i)&&i in r?s:r,i,n)}const Ol={get:In(!1,!1)},Ll={get:In(!1,!0)},Ml={get:In(!0,!1)};const Ta=new WeakMap,Ea=new WeakMap,Sa=new WeakMap,Fl=new WeakMap;function Nl(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ql(t){return t.__v_skip||!Object.isExtensible(t)?0:Nl(hl(t))}function ai(t){return ws(t)?t:Dn(t,!1,Il,Ol,Ta)}function Bl(t){return Dn(t,!1,Hl,Ll,Ea)}function _a(t){return Dn(t,!0,Dl,Ml,Sa)}function Dn(t,e,s,r,i){if(!Ee(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const n=i.get(t);if(n)return n;const o=ql(t);if(o===0)return t;const a=new Proxy(t,o===2?r:s);return i.set(t,a),a}function es(t){return ws(t)?es(t.__v_raw):!!(t&&t.__v_isReactive)}function ws(t){return!!(t&&t.__v_isReadonly)}function ut(t){return!!(t&&t.__v_isShallow)}function Hn(t){return t?!!t.__v_raw:!1}function oe(t){const e=t&&t.__v_raw;return e?oe(e):t}function Pn(t){return!de(t,"__v_skip")&&Object.isExtensible(t)&&na(t,"__v_skip",!0),t}const je=t=>Ee(t)?ai(t):t,Qi=t=>Ee(t)?_a(t):t;function Se(t){return t?t.__v_isRef===!0:!1}function se(t){return Ul(t,!1)}function Ul(t,e){return Se(t)?t:new jl(t,e)}class jl{constructor(e,s){this.dep=new An,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=s?e:oe(e),this._value=s?e:je(e),this.__v_isShallow=s}get value(){return this.dep.track(),this._value}set value(e){const s=this._rawValue,r=this.__v_isShallow||ut(e)||ws(e);e=r?e:oe(e),Qt(e,s)&&(this._rawValue=e,this._value=r?e:je(e),this.dep.trigger())}}function q(t){return Se(t)?t.value:t}const Vl={get:(t,e,s)=>e==="__v_raw"?t:q(Reflect.get(t,e,s)),set:(t,e,s,r)=>{const i=t[e];return Se(i)&&!Se(s)?(i.value=s,!0):Reflect.set(t,e,s,r)}};function Ra(t){return es(t)?t:new Proxy(t,Vl)}function Wl(t){const e=X(t)?new Array(t.length):{};for(const s in t)e[s]=Kl(t,s);return e}class Yl{constructor(e,s,r){this._object=e,this._key=s,this._defaultValue=r,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return El(oe(this._object),this._key)}}function Kl(t,e,s){const r=t[e];return Se(r)?r:new Yl(t,e,s)}class Gl{constructor(e,s,r){this.fn=e,this.setter=s,this._value=void 0,this.dep=new An(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ir-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!s,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&be!==this)return ga(this,!0),!0}get value(){const e=this.dep.track();return va(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function zl(t,e,s=!1){let r,i;return Z(t)?r=t:(r=t.get,i=t.set),new Gl(r,i,s)}const Sr={},qr=new WeakMap;let us;function Xl(t,e=!1,s=us){if(s){let r=qr.get(s);r||qr.set(s,r=[]),r.push(t)}}function Jl(t,e,s=me){const{immediate:r,deep:i,once:n,scheduler:o,augmentJob:a,call:c}=s,d=R=>i?R:ut(R)||i===!1||i===0?Nt(R,1):Nt(R);let l,u,p,y,w=!1,C=!1;if(Se(t)?(u=()=>t.value,w=ut(t)):es(t)?(u=()=>d(t),w=!0):X(t)?(C=!0,w=t.some(R=>es(R)||ut(R)),u=()=>t.map(R=>{if(Se(R))return R.value;if(es(R))return d(R);if(Z(R))return c?c(R,2):R()})):Z(t)?e?u=c?()=>c(t,2):t:u=()=>{if(p){is();try{p()}finally{ns()}}const R=us;us=l;try{return c?c(t,3,[y]):t(y)}finally{us=R}}:u=vt,e&&i){const R=u,W=i===!0?1/0:i;u=()=>Nt(R(),W)}const A=ua(),f=()=>{l.stop(),A&&A.active&&En(A.effects,l)};if(n&&e){const R=e;e=(...W)=>{R(...W),f()}}let I=C?new Array(t.length).fill(Sr):Sr;const j=R=>{if(!(!(l.flags&1)||!l.dirty&&!R))if(e){const W=l.run();if(i||w||(C?W.some((xe,he)=>Qt(xe,I[he])):Qt(W,I))){p&&p();const xe=us;us=l;try{const he=[W,I===Sr?void 0:C&&I[0]===Sr?[]:I,y];c?c(e,3,he):e(...he),I=W}finally{us=xe}}}else l.run()};return a&&a(j),l=new ha(u),l.scheduler=o?()=>o(j,!1):j,y=R=>Xl(R,!1,l),p=l.onStop=()=>{const R=qr.get(l);if(R){if(c)c(R,4);else for(const W of R)W();qr.delete(l)}},e?r?j(!0):I=l.run():o?o(j.bind(null,!0),!0):l.run(),f.pause=l.pause.bind(l),f.resume=l.resume.bind(l),f.stop=f,f}function Nt(t,e=1/0,s){if(e<=0||!Ee(t)||t.__v_skip||(s=s||new Set,s.has(t)))return t;if(s.add(t),e--,Se(t))Nt(t.value,e,s);else if(X(t))for(let r=0;r<t.length;r++)Nt(t[r],e,s);else if(ta(t)||As(t))t.forEach(r=>{Nt(r,e,s)});else if(ia(t)){for(const r in t)Nt(t[r],e,s);for(const r of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,r)&&Nt(t[r],e,s)}return t}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function gr(t,e,s,r){try{return r?t(...r):t()}catch(i){ci(i,e,s)}}function Dt(t,e,s,r){if(Z(t)){const i=gr(t,e,s,r);return i&&sa(i)&&i.catch(n=>{ci(n,e,s)}),i}if(X(t)){const i=[];for(let n=0;n<t.length;n++)i.push(Dt(t[n],e,s,r));return i}}function ci(t,e,s,r=!0){const i=e?e.vnode:null,{errorHandler:n,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||me;if(e){let a=e.parent;const c=e.proxy,d=`https://vuejs.org/error-reference/#runtime-${s}`;for(;a;){const l=a.ec;if(l){for(let u=0;u<l.length;u++)if(l[u](t,c,d)===!1)return}a=a.parent}if(n){is(),gr(n,null,10,[t,c,d]),ns();return}}Zl(t,s,i,r,o)}function Zl(t,e,s,r=!0,i=!1){if(i)throw t;console.error(t)}const ze=[];let St=-1;const Is=[];let Kt=null,Es=0;const $a=Promise.resolve();let Br=null;function et(t){const e=Br||$a;return t?e.then(this?t.bind(this):t):e}function Ql(t){let e=St+1,s=ze.length;for(;e<s;){const r=e+s>>>1,i=ze[r],n=or(i);n<t||n===t&&i.flags&2?e=r+1:s=r}return e}function kn(t){if(!(t.flags&1)){const e=or(t),s=ze[ze.length-1];!s||!(t.flags&2)&&e>=or(s)?ze.push(t):ze.splice(Ql(e),0,t),t.flags|=1,Aa()}}function Aa(){Br||(Br=$a.then(Ha))}function Ia(t){X(t)?Is.push(...t):Kt&&t.id===-1?Kt.splice(Es+1,0,t):t.flags&1||(Is.push(t),t.flags|=1),Aa()}function so(t,e,s=St+1){for(;s<ze.length;s++){const r=ze[s];if(r&&r.flags&2){if(t&&r.id!==t.uid)continue;ze.splice(s,1),s--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function Da(t){if(Is.length){const e=[...new Set(Is)].sort((s,r)=>or(s)-or(r));if(Is.length=0,Kt){Kt.push(...e);return}for(Kt=e,Es=0;Es<Kt.length;Es++){const s=Kt[Es];s.flags&4&&(s.flags&=-2),s.flags&8||s(),s.flags&=-2}Kt=null,Es=0}}const or=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Ha(t){try{for(St=0;St<ze.length;St++){const e=ze[St];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),gr(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;St<ze.length;St++){const e=ze[St];e&&(e.flags&=-2)}St=-1,ze.length=0,Da(),Br=null,(ze.length||Is.length)&&Ha()}}let He=null,Pa=null;function Ur(t){const e=He;return He=t,Pa=t&&t.type.__scopeId||null,e}function On(t,e=He,s){if(!e||t._n)return t;const r=(...i)=>{r._d&&ho(-1);const n=Ur(e);let o;try{o=t(...i)}finally{Ur(n),r._d&&ho(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function mt(t,e){if(He===null)return t;const s=fi(He),r=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[n,o,a,c=me]=e[i];n&&(Z(n)&&(n={mounted:n,updated:n}),n.deep&&Nt(o),r.push({dir:n,instance:s,value:o,oldValue:void 0,arg:a,modifiers:c}))}return t}function cs(t,e,s,r){const i=t.dirs,n=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];n&&(a.oldValue=n[o].value);let c=a.dir[r];c&&(is(),Dt(c,s,8,[t.el,a,t,e]),ns())}}const ed=Symbol("_vte"),td=t=>t.__isTeleport;function Ln(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Ln(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function Re(t,e){return Z(t)?Ne({name:t.name},e,{setup:t}):t}function ka(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function jr(t,e,s,r,i=!1){if(X(t)){t.forEach((w,C)=>jr(w,e&&(X(e)?e[C]:e),s,r,i));return}if(Ds(r)&&!i){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&jr(t,e,s,r.component.subTree);return}const n=r.shapeFlag&4?fi(r.component):r.el,o=i?null:n,{i:a,r:c}=t,d=e&&e.r,l=a.refs===me?a.refs={}:a.refs,u=a.setupState,p=oe(u),y=u===me?()=>!1:w=>de(p,w);if(d!=null&&d!==c&&(_e(d)?(l[d]=null,y(d)&&(u[d]=null)):Se(d)&&(d.value=null)),Z(c))gr(c,a,12,[o,l]);else{const w=_e(c),C=Se(c);if(w||C){const A=()=>{if(t.f){const f=w?y(c)?u[c]:l[c]:c.value;i?X(f)&&En(f,n):X(f)?f.includes(n)||f.push(n):w?(l[c]=[n],y(c)&&(u[c]=l[c])):(c.value=[n],t.k&&(l[t.k]=c.value))}else w?(l[c]=o,y(c)&&(u[c]=o)):C&&(c.value=o,t.k&&(l[t.k]=o))};o?(A.id=-1,nt(A,s)):A()}}}ni().requestIdleCallback;ni().cancelIdleCallback;const Ds=t=>!!t.type.__asyncLoader,Oa=t=>t.type.__isKeepAlive;function sd(t,e){La(t,"a",e)}function rd(t,e){La(t,"da",e)}function La(t,e,s=Me){const r=t.__wdc||(t.__wdc=()=>{let i=s;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(li(e,r,s),s){let i=s.parent;for(;i&&i.parent;)Oa(i.parent.vnode)&&id(r,e,s,i),i=i.parent}}function id(t,e,s,r){const i=li(e,t,r,!0);di(()=>{En(r[e],i)},s)}function li(t,e,s=Me,r=!1){if(s){const i=s[t]||(s[t]=[]),n=e.__weh||(e.__weh=(...o)=>{is();const a=mr(s),c=Dt(e,s,t,o);return a(),ns(),c});return r?i.unshift(n):i.push(n),n}}const Vt=t=>(e,s=Me)=>{(!cr||t==="sp")&&li(t,(...r)=>e(...r),s)},nd=Vt("bm"),pr=Vt("m"),Ma=Vt("bu"),od=Vt("u"),Fa=Vt("bum"),di=Vt("um"),ad=Vt("sp"),cd=Vt("rtg"),ld=Vt("rtc");function dd(t,e=Me){li("ec",t,e)}const ud="components",Na=Symbol.for("v-ndc");function hd(t){return _e(t)?fd(ud,t,!1)||t:t||Na}function fd(t,e,s=!0,r=!1){const i=He||Me;if(i){const n=i.type;{const a=ru(n,!1);if(a&&(a===e||a===ft(e)||a===ii(ft(e))))return n}const o=ro(i[t]||n[t],e)||ro(i.appContext[t],e);return!o&&r?n:o}}function ro(t,e){return t&&(t[e]||t[ft(e)]||t[ii(ft(e))])}function qa(t,e,s,r){let i;const n=s,o=X(t);if(o||_e(t)){const a=o&&es(t);let c=!1;a&&(c=!ut(t),t=oi(t)),i=new Array(t.length);for(let d=0,l=t.length;d<l;d++)i[d]=e(c?je(t[d]):t[d],d,void 0,n)}else if(typeof t=="number"){i=new Array(t);for(let a=0;a<t;a++)i[a]=e(a+1,a,void 0,n)}else if(Ee(t))if(t[Symbol.iterator])i=Array.from(t,(a,c)=>e(a,c,void 0,n));else{const a=Object.keys(t);i=new Array(a.length);for(let c=0,d=a.length;c<d;c++){const l=a[c];i[c]=e(t[l],l,c,n)}}else i=[];return i}function gd(t,e,s={},r,i){if(He.ce||He.parent&&Ds(He.parent)&&He.parent.ce)return V(),Xe(pe,null,[ue("slot",s,r)],64);let n=t[e];n&&n._c&&(n._d=!1),V();const o=n&&Ba(n(s)),a=s.key||o&&o.key,c=Xe(pe,{key:(a&&!jt(a)?a:`_${e}`)+(!o&&r?"_fb":"")},o||[],o&&t._===1?64:-2);return c.scopeId&&(c.slotScopeIds=[c.scopeId+"-s"]),n&&n._c&&(n._d=!0),c}function Ba(t){return t.some(e=>Nn(e)?!(e.type===ts||e.type===pe&&!Ba(e.children)):!0)?t:null}const en=t=>t?ac(t)?fi(t):en(t.parent):null,Zs=Ne(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>en(t.parent),$root:t=>en(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Mn(t),$forceUpdate:t=>t.f||(t.f=()=>{kn(t.update)}),$nextTick:t=>t.n||(t.n=et.bind(t.proxy)),$watch:t=>Md.bind(t)}),Di=(t,e)=>t!==me&&!t.__isScriptSetup&&de(t,e),pd={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:s,setupState:r,data:i,props:n,accessCache:o,type:a,appContext:c}=t;let d;if(e[0]!=="$"){const y=o[e];if(y!==void 0)switch(y){case 1:return r[e];case 2:return i[e];case 4:return s[e];case 3:return n[e]}else{if(Di(r,e))return o[e]=1,r[e];if(i!==me&&de(i,e))return o[e]=2,i[e];if((d=t.propsOptions[0])&&de(d,e))return o[e]=3,n[e];if(s!==me&&de(s,e))return o[e]=4,s[e];tn&&(o[e]=0)}}const l=Zs[e];let u,p;if(l)return e==="$attrs"&&Ue(t.attrs,"get",""),l(t);if((u=a.__cssModules)&&(u=u[e]))return u;if(s!==me&&de(s,e))return o[e]=4,s[e];if(p=c.config.globalProperties,de(p,e))return p[e]},set({_:t},e,s){const{data:r,setupState:i,ctx:n}=t;return Di(i,e)?(i[e]=s,!0):r!==me&&de(r,e)?(r[e]=s,!0):de(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(n[e]=s,!0)},has({_:{data:t,setupState:e,accessCache:s,ctx:r,appContext:i,propsOptions:n}},o){let a;return!!s[o]||t!==me&&de(t,o)||Di(e,o)||(a=n[0])&&de(a,o)||de(r,o)||de(Zs,o)||de(i.config.globalProperties,o)},defineProperty(t,e,s){return s.get!=null?t._.accessCache[e]=0:de(s,"value")&&this.set(t,e,s.value,null),Reflect.defineProperty(t,e,s)}};function io(t){return X(t)?t.reduce((e,s)=>(e[s]=null,e),{}):t}let tn=!0;function md(t){const e=Mn(t),s=t.proxy,r=t.ctx;tn=!1,e.beforeCreate&&no(e.beforeCreate,t,"bc");const{data:i,computed:n,methods:o,watch:a,provide:c,inject:d,created:l,beforeMount:u,mounted:p,beforeUpdate:y,updated:w,activated:C,deactivated:A,beforeDestroy:f,beforeUnmount:I,destroyed:j,unmounted:R,render:W,renderTracked:xe,renderTriggered:he,errorCaptured:h,serverPrefetch:ee,expose:we,inheritAttrs:b,components:T,directives:x,filters:ke}=e;if(d&&vd(d,r,null),o)for(const M in o){const fe=o[M];Z(fe)&&(r[M]=fe.bind(s))}if(i){const M=i.call(s,s);Ee(M)&&(t.data=ai(M))}if(tn=!0,n)for(const M in n){const fe=n[M],Pt=Z(fe)?fe.bind(s,s):Z(fe.get)?fe.get.bind(s,s):vt,xr=!Z(fe)&&Z(fe.set)?fe.set.bind(s):vt,as=wt({get:Pt,set:xr});Object.defineProperty(r,M,{enumerable:!0,configurable:!0,get:()=>as.value,set:xt=>as.value=xt})}if(a)for(const M in a)Ua(a[M],r,s,M);if(c){const M=Z(c)?c.call(s):c;Reflect.ownKeys(M).forEach(fe=>{Td(fe,M[fe])})}l&&no(l,t,"c");function re(M,fe){X(fe)?fe.forEach(Pt=>M(Pt.bind(s))):fe&&M(fe.bind(s))}if(re(nd,u),re(pr,p),re(Ma,y),re(od,w),re(sd,C),re(rd,A),re(dd,h),re(ld,xe),re(cd,he),re(Fa,I),re(di,R),re(ad,ee),X(we))if(we.length){const M=t.exposed||(t.exposed={});we.forEach(fe=>{Object.defineProperty(M,fe,{get:()=>s[fe],set:Pt=>s[fe]=Pt})})}else t.exposed||(t.exposed={});W&&t.render===vt&&(t.render=W),b!=null&&(t.inheritAttrs=b),T&&(t.components=T),x&&(t.directives=x),ee&&ka(t)}function vd(t,e,s=vt){X(t)&&(t=sn(t));for(const r in t){const i=t[r];let n;Ee(i)?"default"in i?n=Qs(i.from||r,i.default,!0):n=Qs(i.from||r):n=Qs(i),Se(n)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>n.value,set:o=>n.value=o}):e[r]=n}}function no(t,e,s){Dt(X(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,s)}function Ua(t,e,s,r){let i=r.includes(".")?sc(s,r):()=>s[r];if(_e(t)){const n=e[t];Z(n)&&ht(i,n)}else if(Z(t))ht(i,t.bind(s));else if(Ee(t))if(X(t))t.forEach(n=>Ua(n,e,s,r));else{const n=Z(t.handler)?t.handler.bind(s):e[t.handler];Z(n)&&ht(i,n,t)}}function Mn(t){const e=t.type,{mixins:s,extends:r}=e,{mixins:i,optionsCache:n,config:{optionMergeStrategies:o}}=t.appContext,a=n.get(e);let c;return a?c=a:!i.length&&!s&&!r?c=e:(c={},i.length&&i.forEach(d=>Vr(c,d,o,!0)),Vr(c,e,o)),Ee(e)&&n.set(e,c),c}function Vr(t,e,s,r=!1){const{mixins:i,extends:n}=e;n&&Vr(t,n,s,!0),i&&i.forEach(o=>Vr(t,o,s,!0));for(const o in e)if(!(r&&o==="expose")){const a=bd[o]||s&&s[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const bd={data:oo,props:ao,emits:ao,methods:Gs,computed:Gs,beforeCreate:Ye,created:Ye,beforeMount:Ye,mounted:Ye,beforeUpdate:Ye,updated:Ye,beforeDestroy:Ye,beforeUnmount:Ye,destroyed:Ye,unmounted:Ye,activated:Ye,deactivated:Ye,errorCaptured:Ye,serverPrefetch:Ye,components:Gs,directives:Gs,watch:yd,provide:oo,inject:wd};function oo(t,e){return e?t?function(){return Ne(Z(t)?t.call(this,this):t,Z(e)?e.call(this,this):e)}:e:t}function wd(t,e){return Gs(sn(t),sn(e))}function sn(t){if(X(t)){const e={};for(let s=0;s<t.length;s++)e[t[s]]=t[s];return e}return t}function Ye(t,e){return t?[...new Set([].concat(t,e))]:e}function Gs(t,e){return t?Ne(Object.create(null),t,e):e}function ao(t,e){return t?X(t)&&X(e)?[...new Set([...t,...e])]:Ne(Object.create(null),io(t),io(e??{})):e}function yd(t,e){if(!t)return e;if(!e)return t;const s=Ne(Object.create(null),t);for(const r in e)s[r]=Ye(t[r],e[r]);return s}function ja(){return{app:null,config:{isNativeTag:dl,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let xd=0;function Cd(t,e){return function(r,i=null){Z(r)||(r=Ne({},r)),i!=null&&!Ee(i)&&(i=null);const n=ja(),o=new WeakSet,a=[];let c=!1;const d=n.app={_uid:xd++,_component:r,_props:i,_container:null,_context:n,_instance:null,version:nu,get config(){return n.config},set config(l){},use(l,...u){return o.has(l)||(l&&Z(l.install)?(o.add(l),l.install(d,...u)):Z(l)&&(o.add(l),l(d,...u))),d},mixin(l){return n.mixins.includes(l)||n.mixins.push(l),d},component(l,u){return u?(n.components[l]=u,d):n.components[l]},directive(l,u){return u?(n.directives[l]=u,d):n.directives[l]},mount(l,u,p){if(!c){const y=d._ceVNode||ue(r,i);return y.appContext=n,p===!0?p="svg":p===!1&&(p=void 0),u&&e?e(y,l):t(y,l,p),c=!0,d._container=l,l.__vue_app__=d,fi(y.component)}},onUnmount(l){a.push(l)},unmount(){c&&(Dt(a,d._instance,16),t(null,d._container),delete d._container.__vue_app__)},provide(l,u){return n.provides[l]=u,d},runWithContext(l){const u=ms;ms=d;try{return l()}finally{ms=u}}};return d}}let ms=null;function Td(t,e){if(Me){let s=Me.provides;const r=Me.parent&&Me.parent.provides;r===s&&(s=Me.provides=Object.create(r)),s[t]=e}}function Qs(t,e,s=!1){const r=Me||He;if(r||ms){const i=ms?ms._context.provides:r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&t in i)return i[t];if(arguments.length>1)return s&&Z(e)?e.call(r&&r.proxy):e}}function Ed(){return!!(Me||He||ms)}const Va={},Wa=()=>Object.create(Va),Ya=t=>Object.getPrototypeOf(t)===Va;function Sd(t,e,s,r=!1){const i={},n=Wa();t.propsDefaults=Object.create(null),Ka(t,e,i,n);for(const o in t.propsOptions[0])o in i||(i[o]=void 0);s?t.props=r?i:Bl(i):t.type.props?t.props=i:t.props=n,t.attrs=n}function _d(t,e,s,r){const{props:i,attrs:n,vnode:{patchFlag:o}}=t,a=oe(i),[c]=t.propsOptions;let d=!1;if((r||o>0)&&!(o&16)){if(o&8){const l=t.vnode.dynamicProps;for(let u=0;u<l.length;u++){let p=l[u];if(ui(t.emitsOptions,p))continue;const y=e[p];if(c)if(de(n,p))y!==n[p]&&(n[p]=y,d=!0);else{const w=ft(p);i[w]=rn(c,a,w,y,t,!1)}else y!==n[p]&&(n[p]=y,d=!0)}}}else{Ka(t,e,i,n)&&(d=!0);let l;for(const u in a)(!e||!de(e,u)&&((l=rs(u))===u||!de(e,l)))&&(c?s&&(s[u]!==void 0||s[l]!==void 0)&&(i[u]=rn(c,a,u,void 0,t,!0)):delete i[u]);if(n!==a)for(const u in n)(!e||!de(e,u))&&(delete n[u],d=!0)}d&&Ft(t.attrs,"set","")}function Ka(t,e,s,r){const[i,n]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(zs(c))continue;const d=e[c];let l;i&&de(i,l=ft(c))?!n||!n.includes(l)?s[l]=d:(a||(a={}))[l]=d:ui(t.emitsOptions,c)||(!(c in r)||d!==r[c])&&(r[c]=d,o=!0)}if(n){const c=oe(s),d=a||me;for(let l=0;l<n.length;l++){const u=n[l];s[u]=rn(i,c,u,d[u],t,!de(d,u))}}return o}function rn(t,e,s,r,i,n){const o=t[s];if(o!=null){const a=de(o,"default");if(a&&r===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&Z(c)){const{propsDefaults:d}=i;if(s in d)r=d[s];else{const l=mr(i);r=d[s]=c.call(null,e),l()}}else r=c;i.ce&&i.ce._setProp(s,r)}o[0]&&(n&&!a?r=!1:o[1]&&(r===""||r===rs(s))&&(r=!0))}return r}const Rd=new WeakMap;function Ga(t,e,s=!1){const r=s?Rd:e.propsCache,i=r.get(t);if(i)return i;const n=t.props,o={},a=[];let c=!1;if(!Z(t)){const l=u=>{c=!0;const[p,y]=Ga(u,e,!0);Ne(o,p),y&&a.push(...y)};!s&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}if(!n&&!c)return Ee(t)&&r.set(t,$s),$s;if(X(n))for(let l=0;l<n.length;l++){const u=ft(n[l]);co(u)&&(o[u]=me)}else if(n)for(const l in n){const u=ft(l);if(co(u)){const p=n[l],y=o[u]=X(p)||Z(p)?{type:p}:Ne({},p),w=y.type;let C=!1,A=!0;if(X(w))for(let f=0;f<w.length;++f){const I=w[f],j=Z(I)&&I.name;if(j==="Boolean"){C=!0;break}else j==="String"&&(A=!1)}else C=Z(w)&&w.name==="Boolean";y[0]=C,y[1]=A,(C||de(y,"default"))&&a.push(u)}}const d=[o,a];return Ee(t)&&r.set(t,d),d}function co(t){return t[0]!=="$"&&!zs(t)}const za=t=>t[0]==="_"||t==="$stable",Fn=t=>X(t)?t.map(_t):[_t(t)],$d=(t,e,s)=>{if(e._n)return e;const r=On((...i)=>Fn(e(...i)),s);return r._c=!1,r},Xa=(t,e,s)=>{const r=t._ctx;for(const i in t){if(za(i))continue;const n=t[i];if(Z(n))e[i]=$d(i,n,r);else if(n!=null){const o=Fn(n);e[i]=()=>o}}},Ja=(t,e)=>{const s=Fn(e);t.slots.default=()=>s},Za=(t,e,s)=>{for(const r in e)(s||r!=="_")&&(t[r]=e[r])},Ad=(t,e,s)=>{const r=t.slots=Wa();if(t.vnode.shapeFlag&32){const i=e._;i?(Za(r,e,s),s&&na(r,"_",i,!0)):Xa(e,r)}else e&&Ja(t,e)},Id=(t,e,s)=>{const{vnode:r,slots:i}=t;let n=!0,o=me;if(r.shapeFlag&32){const a=e._;a?s&&a===1?n=!1:Za(i,e,s):(n=!e.$stable,Xa(e,i)),o=e}else e&&(Ja(t,e),o={default:1});if(n)for(const a in i)!za(a)&&o[a]==null&&delete i[a]},nt=Vd;function Dd(t){return Hd(t)}function Hd(t,e){const s=ni();s.__VUE__=!0;const{insert:r,remove:i,patchProp:n,createElement:o,createText:a,createComment:c,setText:d,setElementText:l,parentNode:u,nextSibling:p,setScopeId:y=vt,insertStaticContent:w}=t,C=(g,v,$,P=null,D=null,H=null,N=void 0,L=null,O=!!v.dynamicChildren)=>{if(g===v)return;g&&!Vs(g,v)&&(P=Cr(g),xt(g,D,H,!0),g=null),v.patchFlag===-2&&(O=!1,v.dynamicChildren=null);const{type:k,ref:K,shapeFlag:B}=v;switch(k){case hi:A(g,v,$,P);break;case ts:f(g,v,$,P);break;case Ir:g==null&&I(v,$,P,N);break;case pe:T(g,v,$,P,D,H,N,L,O);break;default:B&1?W(g,v,$,P,D,H,N,L,O):B&6?x(g,v,$,P,D,H,N,L,O):(B&64||B&128)&&k.process(g,v,$,P,D,H,N,L,O,Bs)}K!=null&&D&&jr(K,g&&g.ref,H,v||g,!v)},A=(g,v,$,P)=>{if(g==null)r(v.el=a(v.children),$,P);else{const D=v.el=g.el;v.children!==g.children&&d(D,v.children)}},f=(g,v,$,P)=>{g==null?r(v.el=c(v.children||""),$,P):v.el=g.el},I=(g,v,$,P)=>{[g.el,g.anchor]=w(g.children,v,$,P,g.el,g.anchor)},j=({el:g,anchor:v},$,P)=>{let D;for(;g&&g!==v;)D=p(g),r(g,$,P),g=D;r(v,$,P)},R=({el:g,anchor:v})=>{let $;for(;g&&g!==v;)$=p(g),i(g),g=$;i(v)},W=(g,v,$,P,D,H,N,L,O)=>{v.type==="svg"?N="svg":v.type==="math"&&(N="mathml"),g==null?xe(v,$,P,D,H,N,L,O):ee(g,v,D,H,N,L,O)},xe=(g,v,$,P,D,H,N,L)=>{let O,k;const{props:K,shapeFlag:B,transition:Y,dirs:z}=g;if(O=g.el=o(g.type,H,K&&K.is,K),B&8?l(O,g.children):B&16&&h(g.children,O,null,P,D,Hi(g,H),N,L),z&&cs(g,null,P,"created"),he(O,g,g.scopeId,N,P),K){for(const ve in K)ve!=="value"&&!zs(ve)&&n(O,ve,null,K[ve],H,P);"value"in K&&n(O,"value",null,K.value,H),(k=K.onVnodeBeforeMount)&&Tt(k,P,g)}z&&cs(g,null,P,"beforeMount");const te=Pd(D,Y);te&&Y.beforeEnter(O),r(O,v,$),((k=K&&K.onVnodeMounted)||te||z)&&nt(()=>{k&&Tt(k,P,g),te&&Y.enter(O),z&&cs(g,null,P,"mounted")},D)},he=(g,v,$,P,D)=>{if($&&y(g,$),P)for(let H=0;H<P.length;H++)y(g,P[H]);if(D){let H=D.subTree;if(v===H||ic(H.type)&&(H.ssContent===v||H.ssFallback===v)){const N=D.vnode;he(g,N,N.scopeId,N.slotScopeIds,D.parent)}}},h=(g,v,$,P,D,H,N,L,O=0)=>{for(let k=O;k<g.length;k++){const K=g[k]=L?Gt(g[k]):_t(g[k]);C(null,K,v,$,P,D,H,N,L)}},ee=(g,v,$,P,D,H,N)=>{const L=v.el=g.el;let{patchFlag:O,dynamicChildren:k,dirs:K}=v;O|=g.patchFlag&16;const B=g.props||me,Y=v.props||me;let z;if($&&ls($,!1),(z=Y.onVnodeBeforeUpdate)&&Tt(z,$,v,g),K&&cs(v,g,$,"beforeUpdate"),$&&ls($,!0),(B.innerHTML&&Y.innerHTML==null||B.textContent&&Y.textContent==null)&&l(L,""),k?we(g.dynamicChildren,k,L,$,P,Hi(v,D),H):N||fe(g,v,L,null,$,P,Hi(v,D),H,!1),O>0){if(O&16)b(L,B,Y,$,D);else if(O&2&&B.class!==Y.class&&n(L,"class",null,Y.class,D),O&4&&n(L,"style",B.style,Y.style,D),O&8){const te=v.dynamicProps;for(let ve=0;ve<te.length;ve++){const ge=te[ve],st=B[ge],Be=Y[ge];(Be!==st||ge==="value")&&n(L,ge,st,Be,D,$)}}O&1&&g.children!==v.children&&l(L,v.children)}else!N&&k==null&&b(L,B,Y,$,D);((z=Y.onVnodeUpdated)||K)&&nt(()=>{z&&Tt(z,$,v,g),K&&cs(v,g,$,"updated")},P)},we=(g,v,$,P,D,H,N)=>{for(let L=0;L<v.length;L++){const O=g[L],k=v[L],K=O.el&&(O.type===pe||!Vs(O,k)||O.shapeFlag&70)?u(O.el):$;C(O,k,K,null,P,D,H,N,!0)}},b=(g,v,$,P,D)=>{if(v!==$){if(v!==me)for(const H in v)!zs(H)&&!(H in $)&&n(g,H,v[H],null,D,P);for(const H in $){if(zs(H))continue;const N=$[H],L=v[H];N!==L&&H!=="value"&&n(g,H,L,N,D,P)}"value"in $&&n(g,"value",v.value,$.value,D)}},T=(g,v,$,P,D,H,N,L,O)=>{const k=v.el=g?g.el:a(""),K=v.anchor=g?g.anchor:a("");let{patchFlag:B,dynamicChildren:Y,slotScopeIds:z}=v;z&&(L=L?L.concat(z):z),g==null?(r(k,$,P),r(K,$,P),h(v.children||[],$,K,D,H,N,L,O)):B>0&&B&64&&Y&&g.dynamicChildren?(we(g.dynamicChildren,Y,$,D,H,N,L),(v.key!=null||D&&v===D.subTree)&&Qa(g,v,!0)):fe(g,v,$,K,D,H,N,L,O)},x=(g,v,$,P,D,H,N,L,O)=>{v.slotScopeIds=L,g==null?v.shapeFlag&512?D.ctx.activate(v,$,P,N,O):ke(v,$,P,D,H,N,O):le(g,v,O)},ke=(g,v,$,P,D,H,N)=>{const L=g.component=Jd(g,P,D);if(Oa(g)&&(L.ctx.renderer=Bs),Qd(L,!1,N),L.asyncDep){if(D&&D.registerDep(L,re,N),!g.el){const O=L.subTree=ue(ts);f(null,O,v,$)}}else re(L,g,v,$,D,H,N)},le=(g,v,$)=>{const P=v.component=g.component;if(Ud(g,v,$))if(P.asyncDep&&!P.asyncResolved){M(P,v,$);return}else P.next=v,P.update();else v.el=g.el,P.vnode=v},re=(g,v,$,P,D,H,N)=>{const L=()=>{if(g.isMounted){let{next:B,bu:Y,u:z,parent:te,vnode:ve}=g;{const rt=ec(g);if(rt){B&&(B.el=ve.el,M(g,B,N)),rt.asyncDep.then(()=>{g.isUnmounted||L()});return}}let ge=B,st;ls(g,!1),B?(B.el=ve.el,M(g,B,N)):B=ve,Y&&Ar(Y),(st=B.props&&B.props.onVnodeBeforeUpdate)&&Tt(st,te,B,ve),ls(g,!0);const Be=Pi(g),gt=g.subTree;g.subTree=Be,C(gt,Be,u(gt.el),Cr(gt),g,D,H),B.el=Be.el,ge===null&&jd(g,Be.el),z&&nt(z,D),(st=B.props&&B.props.onVnodeUpdated)&&nt(()=>Tt(st,te,B,ve),D)}else{let B;const{el:Y,props:z}=v,{bm:te,m:ve,parent:ge,root:st,type:Be}=g,gt=Ds(v);if(ls(g,!1),te&&Ar(te),!gt&&(B=z&&z.onVnodeBeforeMount)&&Tt(B,ge,v),ls(g,!0),Y&&Xn){const rt=()=>{g.subTree=Pi(g),Xn(Y,g.subTree,g,D,null)};gt&&Be.__asyncHydrate?Be.__asyncHydrate(Y,g,rt):rt()}else{st.ce&&st.ce._injectChildStyle(Be);const rt=g.subTree=Pi(g);C(null,rt,$,P,g,D,H),v.el=rt.el}if(ve&&nt(ve,D),!gt&&(B=z&&z.onVnodeMounted)){const rt=v;nt(()=>Tt(B,ge,rt),D)}(v.shapeFlag&256||ge&&Ds(ge.vnode)&&ge.vnode.shapeFlag&256)&&g.a&&nt(g.a,D),g.isMounted=!0,v=$=P=null}};g.scope.on();const O=g.effect=new ha(L);g.scope.off();const k=g.update=O.run.bind(O),K=g.job=O.runIfDirty.bind(O);K.i=g,K.id=g.uid,O.scheduler=()=>kn(K),ls(g,!0),k()},M=(g,v,$)=>{v.component=g;const P=g.vnode.props;g.vnode=v,g.next=null,_d(g,v.props,P,$),Id(g,v.children,$),is(),so(g),ns()},fe=(g,v,$,P,D,H,N,L,O=!1)=>{const k=g&&g.children,K=g?g.shapeFlag:0,B=v.children,{patchFlag:Y,shapeFlag:z}=v;if(Y>0){if(Y&128){xr(k,B,$,P,D,H,N,L,O);return}else if(Y&256){Pt(k,B,$,P,D,H,N,L,O);return}}z&8?(K&16&&qs(k,D,H),B!==k&&l($,B)):K&16?z&16?xr(k,B,$,P,D,H,N,L,O):qs(k,D,H,!0):(K&8&&l($,""),z&16&&h(B,$,P,D,H,N,L,O))},Pt=(g,v,$,P,D,H,N,L,O)=>{g=g||$s,v=v||$s;const k=g.length,K=v.length,B=Math.min(k,K);let Y;for(Y=0;Y<B;Y++){const z=v[Y]=O?Gt(v[Y]):_t(v[Y]);C(g[Y],z,$,null,D,H,N,L,O)}k>K?qs(g,D,H,!0,!1,B):h(v,$,P,D,H,N,L,O,B)},xr=(g,v,$,P,D,H,N,L,O)=>{let k=0;const K=v.length;let B=g.length-1,Y=K-1;for(;k<=B&&k<=Y;){const z=g[k],te=v[k]=O?Gt(v[k]):_t(v[k]);if(Vs(z,te))C(z,te,$,null,D,H,N,L,O);else break;k++}for(;k<=B&&k<=Y;){const z=g[B],te=v[Y]=O?Gt(v[Y]):_t(v[Y]);if(Vs(z,te))C(z,te,$,null,D,H,N,L,O);else break;B--,Y--}if(k>B){if(k<=Y){const z=Y+1,te=z<K?v[z].el:P;for(;k<=Y;)C(null,v[k]=O?Gt(v[k]):_t(v[k]),$,te,D,H,N,L,O),k++}}else if(k>Y)for(;k<=B;)xt(g[k],D,H,!0),k++;else{const z=k,te=k,ve=new Map;for(k=te;k<=Y;k++){const it=v[k]=O?Gt(v[k]):_t(v[k]);it.key!=null&&ve.set(it.key,k)}let ge,st=0;const Be=Y-te+1;let gt=!1,rt=0;const Us=new Array(Be);for(k=0;k<Be;k++)Us[k]=0;for(k=z;k<=B;k++){const it=g[k];if(st>=Be){xt(it,D,H,!0);continue}let Ct;if(it.key!=null)Ct=ve.get(it.key);else for(ge=te;ge<=Y;ge++)if(Us[ge-te]===0&&Vs(it,v[ge])){Ct=ge;break}Ct===void 0?xt(it,D,H,!0):(Us[Ct-te]=k+1,Ct>=rt?rt=Ct:gt=!0,C(it,v[Ct],$,null,D,H,N,L,O),st++)}const Jn=gt?kd(Us):$s;for(ge=Jn.length-1,k=Be-1;k>=0;k--){const it=te+k,Ct=v[it],Zn=it+1<K?v[it+1].el:P;Us[k]===0?C(null,Ct,$,Zn,D,H,N,L,O):gt&&(ge<0||k!==Jn[ge]?as(Ct,$,Zn,2):ge--)}}},as=(g,v,$,P,D=null)=>{const{el:H,type:N,transition:L,children:O,shapeFlag:k}=g;if(k&6){as(g.component.subTree,v,$,P);return}if(k&128){g.suspense.move(v,$,P);return}if(k&64){N.move(g,v,$,Bs);return}if(N===pe){r(H,v,$);for(let B=0;B<O.length;B++)as(O[B],v,$,P);r(g.anchor,v,$);return}if(N===Ir){j(g,v,$);return}if(P!==2&&k&1&&L)if(P===0)L.beforeEnter(H),r(H,v,$),nt(()=>L.enter(H),D);else{const{leave:B,delayLeave:Y,afterLeave:z}=L,te=()=>r(H,v,$),ve=()=>{B(H,()=>{te(),z&&z()})};Y?Y(H,te,ve):ve()}else r(H,v,$)},xt=(g,v,$,P=!1,D=!1)=>{const{type:H,props:N,ref:L,children:O,dynamicChildren:k,shapeFlag:K,patchFlag:B,dirs:Y,cacheIndex:z}=g;if(B===-2&&(D=!1),L!=null&&jr(L,null,$,g,!0),z!=null&&(v.renderCache[z]=void 0),K&256){v.ctx.deactivate(g);return}const te=K&1&&Y,ve=!Ds(g);let ge;if(ve&&(ge=N&&N.onVnodeBeforeUnmount)&&Tt(ge,v,g),K&6)ll(g.component,$,P);else{if(K&128){g.suspense.unmount($,P);return}te&&cs(g,null,v,"beforeUnmount"),K&64?g.type.remove(g,v,$,Bs,P):k&&!k.hasOnce&&(H!==pe||B>0&&B&64)?qs(k,v,$,!1,!0):(H===pe&&B&384||!D&&K&16)&&qs(O,v,$),P&&Kn(g)}(ve&&(ge=N&&N.onVnodeUnmounted)||te)&&nt(()=>{ge&&Tt(ge,v,g),te&&cs(g,null,v,"unmounted")},$)},Kn=g=>{const{type:v,el:$,anchor:P,transition:D}=g;if(v===pe){cl($,P);return}if(v===Ir){R(g);return}const H=()=>{i($),D&&!D.persisted&&D.afterLeave&&D.afterLeave()};if(g.shapeFlag&1&&D&&!D.persisted){const{leave:N,delayLeave:L}=D,O=()=>N($,H);L?L(g.el,H,O):O()}else H()},cl=(g,v)=>{let $;for(;g!==v;)$=p(g),i(g),g=$;i(v)},ll=(g,v,$)=>{const{bum:P,scope:D,job:H,subTree:N,um:L,m:O,a:k}=g;lo(O),lo(k),P&&Ar(P),D.stop(),H&&(H.flags|=8,xt(N,g,v,$)),L&&nt(L,v),nt(()=>{g.isUnmounted=!0},v),v&&v.pendingBranch&&!v.isUnmounted&&g.asyncDep&&!g.asyncResolved&&g.suspenseId===v.pendingId&&(v.deps--,v.deps===0&&v.resolve())},qs=(g,v,$,P=!1,D=!1,H=0)=>{for(let N=H;N<g.length;N++)xt(g[N],v,$,P,D)},Cr=g=>{if(g.shapeFlag&6)return Cr(g.component.subTree);if(g.shapeFlag&128)return g.suspense.next();const v=p(g.anchor||g.el),$=v&&v[ed];return $?p($):v};let Si=!1;const Gn=(g,v,$)=>{g==null?v._vnode&&xt(v._vnode,null,null,!0):C(v._vnode||null,g,v,null,null,null,$),v._vnode=g,Si||(Si=!0,so(),Da(),Si=!1)},Bs={p:C,um:xt,m:as,r:Kn,mt:ke,mc:h,pc:fe,pbc:we,n:Cr,o:t};let zn,Xn;return{render:Gn,hydrate:zn,createApp:Cd(Gn,zn)}}function Hi({type:t,props:e},s){return s==="svg"&&t==="foreignObject"||s==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:s}function ls({effect:t,job:e},s){s?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Pd(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Qa(t,e,s=!1){const r=t.children,i=e.children;if(X(r)&&X(i))for(let n=0;n<r.length;n++){const o=r[n];let a=i[n];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[n]=Gt(i[n]),a.el=o.el),!s&&a.patchFlag!==-2&&Qa(o,a)),a.type===hi&&(a.el=o.el)}}function kd(t){const e=t.slice(),s=[0];let r,i,n,o,a;const c=t.length;for(r=0;r<c;r++){const d=t[r];if(d!==0){if(i=s[s.length-1],t[i]<d){e[r]=i,s.push(r);continue}for(n=0,o=s.length-1;n<o;)a=n+o>>1,t[s[a]]<d?n=a+1:o=a;d<t[s[n]]&&(n>0&&(e[r]=s[n-1]),s[n]=r)}}for(n=s.length,o=s[n-1];n-- >0;)s[n]=o,o=e[o];return s}function ec(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:ec(e)}function lo(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Od=Symbol.for("v-scx"),Ld=()=>Qs(Od);function ht(t,e,s){return tc(t,e,s)}function tc(t,e,s=me){const{immediate:r,deep:i,flush:n,once:o}=s,a=Ne({},s),c=e&&r||!e&&n!=="post";let d;if(cr){if(n==="sync"){const y=Ld();d=y.__watcherHandles||(y.__watcherHandles=[])}else if(!c){const y=()=>{};return y.stop=vt,y.resume=vt,y.pause=vt,y}}const l=Me;a.call=(y,w,C)=>Dt(y,l,w,C);let u=!1;n==="post"?a.scheduler=y=>{nt(y,l&&l.suspense)}:n!=="sync"&&(u=!0,a.scheduler=(y,w)=>{w?y():kn(y)}),a.augmentJob=y=>{e&&(y.flags|=4),u&&(y.flags|=2,l&&(y.id=l.uid,y.i=l))};const p=Jl(t,e,a);return cr&&(d?d.push(p):c&&p()),p}function Md(t,e,s){const r=this.proxy,i=_e(t)?t.includes(".")?sc(r,t):()=>r[t]:t.bind(r,r);let n;Z(e)?n=e:(n=e.handler,s=e);const o=mr(this),a=tc(i,n.bind(r),s);return o(),a}function sc(t,e){const s=e.split(".");return()=>{let r=t;for(let i=0;i<s.length&&r;i++)r=r[s[i]];return r}}const Fd=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${ft(e)}Modifiers`]||t[`${rs(e)}Modifiers`];function Nd(t,e,...s){if(t.isUnmounted)return;const r=t.vnode.props||me;let i=s;const n=e.startsWith("update:"),o=n&&Fd(r,e.slice(7));o&&(o.trim&&(i=s.map(l=>_e(l)?l.trim():l)),o.number&&(i=s.map(zi)));let a,c=r[a=_i(e)]||r[a=_i(ft(e))];!c&&n&&(c=r[a=_i(rs(e))]),c&&Dt(c,t,6,i);const d=r[a+"Once"];if(d){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Dt(d,t,6,i)}}function rc(t,e,s=!1){const r=e.emitsCache,i=r.get(t);if(i!==void 0)return i;const n=t.emits;let o={},a=!1;if(!Z(t)){const c=d=>{const l=rc(d,e,!0);l&&(a=!0,Ne(o,l))};!s&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!n&&!a?(Ee(t)&&r.set(t,null),null):(X(n)?n.forEach(c=>o[c]=null):Ne(o,n),Ee(t)&&r.set(t,o),o)}function ui(t,e){return!t||!ti(e)?!1:(e=e.slice(2).replace(/Once$/,""),de(t,e[0].toLowerCase()+e.slice(1))||de(t,rs(e))||de(t,e))}function Pi(t){const{type:e,vnode:s,proxy:r,withProxy:i,propsOptions:[n],slots:o,attrs:a,emit:c,render:d,renderCache:l,props:u,data:p,setupState:y,ctx:w,inheritAttrs:C}=t,A=Ur(t);let f,I;try{if(s.shapeFlag&4){const R=i||r,W=R;f=_t(d.call(W,R,l,u,y,p,w)),I=a}else{const R=e;f=_t(R.length>1?R(u,{attrs:a,slots:o,emit:c}):R(u,null)),I=e.props?a:qd(a)}}catch(R){er.length=0,ci(R,t,1),f=ue(ts)}let j=f;if(I&&C!==!1){const R=Object.keys(I),{shapeFlag:W}=j;R.length&&W&7&&(n&&R.some(Tn)&&(I=Bd(I,n)),j=ks(j,I,!1,!0))}return s.dirs&&(j=ks(j,null,!1,!0),j.dirs=j.dirs?j.dirs.concat(s.dirs):s.dirs),s.transition&&Ln(j,s.transition),f=j,Ur(A),f}const qd=t=>{let e;for(const s in t)(s==="class"||s==="style"||ti(s))&&((e||(e={}))[s]=t[s]);return e},Bd=(t,e)=>{const s={};for(const r in t)(!Tn(r)||!(r.slice(9)in e))&&(s[r]=t[r]);return s};function Ud(t,e,s){const{props:r,children:i,component:n}=t,{props:o,children:a,patchFlag:c}=e,d=n.emitsOptions;if(e.dirs||e.transition)return!0;if(s&&c>=0){if(c&1024)return!0;if(c&16)return r?uo(r,o,d):!!o;if(c&8){const l=e.dynamicProps;for(let u=0;u<l.length;u++){const p=l[u];if(o[p]!==r[p]&&!ui(d,p))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?uo(r,o,d):!0:!!o;return!1}function uo(t,e,s){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let i=0;i<r.length;i++){const n=r[i];if(e[n]!==t[n]&&!ui(s,n))return!0}return!1}function jd({vnode:t,parent:e},s){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===t&&(r.el=t.el),r===t)(t=e.vnode).el=s,e=e.parent;else break}}const ic=t=>t.__isSuspense;function Vd(t,e){e&&e.pendingBranch?X(t)?e.effects.push(...t):e.effects.push(t):Ia(t)}const pe=Symbol.for("v-fgt"),hi=Symbol.for("v-txt"),ts=Symbol.for("v-cmt"),Ir=Symbol.for("v-stc"),er=[];let at=null;function V(t=!1){er.push(at=t?null:[])}function Wd(){er.pop(),at=er[er.length-1]||null}let ar=1;function ho(t,e=!1){ar+=t,t<0&&at&&e&&(at.hasOnce=!0)}function nc(t){return t.dynamicChildren=ar>0?at||$s:null,Wd(),ar>0&&at&&at.push(t),t}function J(t,e,s,r,i,n){return nc(m(t,e,s,r,i,n,!0))}function Xe(t,e,s,r,i){return nc(ue(t,e,s,r,i,!0))}function Nn(t){return t?t.__v_isVNode===!0:!1}function Vs(t,e){return t.type===e.type&&t.key===e.key}const oc=({key:t})=>t??null,Dr=({ref:t,ref_key:e,ref_for:s})=>(typeof t=="number"&&(t=""+t),t!=null?_e(t)||Se(t)||Z(t)?{i:He,r:t,k:e,f:!!s}:t:null);function m(t,e=null,s=null,r=0,i=null,n=t===pe?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&oc(e),ref:e&&Dr(e),scopeId:Pa,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:He};return a?(qn(c,s),n&128&&t.normalize(c)):s&&(c.shapeFlag|=_e(s)?8:16),ar>0&&!o&&at&&(c.patchFlag>0||n&6)&&c.patchFlag!==32&&at.push(c),c}const ue=Yd;function Yd(t,e=null,s=null,r=0,i=null,n=!1){if((!t||t===Na)&&(t=ts),Nn(t)){const a=ks(t,e,!0);return s&&qn(a,s),ar>0&&!n&&at&&(a.shapeFlag&6?at[at.indexOf(t)]=a:at.push(a)),a.patchFlag=-2,a}if(iu(t)&&(t=t.__vccOpts),e){e=Kd(e);let{class:a,style:c}=e;a&&!_e(a)&&(e.class=Te(a)),Ee(c)&&(Hn(c)&&!X(c)&&(c=Ne({},c)),e.style=ae(c))}const o=_e(t)?1:ic(t)?128:td(t)?64:Ee(t)?4:Z(t)?2:0;return m(t,e,s,r,i,o,n,!0)}function Kd(t){return t?Hn(t)||Ya(t)?Ne({},t):t:null}function ks(t,e,s=!1,r=!1){const{props:i,ref:n,patchFlag:o,children:a,transition:c}=t,d=e?Gd(i||{},e):i,l={__v_isVNode:!0,__v_skip:!0,type:t.type,props:d,key:d&&oc(d),ref:e&&e.ref?s&&n?X(n)?n.concat(Dr(e)):[n,Dr(e)]:Dr(e):n,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==pe?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&ks(t.ssContent),ssFallback:t.ssFallback&&ks(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&r&&Ln(l,c.clone(l)),l}function Oe(t=" ",e=0){return ue(hi,null,t,e)}function Ge(t="",e=!1){return e?(V(),Xe(ts,null,t)):ue(ts,null,t)}function _t(t){return t==null||typeof t=="boolean"?ue(ts):X(t)?ue(pe,null,t.slice()):Nn(t)?Gt(t):ue(hi,null,String(t))}function Gt(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:ks(t)}function qn(t,e){let s=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(X(e))s=16;else if(typeof e=="object")if(r&65){const i=e.default;i&&(i._c&&(i._d=!1),qn(t,i()),i._c&&(i._d=!0));return}else{s=32;const i=e._;!i&&!Ya(e)?e._ctx=He:i===3&&He&&(He.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Z(e)?(e={default:e,_ctx:He},s=32):(e=String(e),r&64?(s=16,e=[Oe(e)]):s=8);t.children=e,t.shapeFlag|=s}function Gd(...t){const e={};for(let s=0;s<t.length;s++){const r=t[s];for(const i in r)if(i==="class")e.class!==r.class&&(e.class=Te([e.class,r.class]));else if(i==="style")e.style=ae([e.style,r.style]);else if(ti(i)){const n=e[i],o=r[i];o&&n!==o&&!(X(n)&&n.includes(o))&&(e[i]=n?[].concat(n,o):o)}else i!==""&&(e[i]=r[i])}return e}function Tt(t,e,s,r=null){Dt(t,e,7,[s,r])}const zd=ja();let Xd=0;function Jd(t,e,s){const r=t.type,i=(e?e.appContext:t.appContext)||zd,n={uid:Xd++,vnode:t,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new la(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Ga(r,i),emitsOptions:rc(r,i),emit:null,emitted:null,propsDefaults:me,inheritAttrs:r.inheritAttrs,ctx:me,data:me,props:me,attrs:me,slots:me,refs:me,setupState:me,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return n.ctx={_:n},n.root=e?e.root:n,n.emit=Nd.bind(null,n),t.ce&&t.ce(n),n}let Me=null;const Zd=()=>Me||He;let Wr,nn;{const t=ni(),e=(s,r)=>{let i;return(i=t[s])||(i=t[s]=[]),i.push(r),n=>{i.length>1?i.forEach(o=>o(n)):i[0](n)}};Wr=e("__VUE_INSTANCE_SETTERS__",s=>Me=s),nn=e("__VUE_SSR_SETTERS__",s=>cr=s)}const mr=t=>{const e=Me;return Wr(t),t.scope.on(),()=>{t.scope.off(),Wr(e)}},fo=()=>{Me&&Me.scope.off(),Wr(null)};function ac(t){return t.vnode.shapeFlag&4}let cr=!1;function Qd(t,e=!1,s=!1){e&&nn(e);const{props:r,children:i}=t.vnode,n=ac(t);Sd(t,r,n,e),Ad(t,i,s);const o=n?eu(t,e):void 0;return e&&nn(!1),o}function eu(t,e){const s=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,pd);const{setup:r}=s;if(r){is();const i=t.setupContext=r.length>1?su(t):null,n=mr(t),o=gr(r,t,0,[t.props,i]),a=sa(o);if(ns(),n(),(a||t.sp)&&!Ds(t)&&ka(t),a){if(o.then(fo,fo),e)return o.then(c=>{go(t,c,e)}).catch(c=>{ci(c,t,0)});t.asyncDep=o}else go(t,o,e)}else cc(t,e)}function go(t,e,s){Z(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Ee(e)&&(t.setupState=Ra(e)),cc(t,s)}let po;function cc(t,e,s){const r=t.type;if(!t.render){if(!e&&po&&!r.render){const i=r.template||Mn(t).template;if(i){const{isCustomElement:n,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:c}=r,d=Ne(Ne({isCustomElement:n,delimiters:a},o),c);r.render=po(i,d)}}t.render=r.render||vt}{const i=mr(t);is();try{md(t)}finally{ns(),i()}}}const tu={get(t,e){return Ue(t,"get",""),t[e]}};function su(t){const e=s=>{t.exposed=s||{}};return{attrs:new Proxy(t.attrs,tu),slots:t.slots,emit:t.emit,expose:e}}function fi(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Ra(Pn(t.exposed)),{get(e,s){if(s in e)return e[s];if(s in Zs)return Zs[s](t)},has(e,s){return s in e||s in Zs}})):t.proxy}function ru(t,e=!0){return Z(t)?t.displayName||t.name:t.name||e&&t.__name}function iu(t){return Z(t)&&"__vccOpts"in t}const wt=(t,e)=>zl(t,e,cr),nu="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let on;const mo=typeof window<"u"&&window.trustedTypes;if(mo)try{on=mo.createPolicy("vue",{createHTML:t=>t})}catch{}const lc=on?t=>on.createHTML(t):t=>t,ou="http://www.w3.org/2000/svg",au="http://www.w3.org/1998/Math/MathML",Lt=typeof document<"u"?document:null,vo=Lt&&Lt.createElement("template"),cu={insert:(t,e,s)=>{e.insertBefore(t,s||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,s,r)=>{const i=e==="svg"?Lt.createElementNS(ou,t):e==="mathml"?Lt.createElementNS(au,t):s?Lt.createElement(t,{is:s}):Lt.createElement(t);return t==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:t=>Lt.createTextNode(t),createComment:t=>Lt.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Lt.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,s,r,i,n){const o=s?s.previousSibling:e.lastChild;if(i&&(i===n||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),s),!(i===n||!(i=i.nextSibling)););else{vo.innerHTML=lc(r==="svg"?`<svg>${t}</svg>`:r==="mathml"?`<math>${t}</math>`:t);const a=vo.content;if(r==="svg"||r==="mathml"){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,s)}return[o?o.nextSibling:e.firstChild,s?s.previousSibling:e.lastChild]}},lu=Symbol("_vtc");function du(t,e,s){const r=t[lu];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):s?t.setAttribute("class",e):t.className=e}const Yr=Symbol("_vod"),dc=Symbol("_vsh"),tr={beforeMount(t,{value:e},{transition:s}){t[Yr]=t.style.display==="none"?"":t.style.display,s&&e?s.beforeEnter(t):Ws(t,e)},mounted(t,{value:e},{transition:s}){s&&e&&s.enter(t)},updated(t,{value:e,oldValue:s},{transition:r}){!e!=!s&&(r?e?(r.beforeEnter(t),Ws(t,!0),r.enter(t)):r.leave(t,()=>{Ws(t,!1)}):Ws(t,e))},beforeUnmount(t,{value:e}){Ws(t,e)}};function Ws(t,e){t.style.display=e?t[Yr]:"none",t[dc]=!e}const uc=Symbol("");function uu(t){const e=Zd();if(!e)return;const s=e.ut=(i=t(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(n=>Kr(n,i))},r=()=>{const i=t(e.proxy);e.ce?Kr(e.ce,i):an(e.subTree,i),s(i)};Ma(()=>{Ia(r)}),pr(()=>{ht(r,vt,{flush:"post"});const i=new MutationObserver(r);i.observe(e.subTree.el.parentNode,{childList:!0}),di(()=>i.disconnect())})}function an(t,e){if(t.shapeFlag&128){const s=t.suspense;t=s.activeBranch,s.pendingBranch&&!s.isHydrating&&s.effects.push(()=>{an(s.activeBranch,e)})}for(;t.component;)t=t.component.subTree;if(t.shapeFlag&1&&t.el)Kr(t.el,e);else if(t.type===pe)t.children.forEach(s=>an(s,e));else if(t.type===Ir){let{el:s,anchor:r}=t;for(;s&&(Kr(s,e),s!==r);)s=s.nextSibling}}function Kr(t,e){if(t.nodeType===1){const s=t.style;let r="";for(const i in e)s.setProperty(`--${i}`,e[i]),r+=`--${i}: ${e[i]};`;s[uc]=r}}const hu=/(^|;)\s*display\s*:/;function fu(t,e,s){const r=t.style,i=_e(s);let n=!1;if(s&&!i){if(e)if(_e(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();s[a]==null&&Hr(r,a,"")}else for(const o in e)s[o]==null&&Hr(r,o,"");for(const o in s)o==="display"&&(n=!0),Hr(r,o,s[o])}else if(i){if(e!==s){const o=r[uc];o&&(s+=";"+o),r.cssText=s,n=hu.test(s)}}else e&&t.removeAttribute("style");Yr in t&&(t[Yr]=n?r.display:"",t[dc]&&(r.display="none"))}const bo=/\s*!important$/;function Hr(t,e,s){if(X(s))s.forEach(r=>Hr(t,e,r));else if(s==null&&(s=""),e.startsWith("--"))t.setProperty(e,s);else{const r=gu(t,e);bo.test(s)?t.setProperty(rs(r),s.replace(bo,""),"important"):t[r]=s}}const wo=["Webkit","Moz","ms"],ki={};function gu(t,e){const s=ki[e];if(s)return s;let r=ft(e);if(r!=="filter"&&r in t)return ki[e]=r;r=ii(r);for(let i=0;i<wo.length;i++){const n=wo[i]+r;if(n in t)return ki[e]=n}return e}const yo="http://www.w3.org/1999/xlink";function xo(t,e,s,r,i,n=yl(e)){r&&e.startsWith("xlink:")?s==null?t.removeAttributeNS(yo,e.slice(6,e.length)):t.setAttributeNS(yo,e,s):s==null||n&&!oa(s)?t.removeAttribute(e):t.setAttribute(e,n?"":jt(s)?String(s):s)}function Co(t,e,s,r,i){if(e==="innerHTML"||e==="textContent"){s!=null&&(t[e]=e==="innerHTML"?lc(s):s);return}const n=t.tagName;if(e==="value"&&n!=="PROGRESS"&&!n.includes("-")){const a=n==="OPTION"?t.getAttribute("value")||"":t.value,c=s==null?t.type==="checkbox"?"on":"":String(s);(a!==c||!("_value"in t))&&(t.value=c),s==null&&t.removeAttribute(e),t._value=s;return}let o=!1;if(s===""||s==null){const a=typeof t[e];a==="boolean"?s=oa(s):s==null&&a==="string"?(s="",o=!0):a==="number"&&(s=0,o=!0)}try{t[e]=s}catch{}o&&t.removeAttribute(i||e)}function Ss(t,e,s,r){t.addEventListener(e,s,r)}function pu(t,e,s,r){t.removeEventListener(e,s,r)}const To=Symbol("_vei");function mu(t,e,s,r,i=null){const n=t[To]||(t[To]={}),o=n[e];if(r&&o)o.value=r;else{const[a,c]=vu(e);if(r){const d=n[e]=yu(r,i);Ss(t,a,d,c)}else o&&(pu(t,a,o,c),n[e]=void 0)}}const Eo=/(?:Once|Passive|Capture)$/;function vu(t){let e;if(Eo.test(t)){e={};let r;for(;r=t.match(Eo);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):rs(t.slice(2)),e]}let Oi=0;const bu=Promise.resolve(),wu=()=>Oi||(bu.then(()=>Oi=0),Oi=Date.now());function yu(t,e){const s=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=s.attached)return;Dt(xu(r,s.value),e,5,[r])};return s.value=t,s.attached=wu(),s}function xu(t,e){if(X(e)){const s=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{s.call(t),t._stopped=!0},e.map(r=>i=>!i._stopped&&r&&r(i))}else return e}const So=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,Cu=(t,e,s,r,i,n)=>{const o=i==="svg";e==="class"?du(t,r,o):e==="style"?fu(t,s,r):ti(e)?Tn(e)||mu(t,e,s,r,n):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Tu(t,e,r,o))?(Co(t,e,r),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&xo(t,e,r,o,n,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!_e(r))?Co(t,ft(e),r,n,e):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),xo(t,e,r,o))};function Tu(t,e,s,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in t&&So(e)&&Z(s));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=t.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return So(e)&&_e(s)?!1:e in t}const _o=t=>{const e=t.props["onUpdate:modelValue"]||!1;return X(e)?s=>Ar(e,s):e};function Eu(t){t.target.composing=!0}function Ro(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Li=Symbol("_assign"),Os={created(t,{modifiers:{lazy:e,trim:s,number:r}},i){t[Li]=_o(i);const n=r||i.props&&i.props.type==="number";Ss(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;s&&(a=a.trim()),n&&(a=zi(a)),t[Li](a)}),s&&Ss(t,"change",()=>{t.value=t.value.trim()}),e||(Ss(t,"compositionstart",Eu),Ss(t,"compositionend",Ro),Ss(t,"change",Ro))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:s,modifiers:{lazy:r,trim:i,number:n}},o){if(t[Li]=_o(o),t.composing)return;const a=(n||t.type==="number")&&!/^0\d/.test(t.value)?zi(t.value):t.value,c=e??"";a!==c&&(document.activeElement===t&&t.type!=="range"&&(r&&e===s||i&&t.value.trim()===c)||(t.value=c))}},Su=["ctrl","shift","alt","meta"],_u={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Su.some(s=>t[`${s}Key`]&&!e.includes(s))},ye=(t,e)=>{const s=t._withMods||(t._withMods={}),r=e.join(".");return s[r]||(s[r]=(i,...n)=>{for(let o=0;o<e.length;o++){const a=_u[e[o]];if(a&&a(i,e))return}return t(i,...n)})},Ru={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},cn=(t,e)=>{const s=t._withKeys||(t._withKeys={}),r=e.join(".");return s[r]||(s[r]=i=>{if(!("key"in i))return;const n=rs(i.key);if(e.some(o=>o===n||Ru[o]===n))return t(i)})},$u=Ne({patchProp:Cu},cu);let $o;function Au(){return $o||($o=Dd($u))}const Iu=(...t)=>{const e=Au().createApp(...t),{mount:s}=e;return e.mount=r=>{const i=Hu(r);if(!i)return;const n=e._component;!Z(n)&&!n.render&&!n.template&&(n.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=s(i,!1,Du(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function Du(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Hu(t){return _e(t)?document.querySelector(t):t}function hc(t,e){return function(){return t.apply(e,arguments)}}const{toString:Pu}=Object.prototype,{getPrototypeOf:Bn}=Object,gi=(t=>e=>{const s=Pu.call(e);return t[s]||(t[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),yt=t=>(t=t.toLowerCase(),e=>gi(e)===t),pi=t=>e=>typeof e===t,{isArray:Ms}=Array,lr=pi("undefined");function ku(t){return t!==null&&!lr(t)&&t.constructor!==null&&!lr(t.constructor)&&ct(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const fc=yt("ArrayBuffer");function Ou(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&fc(t.buffer),e}const Lu=pi("string"),ct=pi("function"),gc=pi("number"),mi=t=>t!==null&&typeof t=="object",Mu=t=>t===!0||t===!1,Pr=t=>{if(gi(t)!=="object")return!1;const e=Bn(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Fu=yt("Date"),Nu=yt("File"),qu=yt("Blob"),Bu=yt("FileList"),Uu=t=>mi(t)&&ct(t.pipe),ju=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||ct(t.append)&&((e=gi(t))==="formdata"||e==="object"&&ct(t.toString)&&t.toString()==="[object FormData]"))},Vu=yt("URLSearchParams"),[Wu,Yu,Ku,Gu]=["ReadableStream","Request","Response","Headers"].map(yt),zu=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function vr(t,e,{allOwnKeys:s=!1}={}){if(t===null||typeof t>"u")return;let r,i;if(typeof t!="object"&&(t=[t]),Ms(t))for(r=0,i=t.length;r<i;r++)e.call(null,t[r],r,t);else{const n=s?Object.getOwnPropertyNames(t):Object.keys(t),o=n.length;let a;for(r=0;r<o;r++)a=n[r],e.call(null,t[a],a,t)}}function pc(t,e){e=e.toLowerCase();const s=Object.keys(t);let r=s.length,i;for(;r-- >0;)if(i=s[r],e===i.toLowerCase())return i;return null}const fs=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,mc=t=>!lr(t)&&t!==fs;function ln(){const{caseless:t}=mc(this)&&this||{},e={},s=(r,i)=>{const n=t&&pc(e,i)||i;Pr(e[n])&&Pr(r)?e[n]=ln(e[n],r):Pr(r)?e[n]=ln({},r):Ms(r)?e[n]=r.slice():e[n]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&vr(arguments[r],s);return e}const Xu=(t,e,s,{allOwnKeys:r}={})=>(vr(e,(i,n)=>{s&&ct(i)?t[n]=hc(i,s):t[n]=i},{allOwnKeys:r}),t),Ju=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Zu=(t,e,s,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),s&&Object.assign(t.prototype,s)},Qu=(t,e,s,r)=>{let i,n,o;const a={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),n=i.length;n-- >0;)o=i[n],(!r||r(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=s!==!1&&Bn(t)}while(t&&(!s||s(t,e))&&t!==Object.prototype);return e},eh=(t,e,s)=>{t=String(t),(s===void 0||s>t.length)&&(s=t.length),s-=e.length;const r=t.indexOf(e,s);return r!==-1&&r===s},th=t=>{if(!t)return null;if(Ms(t))return t;let e=t.length;if(!gc(e))return null;const s=new Array(e);for(;e-- >0;)s[e]=t[e];return s},sh=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&Bn(Uint8Array)),rh=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let i;for(;(i=r.next())&&!i.done;){const n=i.value;e.call(t,n[0],n[1])}},ih=(t,e)=>{let s;const r=[];for(;(s=t.exec(e))!==null;)r.push(s);return r},nh=yt("HTMLFormElement"),oh=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,r,i){return r.toUpperCase()+i}),Ao=(({hasOwnProperty:t})=>(e,s)=>t.call(e,s))(Object.prototype),ah=yt("RegExp"),vc=(t,e)=>{const s=Object.getOwnPropertyDescriptors(t),r={};vr(s,(i,n)=>{let o;(o=e(i,n,t))!==!1&&(r[n]=o||i)}),Object.defineProperties(t,r)},ch=t=>{vc(t,(e,s)=>{if(ct(t)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const r=t[s];if(ct(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},lh=(t,e)=>{const s={},r=i=>{i.forEach(n=>{s[n]=!0})};return Ms(t)?r(t):r(String(t).split(e)),s},dh=()=>{},uh=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e,Mi="abcdefghijklmnopqrstuvwxyz",Io="0123456789",bc={DIGIT:Io,ALPHA:Mi,ALPHA_DIGIT:Mi+Mi.toUpperCase()+Io},hh=(t=16,e=bc.ALPHA_DIGIT)=>{let s="";const{length:r}=e;for(;t--;)s+=e[Math.random()*r|0];return s};function fh(t){return!!(t&&ct(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const gh=t=>{const e=new Array(10),s=(r,i)=>{if(mi(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[i]=r;const n=Ms(r)?[]:{};return vr(r,(o,a)=>{const c=s(o,i+1);!lr(c)&&(n[a]=c)}),e[i]=void 0,n}}return r};return s(t,0)},ph=yt("AsyncFunction"),mh=t=>t&&(mi(t)||ct(t))&&ct(t.then)&&ct(t.catch),wc=((t,e)=>t?setImmediate:e?((s,r)=>(fs.addEventListener("message",({source:i,data:n})=>{i===fs&&n===s&&r.length&&r.shift()()},!1),i=>{r.push(i),fs.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",ct(fs.postMessage)),vh=typeof queueMicrotask<"u"?queueMicrotask.bind(fs):typeof process<"u"&&process.nextTick||wc,_={isArray:Ms,isArrayBuffer:fc,isBuffer:ku,isFormData:ju,isArrayBufferView:Ou,isString:Lu,isNumber:gc,isBoolean:Mu,isObject:mi,isPlainObject:Pr,isReadableStream:Wu,isRequest:Yu,isResponse:Ku,isHeaders:Gu,isUndefined:lr,isDate:Fu,isFile:Nu,isBlob:qu,isRegExp:ah,isFunction:ct,isStream:Uu,isURLSearchParams:Vu,isTypedArray:sh,isFileList:Bu,forEach:vr,merge:ln,extend:Xu,trim:zu,stripBOM:Ju,inherits:Zu,toFlatObject:Qu,kindOf:gi,kindOfTest:yt,endsWith:eh,toArray:th,forEachEntry:rh,matchAll:ih,isHTMLForm:nh,hasOwnProperty:Ao,hasOwnProp:Ao,reduceDescriptors:vc,freezeMethods:ch,toObjectSet:lh,toCamelCase:oh,noop:dh,toFiniteNumber:uh,findKey:pc,global:fs,isContextDefined:mc,ALPHABET:bc,generateString:hh,isSpecCompliantForm:fh,toJSONObject:gh,isAsyncFn:ph,isThenable:mh,setImmediate:wc,asap:vh};function Q(t,e,s,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),s&&(this.config=s),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}_.inherits(Q,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:_.toJSONObject(this.config),code:this.code,status:this.status}}});const yc=Q.prototype,xc={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{xc[t]={value:t}});Object.defineProperties(Q,xc);Object.defineProperty(yc,"isAxiosError",{value:!0});Q.from=(t,e,s,r,i,n)=>{const o=Object.create(yc);return _.toFlatObject(t,o,function(c){return c!==Error.prototype},a=>a!=="isAxiosError"),Q.call(o,t.message,e,s,r,i),o.cause=t,o.name=t.name,n&&Object.assign(o,n),o};const bh=null;function dn(t){return _.isPlainObject(t)||_.isArray(t)}function Cc(t){return _.endsWith(t,"[]")?t.slice(0,-2):t}function Do(t,e,s){return t?t.concat(e).map(function(i,n){return i=Cc(i),!s&&n?"["+i+"]":i}).join(s?".":""):e}function wh(t){return _.isArray(t)&&!t.some(dn)}const yh=_.toFlatObject(_,{},null,function(e){return/^is[A-Z]/.test(e)});function vi(t,e,s){if(!_.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,s=_.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(C,A){return!_.isUndefined(A[C])});const r=s.metaTokens,i=s.visitor||l,n=s.dots,o=s.indexes,c=(s.Blob||typeof Blob<"u"&&Blob)&&_.isSpecCompliantForm(e);if(!_.isFunction(i))throw new TypeError("visitor must be a function");function d(w){if(w===null)return"";if(_.isDate(w))return w.toISOString();if(!c&&_.isBlob(w))throw new Q("Blob is not supported. Use a Buffer instead.");return _.isArrayBuffer(w)||_.isTypedArray(w)?c&&typeof Blob=="function"?new Blob([w]):Buffer.from(w):w}function l(w,C,A){let f=w;if(w&&!A&&typeof w=="object"){if(_.endsWith(C,"{}"))C=r?C:C.slice(0,-2),w=JSON.stringify(w);else if(_.isArray(w)&&wh(w)||(_.isFileList(w)||_.endsWith(C,"[]"))&&(f=_.toArray(w)))return C=Cc(C),f.forEach(function(j,R){!(_.isUndefined(j)||j===null)&&e.append(o===!0?Do([C],R,n):o===null?C:C+"[]",d(j))}),!1}return dn(w)?!0:(e.append(Do(A,C,n),d(w)),!1)}const u=[],p=Object.assign(yh,{defaultVisitor:l,convertValue:d,isVisitable:dn});function y(w,C){if(!_.isUndefined(w)){if(u.indexOf(w)!==-1)throw Error("Circular reference detected in "+C.join("."));u.push(w),_.forEach(w,function(f,I){(!(_.isUndefined(f)||f===null)&&i.call(e,f,_.isString(I)?I.trim():I,C,p))===!0&&y(f,C?C.concat(I):[I])}),u.pop()}}if(!_.isObject(t))throw new TypeError("data must be an object");return y(t),e}function Ho(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function Un(t,e){this._pairs=[],t&&vi(t,this,e)}const Tc=Un.prototype;Tc.append=function(e,s){this._pairs.push([e,s])};Tc.toString=function(e){const s=e?function(r){return e.call(this,r,Ho)}:Ho;return this._pairs.map(function(i){return s(i[0])+"="+s(i[1])},"").join("&")};function xh(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ec(t,e,s){if(!e)return t;const r=s&&s.encode||xh;_.isFunction(s)&&(s={serialize:s});const i=s&&s.serialize;let n;if(i?n=i(e,s):n=_.isURLSearchParams(e)?e.toString():new Un(e,s).toString(r),n){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+n}return t}class Po{constructor(){this.handlers=[]}use(e,s,r){return this.handlers.push({fulfilled:e,rejected:s,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){_.forEach(this.handlers,function(r){r!==null&&e(r)})}}const Sc={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ch=typeof URLSearchParams<"u"?URLSearchParams:Un,Th=typeof FormData<"u"?FormData:null,Eh=typeof Blob<"u"?Blob:null,Sh={isBrowser:!0,classes:{URLSearchParams:Ch,FormData:Th,Blob:Eh},protocols:["http","https","file","blob","url","data"]},jn=typeof window<"u"&&typeof document<"u",un=typeof navigator=="object"&&navigator||void 0,_h=jn&&(!un||["ReactNative","NativeScript","NS"].indexOf(un.product)<0),Rh=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",$h=jn&&window.location.href||"http://localhost",Ah=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:jn,hasStandardBrowserEnv:_h,hasStandardBrowserWebWorkerEnv:Rh,navigator:un,origin:$h},Symbol.toStringTag,{value:"Module"})),Ve={...Ah,...Sh};function Ih(t,e){return vi(t,new Ve.classes.URLSearchParams,Object.assign({visitor:function(s,r,i,n){return Ve.isNode&&_.isBuffer(s)?(this.append(r,s.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},e))}function Dh(t){return _.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Hh(t){const e={},s=Object.keys(t);let r;const i=s.length;let n;for(r=0;r<i;r++)n=s[r],e[n]=t[n];return e}function _c(t){function e(s,r,i,n){let o=s[n++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),c=n>=s.length;return o=!o&&_.isArray(i)?i.length:o,c?(_.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!a):((!i[o]||!_.isObject(i[o]))&&(i[o]=[]),e(s,r,i[o],n)&&_.isArray(i[o])&&(i[o]=Hh(i[o])),!a)}if(_.isFormData(t)&&_.isFunction(t.entries)){const s={};return _.forEachEntry(t,(r,i)=>{e(Dh(r),i,s,0)}),s}return null}function Ph(t,e,s){if(_.isString(t))try{return(e||JSON.parse)(t),_.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(0,JSON.stringify)(t)}const br={transitional:Sc,adapter:["xhr","http","fetch"],transformRequest:[function(e,s){const r=s.getContentType()||"",i=r.indexOf("application/json")>-1,n=_.isObject(e);if(n&&_.isHTMLForm(e)&&(e=new FormData(e)),_.isFormData(e))return i?JSON.stringify(_c(e)):e;if(_.isArrayBuffer(e)||_.isBuffer(e)||_.isStream(e)||_.isFile(e)||_.isBlob(e)||_.isReadableStream(e))return e;if(_.isArrayBufferView(e))return e.buffer;if(_.isURLSearchParams(e))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(n){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Ih(e,this.formSerializer).toString();if((a=_.isFileList(e))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return vi(a?{"files[]":e}:e,c&&new c,this.formSerializer)}}return n||i?(s.setContentType("application/json",!1),Ph(e)):e}],transformResponse:[function(e){const s=this.transitional||br.transitional,r=s&&s.forcedJSONParsing,i=this.responseType==="json";if(_.isResponse(e)||_.isReadableStream(e))return e;if(e&&_.isString(e)&&(r&&!this.responseType||i)){const o=!(s&&s.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?Q.from(a,Q.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ve.classes.FormData,Blob:Ve.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};_.forEach(["delete","get","head","post","put","patch"],t=>{br.headers[t]={}});const kh=_.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Oh=t=>{const e={};let s,r,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),s=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!s||e[s]&&kh[s])&&(s==="set-cookie"?e[s]?e[s].push(r):e[s]=[r]:e[s]=e[s]?e[s]+", "+r:r)}),e},ko=Symbol("internals");function Ys(t){return t&&String(t).trim().toLowerCase()}function kr(t){return t===!1||t==null?t:_.isArray(t)?t.map(kr):String(t)}function Lh(t){const e=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=s.exec(t);)e[r[1]]=r[2];return e}const Mh=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Fi(t,e,s,r,i){if(_.isFunction(r))return r.call(this,e,s);if(i&&(e=s),!!_.isString(e)){if(_.isString(r))return e.indexOf(r)!==-1;if(_.isRegExp(r))return r.test(e)}}function Fh(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,s,r)=>s.toUpperCase()+r)}function Nh(t,e){const s=_.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+s,{value:function(i,n,o){return this[r].call(this,e,i,n,o)},configurable:!0})})}class tt{constructor(e){e&&this.set(e)}set(e,s,r){const i=this;function n(a,c,d){const l=Ys(c);if(!l)throw new Error("header name must be a non-empty string");const u=_.findKey(i,l);(!u||i[u]===void 0||d===!0||d===void 0&&i[u]!==!1)&&(i[u||c]=kr(a))}const o=(a,c)=>_.forEach(a,(d,l)=>n(d,l,c));if(_.isPlainObject(e)||e instanceof this.constructor)o(e,s);else if(_.isString(e)&&(e=e.trim())&&!Mh(e))o(Oh(e),s);else if(_.isHeaders(e))for(const[a,c]of e.entries())n(c,a,r);else e!=null&&n(s,e,r);return this}get(e,s){if(e=Ys(e),e){const r=_.findKey(this,e);if(r){const i=this[r];if(!s)return i;if(s===!0)return Lh(i);if(_.isFunction(s))return s.call(this,i,r);if(_.isRegExp(s))return s.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,s){if(e=Ys(e),e){const r=_.findKey(this,e);return!!(r&&this[r]!==void 0&&(!s||Fi(this,this[r],r,s)))}return!1}delete(e,s){const r=this;let i=!1;function n(o){if(o=Ys(o),o){const a=_.findKey(r,o);a&&(!s||Fi(r,r[a],a,s))&&(delete r[a],i=!0)}}return _.isArray(e)?e.forEach(n):n(e),i}clear(e){const s=Object.keys(this);let r=s.length,i=!1;for(;r--;){const n=s[r];(!e||Fi(this,this[n],n,e,!0))&&(delete this[n],i=!0)}return i}normalize(e){const s=this,r={};return _.forEach(this,(i,n)=>{const o=_.findKey(r,n);if(o){s[o]=kr(i),delete s[n];return}const a=e?Fh(n):String(n).trim();a!==n&&delete s[n],s[a]=kr(i),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const s=Object.create(null);return _.forEach(this,(r,i)=>{r!=null&&r!==!1&&(s[i]=e&&_.isArray(r)?r.join(", "):r)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,s])=>e+": "+s).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...s){const r=new this(e);return s.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[ko]=this[ko]={accessors:{}}).accessors,i=this.prototype;function n(o){const a=Ys(o);r[a]||(Nh(i,o),r[a]=!0)}return _.isArray(e)?e.forEach(n):n(e),this}}tt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);_.reduceDescriptors(tt.prototype,({value:t},e)=>{let s=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[s]=r}}});_.freezeMethods(tt);function Ni(t,e){const s=this||br,r=e||s,i=tt.from(r.headers);let n=r.data;return _.forEach(t,function(a){n=a.call(s,n,i.normalize(),e?e.status:void 0)}),i.normalize(),n}function Rc(t){return!!(t&&t.__CANCEL__)}function Fs(t,e,s){Q.call(this,t??"canceled",Q.ERR_CANCELED,e,s),this.name="CanceledError"}_.inherits(Fs,Q,{__CANCEL__:!0});function $c(t,e,s){const r=s.config.validateStatus;!s.status||!r||r(s.status)?t(s):e(new Q("Request failed with status code "+s.status,[Q.ERR_BAD_REQUEST,Q.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function qh(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function Bh(t,e){t=t||10;const s=new Array(t),r=new Array(t);let i=0,n=0,o;return e=e!==void 0?e:1e3,function(c){const d=Date.now(),l=r[n];o||(o=d),s[i]=c,r[i]=d;let u=n,p=0;for(;u!==i;)p+=s[u++],u=u%t;if(i=(i+1)%t,i===n&&(n=(n+1)%t),d-o<e)return;const y=l&&d-l;return y?Math.round(p*1e3/y):void 0}}function Uh(t,e){let s=0,r=1e3/e,i,n;const o=(d,l=Date.now())=>{s=l,i=null,n&&(clearTimeout(n),n=null),t.apply(null,d)};return[(...d)=>{const l=Date.now(),u=l-s;u>=r?o(d,l):(i=d,n||(n=setTimeout(()=>{n=null,o(i)},r-u)))},()=>i&&o(i)]}const Gr=(t,e,s=3)=>{let r=0;const i=Bh(50,250);return Uh(n=>{const o=n.loaded,a=n.lengthComputable?n.total:void 0,c=o-r,d=i(c),l=o<=a;r=o;const u={loaded:o,total:a,progress:a?o/a:void 0,bytes:c,rate:d||void 0,estimated:d&&a&&l?(a-o)/d:void 0,event:n,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(u)},s)},Oo=(t,e)=>{const s=t!=null;return[r=>e[0]({lengthComputable:s,total:t,loaded:r}),e[1]]},Lo=t=>(...e)=>_.asap(()=>t(...e)),jh=Ve.hasStandardBrowserEnv?((t,e)=>s=>(s=new URL(s,Ve.origin),t.protocol===s.protocol&&t.host===s.host&&(e||t.port===s.port)))(new URL(Ve.origin),Ve.navigator&&/(msie|trident)/i.test(Ve.navigator.userAgent)):()=>!0,Vh=Ve.hasStandardBrowserEnv?{write(t,e,s,r,i,n){const o=[t+"="+encodeURIComponent(e)];_.isNumber(s)&&o.push("expires="+new Date(s).toGMTString()),_.isString(r)&&o.push("path="+r),_.isString(i)&&o.push("domain="+i),n===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Wh(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Yh(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function Ac(t,e){return t&&!Wh(e)?Yh(t,e):e}const Mo=t=>t instanceof tt?{...t}:t;function ys(t,e){e=e||{};const s={};function r(d,l,u,p){return _.isPlainObject(d)&&_.isPlainObject(l)?_.merge.call({caseless:p},d,l):_.isPlainObject(l)?_.merge({},l):_.isArray(l)?l.slice():l}function i(d,l,u,p){if(_.isUndefined(l)){if(!_.isUndefined(d))return r(void 0,d,u,p)}else return r(d,l,u,p)}function n(d,l){if(!_.isUndefined(l))return r(void 0,l)}function o(d,l){if(_.isUndefined(l)){if(!_.isUndefined(d))return r(void 0,d)}else return r(void 0,l)}function a(d,l,u){if(u in e)return r(d,l);if(u in t)return r(void 0,d)}const c={url:n,method:n,data:n,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(d,l,u)=>i(Mo(d),Mo(l),u,!0)};return _.forEach(Object.keys(Object.assign({},t,e)),function(l){const u=c[l]||i,p=u(t[l],e[l],l);_.isUndefined(p)&&u!==a||(s[l]=p)}),s}const Ic=t=>{const e=ys({},t);let{data:s,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:n,headers:o,auth:a}=e;e.headers=o=tt.from(o),e.url=Ec(Ac(e.baseURL,e.url),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let c;if(_.isFormData(s)){if(Ve.hasStandardBrowserEnv||Ve.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[d,...l]=c?c.split(";").map(u=>u.trim()).filter(Boolean):[];o.setContentType([d||"multipart/form-data",...l].join("; "))}}if(Ve.hasStandardBrowserEnv&&(r&&_.isFunction(r)&&(r=r(e)),r||r!==!1&&jh(e.url))){const d=i&&n&&Vh.read(n);d&&o.set(i,d)}return e},Kh=typeof XMLHttpRequest<"u",Gh=Kh&&function(t){return new Promise(function(s,r){const i=Ic(t);let n=i.data;const o=tt.from(i.headers).normalize();let{responseType:a,onUploadProgress:c,onDownloadProgress:d}=i,l,u,p,y,w;function C(){y&&y(),w&&w(),i.cancelToken&&i.cancelToken.unsubscribe(l),i.signal&&i.signal.removeEventListener("abort",l)}let A=new XMLHttpRequest;A.open(i.method.toUpperCase(),i.url,!0),A.timeout=i.timeout;function f(){if(!A)return;const j=tt.from("getAllResponseHeaders"in A&&A.getAllResponseHeaders()),W={data:!a||a==="text"||a==="json"?A.responseText:A.response,status:A.status,statusText:A.statusText,headers:j,config:t,request:A};$c(function(he){s(he),C()},function(he){r(he),C()},W),A=null}"onloadend"in A?A.onloadend=f:A.onreadystatechange=function(){!A||A.readyState!==4||A.status===0&&!(A.responseURL&&A.responseURL.indexOf("file:")===0)||setTimeout(f)},A.onabort=function(){A&&(r(new Q("Request aborted",Q.ECONNABORTED,t,A)),A=null)},A.onerror=function(){r(new Q("Network Error",Q.ERR_NETWORK,t,A)),A=null},A.ontimeout=function(){let R=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const W=i.transitional||Sc;i.timeoutErrorMessage&&(R=i.timeoutErrorMessage),r(new Q(R,W.clarifyTimeoutError?Q.ETIMEDOUT:Q.ECONNABORTED,t,A)),A=null},n===void 0&&o.setContentType(null),"setRequestHeader"in A&&_.forEach(o.toJSON(),function(R,W){A.setRequestHeader(W,R)}),_.isUndefined(i.withCredentials)||(A.withCredentials=!!i.withCredentials),a&&a!=="json"&&(A.responseType=i.responseType),d&&([p,w]=Gr(d,!0),A.addEventListener("progress",p)),c&&A.upload&&([u,y]=Gr(c),A.upload.addEventListener("progress",u),A.upload.addEventListener("loadend",y)),(i.cancelToken||i.signal)&&(l=j=>{A&&(r(!j||j.type?new Fs(null,t,A):j),A.abort(),A=null)},i.cancelToken&&i.cancelToken.subscribe(l),i.signal&&(i.signal.aborted?l():i.signal.addEventListener("abort",l)));const I=qh(i.url);if(I&&Ve.protocols.indexOf(I)===-1){r(new Q("Unsupported protocol "+I+":",Q.ERR_BAD_REQUEST,t));return}A.send(n||null)})},zh=(t,e)=>{const{length:s}=t=t?t.filter(Boolean):[];if(e||s){let r=new AbortController,i;const n=function(d){if(!i){i=!0,a();const l=d instanceof Error?d:this.reason;r.abort(l instanceof Q?l:new Fs(l instanceof Error?l.message:l))}};let o=e&&setTimeout(()=>{o=null,n(new Q(`timeout ${e} of ms exceeded`,Q.ETIMEDOUT))},e);const a=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(d=>{d.unsubscribe?d.unsubscribe(n):d.removeEventListener("abort",n)}),t=null)};t.forEach(d=>d.addEventListener("abort",n));const{signal:c}=r;return c.unsubscribe=()=>_.asap(a),c}},Xh=function*(t,e){let s=t.byteLength;if(s<e){yield t;return}let r=0,i;for(;r<s;)i=r+e,yield t.slice(r,i),r=i},Jh=async function*(t,e){for await(const s of Zh(t))yield*Xh(s,e)},Zh=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:s,value:r}=await e.read();if(s)break;yield r}}finally{await e.cancel()}},Fo=(t,e,s,r)=>{const i=Jh(t,e);let n=0,o,a=c=>{o||(o=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:d,value:l}=await i.next();if(d){a(),c.close();return}let u=l.byteLength;if(s){let p=n+=u;s(p)}c.enqueue(new Uint8Array(l))}catch(d){throw a(d),d}},cancel(c){return a(c),i.return()}},{highWaterMark:2})},bi=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Dc=bi&&typeof ReadableStream=="function",Qh=bi&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),Hc=(t,...e)=>{try{return!!t(...e)}catch{return!1}},ef=Dc&&Hc(()=>{let t=!1;const e=new Request(Ve.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),No=64*1024,hn=Dc&&Hc(()=>_.isReadableStream(new Response("").body)),zr={stream:hn&&(t=>t.body)};bi&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!zr[e]&&(zr[e]=_.isFunction(t[e])?s=>s[e]():(s,r)=>{throw new Q(`Response type '${e}' is not supported`,Q.ERR_NOT_SUPPORT,r)})})})(new Response);const tf=async t=>{if(t==null)return 0;if(_.isBlob(t))return t.size;if(_.isSpecCompliantForm(t))return(await new Request(Ve.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(_.isArrayBufferView(t)||_.isArrayBuffer(t))return t.byteLength;if(_.isURLSearchParams(t)&&(t=t+""),_.isString(t))return(await Qh(t)).byteLength},sf=async(t,e)=>{const s=_.toFiniteNumber(t.getContentLength());return s??tf(e)},rf=bi&&(async t=>{let{url:e,method:s,data:r,signal:i,cancelToken:n,timeout:o,onDownloadProgress:a,onUploadProgress:c,responseType:d,headers:l,withCredentials:u="same-origin",fetchOptions:p}=Ic(t);d=d?(d+"").toLowerCase():"text";let y=zh([i,n&&n.toAbortSignal()],o),w;const C=y&&y.unsubscribe&&(()=>{y.unsubscribe()});let A;try{if(c&&ef&&s!=="get"&&s!=="head"&&(A=await sf(l,r))!==0){let W=new Request(e,{method:"POST",body:r,duplex:"half"}),xe;if(_.isFormData(r)&&(xe=W.headers.get("content-type"))&&l.setContentType(xe),W.body){const[he,h]=Oo(A,Gr(Lo(c)));r=Fo(W.body,No,he,h)}}_.isString(u)||(u=u?"include":"omit");const f="credentials"in Request.prototype;w=new Request(e,{...p,signal:y,method:s.toUpperCase(),headers:l.normalize().toJSON(),body:r,duplex:"half",credentials:f?u:void 0});let I=await fetch(w);const j=hn&&(d==="stream"||d==="response");if(hn&&(a||j&&C)){const W={};["status","statusText","headers"].forEach(ee=>{W[ee]=I[ee]});const xe=_.toFiniteNumber(I.headers.get("content-length")),[he,h]=a&&Oo(xe,Gr(Lo(a),!0))||[];I=new Response(Fo(I.body,No,he,()=>{h&&h(),C&&C()}),W)}d=d||"text";let R=await zr[_.findKey(zr,d)||"text"](I,t);return!j&&C&&C(),await new Promise((W,xe)=>{$c(W,xe,{data:R,headers:tt.from(I.headers),status:I.status,statusText:I.statusText,config:t,request:w})})}catch(f){throw C&&C(),f&&f.name==="TypeError"&&/fetch/i.test(f.message)?Object.assign(new Q("Network Error",Q.ERR_NETWORK,t,w),{cause:f.cause||f}):Q.from(f,f&&f.code,t,w)}}),fn={http:bh,xhr:Gh,fetch:rf};_.forEach(fn,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const qo=t=>`- ${t}`,nf=t=>_.isFunction(t)||t===null||t===!1,Pc={getAdapter:t=>{t=_.isArray(t)?t:[t];const{length:e}=t;let s,r;const i={};for(let n=0;n<e;n++){s=t[n];let o;if(r=s,!nf(s)&&(r=fn[(o=String(s)).toLowerCase()],r===void 0))throw new Q(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+n]=r}if(!r){const n=Object.entries(i).map(([a,c])=>`adapter ${a} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=e?n.length>1?`since :
`+n.map(qo).join(`
`):" "+qo(n[0]):"as no adapter specified";throw new Q("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:fn};function qi(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Fs(null,t)}function Bo(t){return qi(t),t.headers=tt.from(t.headers),t.data=Ni.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Pc.getAdapter(t.adapter||br.adapter)(t).then(function(r){return qi(t),r.data=Ni.call(t,t.transformResponse,r),r.headers=tt.from(r.headers),r},function(r){return Rc(r)||(qi(t),r&&r.response&&(r.response.data=Ni.call(t,t.transformResponse,r.response),r.response.headers=tt.from(r.response.headers))),Promise.reject(r)})}const kc="1.7.9",wi={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{wi[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const Uo={};wi.transitional=function(e,s,r){function i(n,o){return"[Axios v"+kc+"] Transitional option '"+n+"'"+o+(r?". "+r:"")}return(n,o,a)=>{if(e===!1)throw new Q(i(o," has been removed"+(s?" in "+s:"")),Q.ERR_DEPRECATED);return s&&!Uo[o]&&(Uo[o]=!0,console.warn(i(o," has been deprecated since v"+s+" and will be removed in the near future"))),e?e(n,o,a):!0}};wi.spelling=function(e){return(s,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function of(t,e,s){if(typeof t!="object")throw new Q("options must be an object",Q.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const n=r[i],o=e[n];if(o){const a=t[n],c=a===void 0||o(a,n,t);if(c!==!0)throw new Q("option "+n+" must be "+c,Q.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new Q("Unknown option "+n,Q.ERR_BAD_OPTION)}}const Or={assertOptions:of,validators:wi},Et=Or.validators;class vs{constructor(e){this.defaults=e,this.interceptors={request:new Po,response:new Po}}async request(e,s){try{return await this._request(e,s)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const n=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?n&&!String(r.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+n):r.stack=n}catch{}}throw r}}_request(e,s){typeof e=="string"?(s=s||{},s.url=e):s=e||{},s=ys(this.defaults,s);const{transitional:r,paramsSerializer:i,headers:n}=s;r!==void 0&&Or.assertOptions(r,{silentJSONParsing:Et.transitional(Et.boolean),forcedJSONParsing:Et.transitional(Et.boolean),clarifyTimeoutError:Et.transitional(Et.boolean)},!1),i!=null&&(_.isFunction(i)?s.paramsSerializer={serialize:i}:Or.assertOptions(i,{encode:Et.function,serialize:Et.function},!0)),Or.assertOptions(s,{baseUrl:Et.spelling("baseURL"),withXsrfToken:Et.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let o=n&&_.merge(n.common,n[s.method]);n&&_.forEach(["delete","get","head","post","put","patch","common"],w=>{delete n[w]}),s.headers=tt.concat(o,n);const a=[];let c=!0;this.interceptors.request.forEach(function(C){typeof C.runWhen=="function"&&C.runWhen(s)===!1||(c=c&&C.synchronous,a.unshift(C.fulfilled,C.rejected))});const d=[];this.interceptors.response.forEach(function(C){d.push(C.fulfilled,C.rejected)});let l,u=0,p;if(!c){const w=[Bo.bind(this),void 0];for(w.unshift.apply(w,a),w.push.apply(w,d),p=w.length,l=Promise.resolve(s);u<p;)l=l.then(w[u++],w[u++]);return l}p=a.length;let y=s;for(u=0;u<p;){const w=a[u++],C=a[u++];try{y=w(y)}catch(A){C.call(this,A);break}}try{l=Bo.call(this,y)}catch(w){return Promise.reject(w)}for(u=0,p=d.length;u<p;)l=l.then(d[u++],d[u++]);return l}getUri(e){e=ys(this.defaults,e);const s=Ac(e.baseURL,e.url);return Ec(s,e.params,e.paramsSerializer)}}_.forEach(["delete","get","head","options"],function(e){vs.prototype[e]=function(s,r){return this.request(ys(r||{},{method:e,url:s,data:(r||{}).data}))}});_.forEach(["post","put","patch"],function(e){function s(r){return function(n,o,a){return this.request(ys(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:n,data:o}))}}vs.prototype[e]=s(),vs.prototype[e+"Form"]=s(!0)});class Vn{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(n){s=n});const r=this;this.promise.then(i=>{if(!r._listeners)return;let n=r._listeners.length;for(;n-- >0;)r._listeners[n](i);r._listeners=null}),this.promise.then=i=>{let n;const o=new Promise(a=>{r.subscribe(a),n=a}).then(i);return o.cancel=function(){r.unsubscribe(n)},o},e(function(n,o,a){r.reason||(r.reason=new Fs(n,o,a),s(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const s=this._listeners.indexOf(e);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const e=new AbortController,s=r=>{e.abort(r)};return this.subscribe(s),e.signal.unsubscribe=()=>this.unsubscribe(s),e.signal}static source(){let e;return{token:new Vn(function(i){e=i}),cancel:e}}}function af(t){return function(s){return t.apply(null,s)}}function cf(t){return _.isObject(t)&&t.isAxiosError===!0}const gn={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(gn).forEach(([t,e])=>{gn[e]=t});function Oc(t){const e=new vs(t),s=hc(vs.prototype.request,e);return _.extend(s,vs.prototype,e,{allOwnKeys:!0}),_.extend(s,e,null,{allOwnKeys:!0}),s.create=function(i){return Oc(ys(t,i))},s}const ce=Oc(br);ce.Axios=vs;ce.CanceledError=Fs;ce.CancelToken=Vn;ce.isCancel=Rc;ce.VERSION=kc;ce.toFormData=vi;ce.AxiosError=Q;ce.Cancel=ce.CanceledError;ce.all=function(e){return Promise.all(e)};ce.spread=af;ce.isAxiosError=cf;ce.mergeConfig=ys;ce.AxiosHeaders=tt;ce.formToJSON=t=>_c(_.isHTMLForm(t)?new FormData(t):t);ce.getAdapter=Pc.getAdapter;ce.HttpStatusCode=gn;ce.default=ce;ce.defaults.headers.common["Content-Type"]="application/json";ce.defaults.headers.common.Accept="application/json";ce.defaults.withCredentials=!1;ce.defaults.baseURL="https://api.omni.c-icare.cc";ce.interceptors.response.use(function(t){return t},function(t){return Promise.reject(t)});var lf=!1;/*!
 * pinia v2.3.0
 * (c) 2024 Eduardo San Martin Morote
 * @license MIT
 */let Lc;const yi=t=>Lc=t,Mc=Symbol();function pn(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var sr;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(sr||(sr={}));function df(){const t=da(!0),e=t.run(()=>se({}));let s=[],r=[];const i=Pn({install(n){yi(i),i._a=n,n.provide(Mc,i),n.config.globalProperties.$pinia=i,r.forEach(o=>s.push(o)),r=[]},use(n){return!this._a&&!lf?r.push(n):s.push(n),this},_p:s,_a:null,_e:t,_s:new Map,state:e});return i}const Fc=()=>{};function jo(t,e,s,r=Fc){t.push(e);const i=()=>{const n=t.indexOf(e);n>-1&&(t.splice(n,1),r())};return!s&&ua()&&xl(i),i}function Ts(t,...e){t.slice().forEach(s=>{s(...e)})}const uf=t=>t(),Vo=Symbol(),Bi=Symbol();function mn(t,e){t instanceof Map&&e instanceof Map?e.forEach((s,r)=>t.set(r,s)):t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const s in e){if(!e.hasOwnProperty(s))continue;const r=e[s],i=t[s];pn(i)&&pn(r)&&t.hasOwnProperty(s)&&!Se(r)&&!es(r)?t[s]=mn(i,r):t[s]=r}return t}const hf=Symbol();function ff(t){return!pn(t)||!t.hasOwnProperty(hf)}const{assign:Yt}=Object;function gf(t){return!!(Se(t)&&t.effect)}function pf(t,e,s,r){const{state:i,actions:n,getters:o}=e,a=s.state.value[t];let c;function d(){a||(s.state.value[t]=i?i():{});const l=Wl(s.state.value[t]);return Yt(l,n,Object.keys(o||{}).reduce((u,p)=>(u[p]=Pn(wt(()=>{yi(s);const y=s._s.get(t);return o[p].call(y,y)})),u),{}))}return c=Nc(t,d,e,s,r,!0),c}function Nc(t,e,s={},r,i,n){let o;const a=Yt({actions:{}},s),c={deep:!0};let d,l,u=[],p=[],y;const w=r.state.value[t];!n&&!w&&(r.state.value[t]={}),se({});let C;function A(h){let ee;d=l=!1,typeof h=="function"?(h(r.state.value[t]),ee={type:sr.patchFunction,storeId:t,events:y}):(mn(r.state.value[t],h),ee={type:sr.patchObject,payload:h,storeId:t,events:y});const we=C=Symbol();et().then(()=>{C===we&&(d=!0)}),l=!0,Ts(u,ee,r.state.value[t])}const f=n?function(){const{state:ee}=s,we=ee?ee():{};this.$patch(b=>{Yt(b,we)})}:Fc;function I(){o.stop(),u=[],p=[],r._s.delete(t)}const j=(h,ee="")=>{if(Vo in h)return h[Bi]=ee,h;const we=function(){yi(r);const b=Array.from(arguments),T=[],x=[];function ke(M){T.push(M)}function le(M){x.push(M)}Ts(p,{args:b,name:we[Bi],store:W,after:ke,onError:le});let re;try{re=h.apply(this&&this.$id===t?this:W,b)}catch(M){throw Ts(x,M),M}return re instanceof Promise?re.then(M=>(Ts(T,M),M)).catch(M=>(Ts(x,M),Promise.reject(M))):(Ts(T,re),re)};return we[Vo]=!0,we[Bi]=ee,we},R={_p:r,$id:t,$onAction:jo.bind(null,p),$patch:A,$reset:f,$subscribe(h,ee={}){const we=jo(u,h,ee.detached,()=>b()),b=o.run(()=>ht(()=>r.state.value[t],T=>{(ee.flush==="sync"?l:d)&&h({storeId:t,type:sr.direct,events:y},T)},Yt({},c,ee)));return we},$dispose:I},W=ai(R);r._s.set(t,W);const he=(r._a&&r._a.runWithContext||uf)(()=>r._e.run(()=>(o=da()).run(()=>e({action:j}))));for(const h in he){const ee=he[h];if(Se(ee)&&!gf(ee)||es(ee))n||(w&&ff(ee)&&(Se(ee)?ee.value=w[h]:mn(ee,w[h])),r.state.value[t][h]=ee);else if(typeof ee=="function"){const we=j(ee,h);he[h]=we,a.actions[h]=ee}}return Yt(W,he),Yt(oe(W),he),Object.defineProperty(W,"$state",{get:()=>r.state.value[t],set:h=>{A(ee=>{Yt(ee,h)})}}),r._p.forEach(h=>{Yt(W,o.run(()=>h({store:W,app:r._a,pinia:r,options:a})))}),w&&n&&s.hydrate&&s.hydrate(W.$state,w),d=!0,l=!0,W}/*! #__NO_SIDE_EFFECTS__ */function Wn(t,e,s){let r,i;const n=typeof e=="function";typeof t=="string"?(r=t,i=n?s:e):(i=t,r=t.id);function o(a,c){const d=Ed();return a=a||(d?Qs(Mc,null):null),a&&yi(a),a=Lc,a._s.has(r)||(n?Nc(r,e,i,a):pf(r,i,a)),a._s.get(r)}return o.$id=r,o}const mf="0.21.1";class xs extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class vn extends xs{constructor(e){super(e||"Unsupported content type.")}}class bn extends xs{constructor(e){super(e||"Request pending.")}}class vf extends xs{constructor(e){super(e||"Unspecified session description handler error.")}}class Ui extends xs{constructor(){super("The session has terminated.")}}class Ks extends xs{constructor(e){super(e||"An error occurred during state transition.")}}class bf{constructor(e){this.incomingAckRequest=e}get request(){return this.incomingAckRequest.message}}class wf{constructor(e){this.incomingByeRequest=e}get request(){return this.incomingByeRequest.message}accept(e){return this.incomingByeRequest.accept(e),Promise.resolve()}reject(e){return this.incomingByeRequest.reject(e),Promise.resolve()}}class yf{constructor(e){this.incomingCancelRequest=e}get request(){return this.incomingCancelRequest}}class dr{constructor(){this.listeners=new Array}addListener(e,s){const r=i=>{this.removeListener(r),e(i)};(s==null?void 0:s.once)===!0?this.listeners.push(r):this.listeners.push(e)}emit(e){this.listeners.slice().forEach(s=>s(e))}removeAllListeners(){this.listeners=[]}removeListener(e){this.listeners=this.listeners.filter(s=>s!==e)}on(e){return this.addListener(e)}off(e){return this.removeListener(e)}once(e){return this.addListener(e,{once:!0})}}class xf{constructor(e){this.incomingInfoRequest=e}get request(){return this.incomingInfoRequest.message}accept(e){return this.incomingInfoRequest.accept(e),Promise.resolve()}reject(e){return this.incomingInfoRequest.reject(e),Promise.resolve()}}class qc{constructor(e){this.parameters={};for(const s in e)e.hasOwnProperty(s)&&this.setParam(s,e[s])}setParam(e,s){e&&(this.parameters[e.toLowerCase()]=typeof s>"u"||s===null?null:s.toString())}getParam(e){if(e)return this.parameters[e.toLowerCase()]}hasParam(e){return!!(e&&this.parameters[e.toLowerCase()]!==void 0)}deleteParam(e){if(e=e.toLowerCase(),this.hasParam(e)){const s=this.parameters[e];return delete this.parameters[e],s}}clearParams(){this.parameters={}}}class Je extends qc{constructor(e,s,r){super(r),this.uri=e,this._displayName=s}get friendlyName(){return this.displayName||this.uri.aor}get displayName(){return this._displayName}set displayName(e){this._displayName=e}clone(){return new Je(this.uri.clone(),this._displayName,JSON.parse(JSON.stringify(this.parameters)))}toString(){let e=this.displayName||this.displayName==="0"?'"'+this.displayName+'" ':"";e+="<"+this.uri.toString()+">";for(const s in this.parameters)this.parameters.hasOwnProperty(s)&&(e+=";"+s,this.parameters[s]!==null&&(e+="="+this.parameters[s]));return e}}class It extends qc{constructor(e="sip",s,r,i,n,o){if(super(n||{}),this.headers={},!r)throw new TypeError('missing or invalid "host" parameter');for(const a in o)o.hasOwnProperty(a)&&this.setHeader(a,o[a]);this.raw={scheme:e,user:s,host:r,port:i},this.normal={scheme:e.toLowerCase(),user:s,host:r.toLowerCase(),port:i}}get scheme(){return this.normal.scheme}set scheme(e){this.raw.scheme=e,this.normal.scheme=e.toLowerCase()}get user(){return this.normal.user}set user(e){this.normal.user=this.raw.user=e}get host(){return this.normal.host}set host(e){this.raw.host=e,this.normal.host=e.toLowerCase()}get aor(){return this.normal.user+"@"+this.normal.host}get port(){return this.normal.port}set port(e){this.normal.port=this.raw.port=e}setHeader(e,s){this.headers[this.headerize(e)]=s instanceof Array?s:[s]}getHeader(e){if(e)return this.headers[this.headerize(e)]}hasHeader(e){return!!e&&!!this.headers.hasOwnProperty(this.headerize(e))}deleteHeader(e){if(e=this.headerize(e),this.headers.hasOwnProperty(e)){const s=this.headers[e];return delete this.headers[e],s}}clearHeaders(){this.headers={}}clone(){return new It(this._raw.scheme,this._raw.user||"",this._raw.host,this._raw.port,JSON.parse(JSON.stringify(this.parameters)),JSON.parse(JSON.stringify(this.headers)))}toRaw(){return this._toString(this._raw)}toString(){return this._toString(this._normal)}get _normal(){return this.normal}get _raw(){return this.raw}_toString(e){let s=e.scheme+":";e.scheme.toLowerCase().match("^sips?$")||(s+="//"),e.user&&(s+=this.escapeUser(e.user)+"@"),s+=e.host,(e.port||e.port===0)&&(s+=":"+e.port);for(const i in this.parameters)this.parameters.hasOwnProperty(i)&&(s+=";"+i,this.parameters[i]!==null&&(s+="="+this.parameters[i]));const r=[];for(const i in this.headers)if(this.headers.hasOwnProperty(i))for(const n in this.headers[i])this.headers[i].hasOwnProperty(n)&&r.push(i+"="+this.headers[i][n]);return r.length>0&&(s+="?"+r.join("&")),s}escapeUser(e){let s;try{s=decodeURIComponent(e)}catch(r){throw r}return encodeURIComponent(s).replace(/%3A/ig,":").replace(/%2B/ig,"+").replace(/%3F/ig,"?").replace(/%2F/ig,"/")}headerize(e){const s={"Call-Id":"Call-ID",Cseq:"CSeq","Min-Se":"Min-SE",Rack:"RAck",Rseq:"RSeq","Www-Authenticate":"WWW-Authenticate"},r=e.toLowerCase().replace(/_/g,"-").split("-"),i=r.length;let n="";for(let o=0;o<i;o++)o!==0&&(n+="-"),n+=r[o].charAt(0).toUpperCase()+r[o].substring(1);return s[n]&&(n=s[n]),n}}function Wo(t,e){if(t.scheme!==e.scheme||t.user!==e.user||t.host!==e.host||t.port!==e.port)return!1;function s(n,o){const a=Object.keys(n.parameters),c=Object.keys(o.parameters);return!(!a.filter(l=>c.includes(l)).every(l=>n.parameters[l]===o.parameters[l])||!["user","ttl","method","transport"].every(l=>n.hasParam(l)&&o.hasParam(l)||!n.hasParam(l)&&!o.hasParam(l))||!["maddr"].every(l=>n.hasParam(l)&&o.hasParam(l)||!n.hasParam(l)&&!o.hasParam(l)))}if(!s(t,e))return!1;const r=Object.keys(t.headers),i=Object.keys(e.headers);if(r.length!==0||i.length!==0){if(r.length!==i.length)return!1;const n=r.filter(o=>i.includes(o));if(n.length!==i.length||!n.every(o=>t.headers[o].length&&e.headers[o].length&&t.headers[o][0]===e.headers[o][0]))return!1}return!0}function ji(t,e,s){return s=s||" ",t.length>e?t:(e-=t.length,s+=s.repeat(e),t+s.slice(0,e))}class Hs extends Error{constructor(e,s,r,i){super(),this.message=e,this.expected=s,this.found=r,this.location=i,this.name="SyntaxError",typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(this,Hs.prototype):this.__proto__=Hs.prototype,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Hs)}static buildMessage(e,s){function r(d){return d.charCodeAt(0).toString(16).toUpperCase()}function i(d){return d.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,l=>"\\x0"+r(l)).replace(/[\x10-\x1F\x7F-\x9F]/g,l=>"\\x"+r(l))}function n(d){return d.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,l=>"\\x0"+r(l)).replace(/[\x10-\x1F\x7F-\x9F]/g,l=>"\\x"+r(l))}function o(d){switch(d.type){case"literal":return'"'+i(d.text)+'"';case"class":const l=d.parts.map(u=>Array.isArray(u)?n(u[0])+"-"+n(u[1]):n(u));return"["+(d.inverted?"^":"")+l+"]";case"any":return"any character";case"end":return"end of input";case"other":return d.description}}function a(d){const l=d.map(o);let u,p;if(l.sort(),l.length>0){for(u=1,p=1;u<l.length;u++)l[u-1]!==l[u]&&(l[p]=l[u],p++);l.length=p}switch(l.length){case 1:return l[0];case 2:return l[0]+" or "+l[1];default:return l.slice(0,-1).join(", ")+", or "+l[l.length-1]}}function c(d){return d?'"'+i(d)+'"':"end of input"}return"Expected "+a(e)+" but "+c(s)+" found."}format(e){let s="Error: "+this.message;if(this.location){let r=null,i;for(i=0;i<e.length;i++)if(e[i].source===this.location.source){r=e[i].text.split(/\r\n|\n|\r/g);break}let n=this.location.start,o=this.location.source+":"+n.line+":"+n.column;if(r){let a=this.location.end,c=ji("",n.line.toString().length," "),d=r[n.line-1],l=n.line===a.line?a.column:d.length+1;s+=`
 --> `+o+`
`+c+` |
`+n.line+" | "+d+`
`+c+" | "+ji("",n.column-1," ")+ji("",l-n.column,"^")}else s+=`
 at `+o}return s}}function Cf(t,e){e=e!==void 0?e:{};const s={},r=e.grammarSource,i={Contact:119,Name_Addr_Header:156,Record_Route:176,Request_Response:81,SIP_URI:45,Subscription_State:186,Supported:191,Require:182,Via:194,absoluteURI:84,Call_ID:118,Content_Disposition:130,Content_Length:135,Content_Type:136,CSeq:146,displayName:122,Event:149,From:151,host:52,Max_Forwards:154,Min_SE:213,Proxy_Authenticate:157,quoted_string:40,Refer_To:178,Replaces:179,Session_Expires:210,stun_URI:217,To:192,turn_URI:223,uuid:226,WWW_Authenticate:209,challenge:158,sipfrag:230,Referred_By:231};let n=119;const o=[`\r
`,f(`\r
`,!1),/^[0-9]/,I([["0","9"]],!1,!1),/^[a-zA-Z]/,I([["a","z"],["A","Z"]],!1,!1),/^[0-9a-fA-F]/,I([["0","9"],["a","f"],["A","F"]],!1,!1),/^[\0-\xFF]/,I([["\0","ÿ"]],!1,!1),/^["]/,I(['"'],!1,!1)," ",f(" ",!1),"	",f("	",!1),/^[a-zA-Z0-9]/,I([["a","z"],["A","Z"],["0","9"]],!1,!1),";",f(";",!1),"/",f("/",!1),"?",f("?",!1),":",f(":",!1),"@",f("@",!1),"&",f("&",!1),"=",f("=",!1),"+",f("+",!1),"$",f("$",!1),",",f(",",!1),"-",f("-",!1),"_",f("_",!1),".",f(".",!1),"!",f("!",!1),"~",f("~",!1),"*",f("*",!1),"'",f("'",!1),"(",f("(",!1),")",f(")",!1),"%",f("%",!1),function(){return" "},function(){return":"},/^[!-~]/,I([["!","~"]],!1,!1),/^[\x80-\uFFFF]/,I([["","￿"]],!1,!1),/^[\x80-\xBF]/,I([["","¿"]],!1,!1),/^[a-f]/,I([["a","f"]],!1,!1),"`",f("`",!1),"<",f("<",!1),">",f(">",!1),"\\",f("\\",!1),"[",f("[",!1),"]",f("]",!1),"{",f("{",!1),"}",f("}",!1),function(){return"*"},function(){return"/"},function(){return"="},function(){return"("},function(){return")"},function(){return">"},function(){return"<"},function(){return","},function(){return";"},function(){return":"},function(){return'"'},/^[!-']/,I([["!","'"]],!1,!1),/^[*-[]/,I([["*","["]],!1,!1),/^[\]-~]/,I([["]","~"]],!1,!1),function(b){return b},/^[#-[]/,I([["#","["]],!1,!1),/^[\0-\t]/,I([["\0","	"]],!1,!1),/^[\v-\f]/,I([["\v","\f"]],!1,!1),/^[\x0E-\x7F]/,I([["",""]],!1,!1),function(){e=e||{data:{}},e.data.uri=new It(e.data.scheme,e.data.user,e.data.host,e.data.port),delete e.data.scheme,delete e.data.user,delete e.data.host,delete e.data.host_type,delete e.data.port},function(){e=e||{data:{}},e.data.uri=new It(e.data.scheme,e.data.user,e.data.host,e.data.port,e.data.uri_params,e.data.uri_headers),delete e.data.scheme,delete e.data.user,delete e.data.host,delete e.data.host_type,delete e.data.port,delete e.data.uri_params,e.startRule==="SIP_URI"&&(e.data=e.data.uri)},"sips",f("sips",!0),"sip",f("sip",!0),function(b){e=e||{data:{}},e.data.scheme=b},function(){e=e||{data:{}},e.data.user=decodeURIComponent(C().slice(0,-1))},function(){e=e||{data:{}},e.data.password=C()},function(){return e=e||{data:{}},e.data.host=C(),e.data.host},function(){return e=e||{data:{}},e.data.host_type="domain",C()},/^[a-zA-Z0-9_\-]/,I([["a","z"],["A","Z"],["0","9"],"_","-"],!1,!1),/^[a-zA-Z0-9\-]/,I([["a","z"],["A","Z"],["0","9"],"-"],!1,!1),function(){return e=e||{data:{}},e.data.host_type="IPv6",C()},"::",f("::",!1),function(){return e=e||{data:{}},e.data.host_type="IPv6",C()},function(){return e=e||{data:{}},e.data.host_type="IPv4",C()},"25",f("25",!1),/^[0-5]/,I([["0","5"]],!1,!1),"2",f("2",!1),/^[0-4]/,I([["0","4"]],!1,!1),"1",f("1",!1),/^[1-9]/,I([["1","9"]],!1,!1),function(b){return e=e||{data:{}},b=parseInt(b.join("")),e.data.port=b,b},"transport=",f("transport=",!0),"udp",f("udp",!0),"tcp",f("tcp",!0),"sctp",f("sctp",!0),"tls",f("tls",!0),function(b){e=e||{data:{}},e.data.uri_params||(e.data.uri_params={}),e.data.uri_params.transport=b.toLowerCase()},"user=",f("user=",!0),"phone",f("phone",!0),"ip",f("ip",!0),function(b){e=e||{data:{}},e.data.uri_params||(e.data.uri_params={}),e.data.uri_params.user=b.toLowerCase()},"method=",f("method=",!0),function(b){e=e||{data:{}},e.data.uri_params||(e.data.uri_params={}),e.data.uri_params.method=b},"ttl=",f("ttl=",!0),function(b){e=e||{data:{}},e.data.params||(e.data.params={}),e.data.params.ttl=b},"maddr=",f("maddr=",!0),function(b){e=e||{data:{}},e.data.uri_params||(e.data.uri_params={}),e.data.uri_params.maddr=b},"lr",f("lr",!0),function(){e=e||{data:{}},e.data.uri_params||(e.data.uri_params={}),e.data.uri_params.lr=void 0},function(b,T){e=e||{data:{}},e.data.uri_params||(e.data.uri_params={}),T===null?T=void 0:T=T[1],e.data.uri_params[b.toLowerCase()]=T},function(b,T){b=b.join("").toLowerCase(),T=T.join(""),e=e||{data:{}},e.data.uri_headers||(e.data.uri_headers={}),e.data.uri_headers[b]?e.data.uri_headers[b].push(T):e.data.uri_headers[b]=[T]},function(){e=e||{data:{}},e.startRule==="Refer_To"&&(e.data.uri=new It(e.data.scheme,e.data.user,e.data.host,e.data.port,e.data.uri_params,e.data.uri_headers),delete e.data.scheme,delete e.data.user,delete e.data.host,delete e.data.host_type,delete e.data.port,delete e.data.uri_params)},"//",f("//",!1),function(){e=e||{data:{}},e.data.scheme=C()},f("SIP",!0),function(){e=e||{data:{}},e.data.sip_version=C()},"INVITE",f("INVITE",!1),"ACK",f("ACK",!1),"VXACH",f("VXACH",!1),"OPTIONS",f("OPTIONS",!1),"BYE",f("BYE",!1),"CANCEL",f("CANCEL",!1),"REGISTER",f("REGISTER",!1),"SUBSCRIBE",f("SUBSCRIBE",!1),"NOTIFY",f("NOTIFY",!1),"REFER",f("REFER",!1),"PUBLISH",f("PUBLISH",!1),function(){return e=e||{data:{}},e.data.method=C(),e.data.method},function(b){e=e||{data:{}},e.data.status_code=parseInt(b.join(""))},function(){e=e||{data:{}},e.data.reason_phrase=C()},function(){e=e||{data:{}},e.data=C()},function(){var b,T;for(e=e||{data:{}},T=e.data.multi_header.length,b=0;b<T;b++)if(e.data.multi_header[b].parsed===null){e.data=null;break}e.data!==null?e.data=e.data.multi_header:e.data=-1},function(){var b;e=e||{data:{}},e.data.multi_header||(e.data.multi_header=[]);try{b=new Je(e.data.uri,e.data.displayName,e.data.params),delete e.data.uri,delete e.data.displayName,delete e.data.params}catch{b=null}e.data.multi_header.push({position:c,offset:A().start.offset,parsed:b})},function(b){b=C().trim(),b[0]==='"'&&(b=b.substring(1,b.length-1)),e=e||{data:{}},e.data.displayName=b},"q",f("q",!0),function(b){e=e||{data:{}},e.data.params||(e.data.params={}),e.data.params.q=b},"expires",f("expires",!0),function(b){e=e||{data:{}},e.data.params||(e.data.params={}),e.data.params.expires=b},function(b){return parseInt(b.join(""))},"0",f("0",!1),function(){return parseFloat(C())},function(b,T){e=e||{data:{}},e.data.params||(e.data.params={}),T===null?T=void 0:T=T[1],e.data.params[b.toLowerCase()]=T},"render",f("render",!0),"session",f("session",!0),"icon",f("icon",!0),"alert",f("alert",!0),function(){e=e||{data:{}},e.startRule==="Content_Disposition"&&(e.data.type=C().toLowerCase())},"handling",f("handling",!0),"optional",f("optional",!0),"required",f("required",!0),function(b){e=e||{data:{}},e.data=parseInt(b.join(""))},function(){e=e||{data:{}},e.data=C()},"text",f("text",!0),"image",f("image",!0),"audio",f("audio",!0),"video",f("video",!0),"application",f("application",!0),"message",f("message",!0),"multipart",f("multipart",!0),"x-",f("x-",!0),function(b){e=e||{data:{}},e.data.value=parseInt(b.join(""))},function(b){e=e||{data:{}},e.data=b},function(b){e=e||{data:{}},e.data.event=b.toLowerCase()},function(){e=e||{data:{}};var b=e.data.tag;e.data=new Je(e.data.uri,e.data.displayName,e.data.params),b&&e.data.setParam("tag",b)},"tag",f("tag",!0),function(b){e=e||{data:{}},e.data.tag=b},function(b){e=e||{data:{}},e.data=parseInt(b.join(""))},function(b){e=e||{data:{}},e.data=b},function(){e=e||{data:{}},e.data=new Je(e.data.uri,e.data.displayName,e.data.params)},"digest",f("Digest",!0),"realm",f("realm",!0),function(b){e=e||{data:{}},e.data.realm=b},"domain",f("domain",!0),"nonce",f("nonce",!0),function(b){e=e||{data:{}},e.data.nonce=b},"opaque",f("opaque",!0),function(b){e=e||{data:{}},e.data.opaque=b},"stale",f("stale",!0),"true",f("true",!0),function(){e=e||{data:{}},e.data.stale=!0},"false",f("false",!0),function(){e=e||{data:{}},e.data.stale=!1},"algorithm",f("algorithm",!0),"md5",f("MD5",!0),"md5-sess",f("MD5-sess",!0),function(b){e=e||{data:{}},e.data.algorithm=b.toUpperCase()},"qop",f("qop",!0),"auth-int",f("auth-int",!0),"auth",f("auth",!0),function(b){e=e||{data:{}},e.data.qop||(e.data.qop=[]),e.data.qop.push(b.toLowerCase())},function(b){e=e||{data:{}},e.data.value=parseInt(b.join(""))},function(){var b,T;for(e=e||{data:{}},T=e.data.multi_header.length,b=0;b<T;b++)if(e.data.multi_header[b].parsed===null){e.data=null;break}e.data!==null?e.data=e.data.multi_header:e.data=-1},function(){var b;e=e||{data:{}},e.data.multi_header||(e.data.multi_header=[]);try{b=new Je(e.data.uri,e.data.displayName,e.data.params),delete e.data.uri,delete e.data.displayName,delete e.data.params}catch{b=null}e.data.multi_header.push({position:c,offset:A().start.offset,parsed:b})},function(){e=e||{data:{}},e.data=new Je(e.data.uri,e.data.displayName,e.data.params)},function(){e=e||{data:{}},e.data.replaces_from_tag&&e.data.replaces_to_tag||(e.data=-1)},function(){e=e||{data:{}},e.data={call_id:e.data}},"from-tag",f("from-tag",!0),function(b){e=e||{data:{}},e.data.replaces_from_tag=b},"to-tag",f("to-tag",!0),function(b){e=e||{data:{}},e.data.replaces_to_tag=b},"early-only",f("early-only",!0),function(){e=e||{data:{}},e.data.early_only=!0},function(b,T){return T},function(b,T){return we(b,T)},function(b){e=e||{data:{}},e.startRule==="Require"&&(e.data=b||[])},function(b){e=e||{data:{}},e.data.value=parseInt(b.join(""))},"active",f("active",!0),"pending",f("pending",!0),"terminated",f("terminated",!0),function(){e=e||{data:{}},e.data.state=C()},"reason",f("reason",!0),function(b){e=e||{data:{}},typeof b<"u"&&(e.data.reason=b)},function(b){e=e||{data:{}},typeof b<"u"&&(e.data.expires=b)},"retry_after",f("retry_after",!0),function(b){e=e||{data:{}},typeof b<"u"&&(e.data.retry_after=b)},"deactivated",f("deactivated",!0),"probation",f("probation",!0),"rejected",f("rejected",!0),"timeout",f("timeout",!0),"giveup",f("giveup",!0),"noresource",f("noresource",!0),"invariant",f("invariant",!0),function(b){e=e||{data:{}},e.startRule==="Supported"&&(e.data=b||[])},function(){e=e||{data:{}};var b=e.data.tag;e.data=new Je(e.data.uri,e.data.displayName,e.data.params),b&&e.data.setParam("tag",b)},"ttl",f("ttl",!0),function(b){e=e||{data:{}},e.data.ttl=b},"maddr",f("maddr",!0),function(b){e=e||{data:{}},e.data.maddr=b},"received",f("received",!0),function(b){e=e||{data:{}},e.data.received=b},"branch",f("branch",!0),function(b){e=e||{data:{}},e.data.branch=b},"rport",f("rport",!0),function(b){e=e||{data:{}},typeof b<"u"&&(e.data.rport=b.join(""))},function(b){e=e||{data:{}},e.data.protocol=b},f("UDP",!0),f("TCP",!0),f("TLS",!0),f("SCTP",!0),function(b){e=e||{data:{}},e.data.transport=b},function(){e=e||{data:{}},e.data.host=C()},function(b){e=e||{data:{}},e.data.port=parseInt(b.join(""))},function(b){return parseInt(b.join(""))},function(b){e=e||{data:{}},e.startRule==="Session_Expires"&&(e.data.deltaSeconds=b)},"refresher",f("refresher",!1),"uas",f("uas",!1),"uac",f("uac",!1),function(b){e=e||{data:{}},e.startRule==="Session_Expires"&&(e.data.refresher=b)},function(b){e=e||{data:{}},e.startRule==="Min_SE"&&(e.data=b)},"stuns",f("stuns",!0),"stun",f("stun",!0),function(b){e=e||{data:{}},e.data.scheme=b},function(b){e=e||{data:{}},e.data.host=b},"?transport=",f("?transport=",!1),"turns",f("turns",!0),"turn",f("turn",!0),function(b){e=e||{data:{}},e.data.transport=b},function(){e=e||{data:{}},e.data=C()},"Referred-By",f("Referred-By",!1),"b",f("b",!1),"cid",f("cid",!1)],a=[h('2 ""6 7!'),h('4"""5!7#'),h('4$""5!7%'),h(`4&""5!7'`),h(";'.# &;("),h('4(""5!7)'),h('4*""5!7+'),h('2,""6,7-'),h('2.""6.7/'),h('40""5!71'),h('22""6273. &24""6475.} &26""6677.q &28""6879.e &2:""6:7;.Y &2<""6<7=.M &2>""6>7?.A &2@""6@7A.5 &2B""6B7C.) &2D""6D7E'),h(";).# &;,"),h('2F""6F7G.} &2H""6H7I.q &2J""6J7K.e &2L""6L7M.Y &2N""6N7O.M &2P""6P7Q.A &2R""6R7S.5 &2T""6T7U.) &2V""6V7W'),h(`%%2X""6X7Y/5#;#/,$;#/#$+#)(#'#("'#&'#/"!&,)`),h(`%%$;$0#*;$&/,#; /#$+")("'#&'#." &"/=#$;$/&#0#*;$&&&#/'$8":Z" )("'#&'#`),h(';.." &"'),h(`%$;'.# &;(0)*;'.# &;(&/?#28""6879/0$;//'$8#:[# )(#'#("'#&'#`),h(`%%$;2/&#0#*;2&&&#/g#$%$;.0#*;.&/,#;2/#$+")("'#&'#0=*%$;.0#*;.&/,#;2/#$+")("'#&'#&/#$+")("'#&'#/"!&,)`),h('4\\""5!7].# &;3'),h('4^""5!7_'),h('4`""5!7a'),h(';!.) &4b""5!7c'),h('%$;). &2F""6F7G. &2J""6J7K.} &2L""6L7M.q &2X""6X7Y.e &2P""6P7Q.Y &2H""6H7I.M &2@""6@7A.A &2d""6d7e.5 &2R""6R7S.) &2N""6N7O/#0*;). &2F""6F7G. &2J""6J7K.} &2L""6L7M.q &2X""6X7Y.e &2P""6P7Q.Y &2H""6H7I.M &2@""6@7A.A &2d""6d7e.5 &2R""6R7S.) &2N""6N7O&&&#/"!&,)'),h('%$;). &2F""6F7G.} &2L""6L7M.q &2X""6X7Y.e &2P""6P7Q.Y &2H""6H7I.M &2@""6@7A.A &2d""6d7e.5 &2R""6R7S.) &2N""6N7O/#0*;). &2F""6F7G.} &2L""6L7M.q &2X""6X7Y.e &2P""6P7Q.Y &2H""6H7I.M &2@""6@7A.A &2d""6d7e.5 &2R""6R7S.) &2N""6N7O&&&#/"!&,)'),h(`2T""6T7U.ã &2V""6V7W.× &2f""6f7g.Ë &2h""6h7i.¿ &2:""6:7;.³ &2D""6D7E.§ &22""6273. &28""6879. &2j""6j7k. &;&.} &24""6475.q &2l""6l7m.e &2n""6n7o.Y &26""6677.M &2>""6>7?.A &2p""6p7q.5 &2r""6r7s.) &;'.# &;(`),h('%$;).ī &2F""6F7G.ğ &2J""6J7K.ē &2L""6L7M.ć &2X""6X7Y.û &2P""6P7Q.ï &2H""6H7I.ã &2@""6@7A.× &2d""6d7e.Ë &2R""6R7S.¿ &2N""6N7O.³ &2T""6T7U.§ &2V""6V7W. &2f""6f7g. &2h""6h7i. &28""6879.w &2j""6j7k.k &;&.e &24""6475.Y &2l""6l7m.M &2n""6n7o.A &26""6677.5 &2p""6p7q.) &2r""6r7s/Ĵ#0ı*;).ī &2F""6F7G.ğ &2J""6J7K.ē &2L""6L7M.ć &2X""6X7Y.û &2P""6P7Q.ï &2H""6H7I.ã &2@""6@7A.× &2d""6d7e.Ë &2R""6R7S.¿ &2N""6N7O.³ &2T""6T7U.§ &2V""6V7W. &2f""6f7g. &2h""6h7i. &28""6879.w &2j""6j7k.k &;&.e &24""6475.Y &2l""6l7m.M &2n""6n7o.A &26""6677.5 &2p""6p7q.) &2r""6r7s&&&#/"!&,)'),h(`%;//?#2P""6P7Q/0$;//'$8#:t# )(#'#("'#&'#`),h(`%;//?#24""6475/0$;//'$8#:u# )(#'#("'#&'#`),h(`%;//?#2>""6>7?/0$;//'$8#:v# )(#'#("'#&'#`),h(`%;//?#2T""6T7U/0$;//'$8#:w# )(#'#("'#&'#`),h(`%;//?#2V""6V7W/0$;//'$8#:x# )(#'#("'#&'#`),h(`%2h""6h7i/0#;//'$8":y" )("'#&'#`),h(`%;//6#2f""6f7g/'$8":z" )("'#&'#`),h(`%;//?#2D""6D7E/0$;//'$8#:{# )(#'#("'#&'#`),h(`%;//?#22""6273/0$;//'$8#:|# )(#'#("'#&'#`),h(`%;//?#28""6879/0$;//'$8#:}# )(#'#("'#&'#`),h(`%;//0#;&/'$8":~" )("'#&'#`),h(`%;&/0#;//'$8":~" )("'#&'#`),h(`%;=/T#$;G.) &;K.# &;F0/*;G.) &;K.# &;F&/,$;>/#$+#)(#'#("'#&'#`),h('4""5!7.A &4""5!7.5 &4""5!7.) &;3.# &;.'),h(`%%;//Q#;&/H$$;J.# &;K0)*;J.# &;K&/,$;&/#$+$)($'#(#'#("'#&'#/"!&,)`),h(`%;//]#;&/T$%$;J.# &;K0)*;J.# &;K&/"!&,)/1$;&/($8$:$!!)($'#(#'#("'#&'#`),h(';..G &2L""6L7M.; &4""5!7./ &4""5!7.# &;3'),h(`%2j""6j7k/J#4""5!7.5 &4""5!7.) &4""5!7/#$+")("'#&'#`),h(`%;N/M#28""6879/>$;O." &"/0$;S/'$8$:$ )($'#(#'#("'#&'#`),h(`%;N/d#28""6879/U$;O." &"/G$;S/>$;_/5$;l." &"/'$8&:& )(&'#(%'#($'#(#'#("'#&'#`),h(`%3""5$7.) &3""5#7/' 8!:!! )`),h(`%;P/]#%28""6879/,#;R/#$+")("'#&'#." &"/6$2:""6:7;/'$8#:# )(#'#("'#&'#`),h("$;+.) &;-.# &;Q/2#0/*;+.) &;-.# &;Q&&&#"),h('2<""6<7=.q &2>""6>7?.e &2@""6@7A.Y &2B""6B7C.M &2D""6D7E.A &22""6273.5 &26""6677.) &24""6475'),h('%$;+._ &;-.Y &2<""6<7=.M &2>""6>7?.A &2@""6@7A.5 &2B""6B7C.) &2D""6D7E0e*;+._ &;-.Y &2<""6<7=.M &2>""6>7?.A &2@""6@7A.5 &2B""6B7C.) &2D""6D7E&/& 8!:! )'),h(`%;T/J#%28""6879/,#;^/#$+")("'#&'#." &"/#$+")("'#&'#`),h("%;U.) &;\\.# &;X/& 8!:! )"),h(`%$%;V/2#2J""6J7K/#$+")("'#&'#0<*%;V/2#2J""6J7K/#$+")("'#&'#&/D#;W/;$2J""6J7K." &"/'$8#:# )(#'#("'#&'#`),h('$4""5!7/,#0)*4""5!7&&&#'),h(`%4$""5!7%/?#$4""5!70)*4""5!7&/#$+")("'#&'#`),h(`%2l""6l7m/?#;Y/6$2n""6n7o/'$8#:# )(#'#("'#&'#`),h(`%%;Z/³#28""6879/¤$;Z/$28""6879/$;Z/$28""6879/t$;Z/k$28""6879/\\$;Z/S$28""6879/D$;Z/;$28""6879/,$;[/#$+-)(-'#(,'#(+'#(*'#()'#(('#(''#(&'#(%'#($'#(#'#("'#&'#.ސ &%2""67/¤#;Z/$28""6879/$;Z/$28""6879/t$;Z/k$28""6879/\\$;Z/S$28""6879/D$;Z/;$28""6879/,$;[/#$+,)(,'#(+'#(*'#()'#(('#(''#(&'#(%'#($'#(#'#("'#&'#.۹ &%2""67/#;Z/$28""6879/t$;Z/k$28""6879/\\$;Z/S$28""6879/D$;Z/;$28""6879/,$;[/#$+*)(*'#()'#(('#(''#(&'#(%'#($'#(#'#("'#&'#.ٺ &%2""67/t#;Z/k$28""6879/\\$;Z/S$28""6879/D$;Z/;$28""6879/,$;[/#$+()(('#(''#(&'#(%'#($'#(#'#("'#&'#.ؓ &%2""67/\\#;Z/S$28""6879/D$;Z/;$28""6879/,$;[/#$+&)(&'#(%'#($'#(#'#("'#&'#.ׄ &%2""67/D#;Z/;$28""6879/,$;[/#$+$)($'#(#'#("'#&'#.֍ &%2""67/,#;[/#$+")("'#&'#.ծ &%2""67/,#;Z/#$+")("'#&'#.Տ &%;Z/#2""67/$;Z/$28""6879/t$;Z/k$28""6879/\\$;Z/S$28""6879/D$;Z/;$28""6879/,$;[/#$++)(+'#(*'#()'#(('#(''#(&'#(%'#($'#(#'#("'#&'#.Ӈ &%;Z/ª#%28""6879/,#;Z/#$+")("'#&'#." &"/$2""67/t$;Z/k$28""6879/\\$;Z/S$28""6879/D$;Z/;$28""6879/,$;[/#$+*)(*'#()'#(('#(''#(&'#(%'#($'#(#'#("'#&'#.а &%;Z/¹#%28""6879/,#;Z/#$+")("'#&'#." &"/$%28""6879/,#;Z/#$+")("'#&'#." &"/k$2""67/\\$;Z/S$28""6879/D$;Z/;$28""6879/,$;[/#$+))()'#(('#(''#(&'#(%'#($'#(#'#("'#&'#.Ί &%;Z/È#%28""6879/,#;Z/#$+")("'#&'#." &"/¡$%28""6879/,#;Z/#$+")("'#&'#." &"/z$%28""6879/,#;Z/#$+")("'#&'#." &"/S$2""67/D$;Z/;$28""6879/,$;[/#$+()(('#(''#(&'#(%'#($'#(#'#("'#&'#.˕ &%;Z/×#%28""6879/,#;Z/#$+")("'#&'#." &"/°$%28""6879/,#;Z/#$+")("'#&'#." &"/$%28""6879/,#;Z/#$+")("'#&'#." &"/b$%28""6879/,#;Z/#$+")("'#&'#." &"/;$2""67/,$;[/#$+')(''#(&'#(%'#($'#(#'#("'#&'#.ȑ &%;Z/þ#%28""6879/,#;Z/#$+")("'#&'#." &"/×$%28""6879/,#;Z/#$+")("'#&'#." &"/°$%28""6879/,#;Z/#$+")("'#&'#." &"/$%28""6879/,#;Z/#$+")("'#&'#." &"/b$%28""6879/,#;Z/#$+")("'#&'#." &"/;$2""67/,$;Z/#$+()(('#(''#(&'#(%'#($'#(#'#("'#&'#.Ħ &%;Z/Ĝ#%28""6879/,#;Z/#$+")("'#&'#." &"/õ$%28""6879/,#;Z/#$+")("'#&'#." &"/Î$%28""6879/,#;Z/#$+")("'#&'#." &"/§$%28""6879/,#;Z/#$+")("'#&'#." &"/$%28""6879/,#;Z/#$+")("'#&'#." &"/Y$%28""6879/,#;Z/#$+")("'#&'#." &"/2$2""67/#$+()(('#(''#(&'#(%'#($'#(#'#("'#&'#/& 8!: ! )`),h(`%;#/M#;#." &"/?$;#." &"/1$;#." &"/#$+$)($'#(#'#("'#&'#`),h(`%;Z/;#28""6879/,$;Z/#$+#)(#'#("'#&'#.# &;\\`),h(`%;]/o#2J""6J7K/\`$;]/W$2J""6J7K/H$;]/?$2J""6J7K/0$;]/'$8':¡' )(''#(&'#(%'#($'#(#'#("'#&'#`),h(`%2¢""6¢7£/2#4¤""5!7¥/#$+")("'#&'#. &%2¦""6¦7§/;#4¨""5!7©/,$;!/#$+#)(#'#("'#&'#.j &%2ª""6ª7«/5#;!/,$;!/#$+#)(#'#("'#&'#.B &%4¬""5!7­/,#;!/#$+")("'#&'#.# &;!`),h(`%%;!." &"/[#;!." &"/M$;!." &"/?$;!." &"/1$;!." &"/#$+%)(%'#($'#(#'#("'#&'#/' 8!:®!! )`),h(`$%22""6273/,#;\`/#$+")("'#&'#0<*%22""6273/,#;\`/#$+")("'#&'#&`),h(";a.A &;b.; &;c.5 &;d./ &;e.) &;f.# &;g"),h(`%3¯""5*7°/a#3±""5#7².G &3³""5#7´.; &3µ""5$7¶./ &3·""5#7¸.# &;6/($8":¹"! )("'#&'#`),h(`%3º""5%7»/I#3¼""5%7½./ &3¾""5"7¿.# &;6/($8":À"! )("'#&'#`),h(`%3Á""5'7Â/1#;/($8":Ã"! )("'#&'#`),h(`%3Ä""5$7Å/1#;ð/($8":Æ"! )("'#&'#`),h(`%3Ç""5&7È/1#;T/($8":É"! )("'#&'#`),h(`%3Ê""5"7Ë/N#%2>""6>7?/,#;6/#$+")("'#&'#." &"/'$8":Ì" )("'#&'#`),h(`%;h/P#%2>""6>7?/,#;i/#$+")("'#&'#." &"/)$8":Í""! )("'#&'#`),h('%$;j/&#0#*;j&&&#/"!&,)'),h('%$;j/&#0#*;j&&&#/"!&,)'),h(";k.) &;+.# &;-"),h('2l""6l7m.e &2n""6n7o.Y &24""6475.M &28""6879.A &2<""6<7=.5 &2@""6@7A.) &2B""6B7C'),h(`%26""6677/n#;m/e$$%2<""6<7=/,#;m/#$+")("'#&'#0<*%2<""6<7=/,#;m/#$+")("'#&'#&/#$+#)(#'#("'#&'#`),h(`%;n/A#2>""6>7?/2$;o/)$8#:Î#"" )(#'#("'#&'#`),h("$;p.) &;+.# &;-/2#0/*;p.) &;+.# &;-&&&#"),h("$;p.) &;+.# &;-0/*;p.) &;+.# &;-&"),h('2l""6l7m.e &2n""6n7o.Y &24""6475.M &26""6677.A &28""6879.5 &2@""6@7A.) &2B""6B7C'),h(";.# &;r"),h(`%;/G#;'/>$;s/5$;'/,$;/#$+%)(%'#($'#(#'#("'#&'#`),h(";M.# &;t"),h(`%;/E#28""6879/6$;u.# &;x/'$8#:Ï# )(#'#("'#&'#`),h(`%;v.# &;w/J#%26""6677/,#;/#$+")("'#&'#." &"/#$+")("'#&'#`),h(`%2Ð""6Ð7Ñ/:#;/1$;w." &"/#$+#)(#'#("'#&'#`),h(`%24""6475/,#;{/#$+")("'#&'#`),h(`%;z/3#$;y0#*;y&/#$+")("'#&'#`),h(";*.) &;+.# &;-"),h(';+. &;-. &22""6273.} &26""6677.q &28""6879.e &2:""6:7;.Y &2<""6<7=.M &2>""6>7?.A &2@""6@7A.5 &2B""6B7C.) &2D""6D7E'),h(`%;|/e#$%24""6475/,#;|/#$+")("'#&'#0<*%24""6475/,#;|/#$+")("'#&'#&/#$+")("'#&'#`),h(`%$;~0#*;~&/e#$%22""6273/,#;}/#$+")("'#&'#0<*%22""6273/,#;}/#$+")("'#&'#&/#$+")("'#&'#`),h("$;~0#*;~&"),h(';+.w &;-.q &28""6879.e &2:""6:7;.Y &2<""6<7=.M &2>""6>7?.A &2@""6@7A.5 &2B""6B7C.) &2D""6D7E'),h(`%%;"/#$;".G &;!.A &2@""6@7A.5 &2F""6F7G.) &2J""6J7K0M*;".G &;!.A &2@""6@7A.5 &2F""6F7G.) &2J""6J7K&/#$+")("'#&'#/& 8!:Ò! )`),h(";.# &;"),h(`%%;O/2#2:""6:7;/#$+")("'#&'#." &"/,#;S/#$+")("'#&'#." &"`),h('$;+. &;-.} &2B""6B7C.q &2D""6D7E.e &22""6273.Y &28""6879.M &2:""6:7;.A &2<""6<7=.5 &2>""6>7?.) &2@""6@7A/#0*;+. &;-.} &2B""6B7C.q &2D""6D7E.e &22""6273.Y &28""6879.M &2:""6:7;.A &2<""6<7=.5 &2>""6>7?.) &2@""6@7A&&&#'),h("$;y0#*;y&"),h(`%3""5#7Ó/q#24""6475/b$$;!/&#0#*;!&&&#/L$2J""6J7K/=$$;!/&#0#*;!&&&#/'$8%:Ô% )(%'#($'#(#'#("'#&'#`),h('2Õ""6Õ7Ö'),h('2×""6×7Ø'),h('2Ù""6Ù7Ú'),h('2Û""6Û7Ü'),h('2Ý""6Ý7Þ'),h('2ß""6ß7à'),h('2á""6á7â'),h('2ã""6ã7ä'),h('2å""6å7æ'),h('2ç""6ç7è'),h('2é""6é7ê'),h("%;.Y &;.S &;.M &;.G &;.A &;.; &;.5 &;./ &;.) &;.# &;6/& 8!:ë! )"),h(`%;/G#;'/>$;/5$;'/,$;/#$+%)(%'#($'#(#'#("'#&'#`),h("%;/' 8!:ì!! )"),h(`%;!/5#;!/,$;!/#$+#)(#'#("'#&'#`),h("%$;*.A &;+.; &;-.5 &;3./ &;4.) &;'.# &;(0G*;*.A &;+.; &;-.5 &;3./ &;4.) &;'.# &;(&/& 8!:í! )"),h(`%;¶/Y#$%;A/,#;¶/#$+")("'#&'#06*%;A/,#;¶/#$+")("'#&'#&/#$+")("'#&'#`),h(`%;9/N#%2:""6:7;/,#;9/#$+")("'#&'#." &"/'$8":î" )("'#&'#`),h(`%;:.c &%;/Y#$%;A/,#;/#$+")("'#&'#06*%;A/,#;/#$+")("'#&'#&/#$+")("'#&'#/& 8!:ï! )`),h(`%;L.# &;/]#$%;B/,#;/#$+")("'#&'#06*%;B/,#;/#$+")("'#&'#&/'$8":ð" )("'#&'#`),h(`%;." &"/>#;@/5$;M/,$;?/#$+$)($'#(#'#("'#&'#`),h(`%%;6/Y#$%;./,#;6/#$+")("'#&'#06*%;./,#;6/#$+")("'#&'#&/#$+")("'#&'#.# &;H/' 8!:ñ!! )`),h(";.) &;.# &; "),h(`%3ò""5!7ó/:#;</1$;/($8#:ô#! )(#'#("'#&'#`),h(`%3õ""5'7ö/:#;</1$;/($8#:÷#! )(#'#("'#&'#`),h("%$;!/&#0#*;!&&&#/' 8!:ø!! )"),h(`%2ù""6ù7ú/o#%2J""6J7K/M#;!." &"/?$;!." &"/1$;!." &"/#$+$)($'#(#'#("'#&'#." &"/'$8":û" )("'#&'#`),h(`%;6/J#%;</,#;¡/#$+")("'#&'#." &"/)$8":ü""! )("'#&'#`),h(";6.) &;T.# &;H"),h(`%;£/Y#$%;B/,#;¤/#$+")("'#&'#06*%;B/,#;¤/#$+")("'#&'#&/#$+")("'#&'#`),h(`%3ý""5&7þ.G &3ÿ""5'7Ā.; &3ā""5$7Ă./ &3ă""5%7Ą.# &;6/& 8!:ą! )`),h(";¥.# &; "),h(`%3Ć""5(7ć/M#;</D$3Ĉ""5(7ĉ./ &3Ċ""5(7ċ.# &;6/#$+#)(#'#("'#&'#`),h(`%;6/Y#$%;A/,#;6/#$+")("'#&'#06*%;A/,#;6/#$+")("'#&'#&/#$+")("'#&'#`),h("%$;!/&#0#*;!&&&#/' 8!:Č!! )"),h("%;©/& 8!:č! )"),h(`%;ª/k#;;/b$;¯/Y$$%;B/,#;°/#$+")("'#&'#06*%;B/,#;°/#$+")("'#&'#&/#$+$)($'#(#'#("'#&'#`),h(";«.# &;¬"),h('3Ď""5$7ď.S &3Đ""5%7đ.G &3Ē""5%7ē.; &3Ĕ""5%7ĕ./ &3Ė""5+7ė.# &;­'),h(`3Ę""5'7ę./ &3Ě""5)7ě.# &;­`),h(";6.# &;®"),h(`%3Ĝ""5"7ĝ/,#;6/#$+")("'#&'#`),h(";­.# &;6"),h(`%;6/5#;</,$;±/#$+#)(#'#("'#&'#`),h(";6.# &;H"),h(`%;³/5#;./,$;/#$+#)(#'#("'#&'#`),h("%$;!/&#0#*;!&&&#/' 8!:Ğ!! )"),h("%;/' 8!:ğ!! )"),h(`%;¶/^#$%;B/,#; /#$+")("'#&'#06*%;B/,#; /#$+")("'#&'#&/($8":Ġ"!!)("'#&'#`),h(`%%;7/e#$%2J""6J7K/,#;7/#$+")("'#&'#0<*%2J""6J7K/,#;7/#$+")("'#&'#&/#$+")("'#&'#/"!&,)`),h(`%;L.# &;/]#$%;B/,#;¸/#$+")("'#&'#06*%;B/,#;¸/#$+")("'#&'#&/'$8":ġ" )("'#&'#`),h(";¹.# &; "),h(`%3Ģ""5#7ģ/:#;</1$;6/($8#:Ĥ#! )(#'#("'#&'#`),h("%$;!/&#0#*;!&&&#/' 8!:ĥ!! )"),h("%;/' 8!:Ħ!! )"),h(`%$;0#*;&/x#;@/o$;M/f$;?/]$$%;B/,#; /#$+")("'#&'#06*%;B/,#; /#$+")("'#&'#&/'$8%:ħ% )(%'#($'#(#'#("'#&'#`),h(";¾"),h(`%3Ĩ""5&7ĩ/k#;./b$;Á/Y$$%;A/,#;Á/#$+")("'#&'#06*%;A/,#;Á/#$+")("'#&'#&/#$+$)($'#(#'#("'#&'#.# &;¿`),h(`%;6/k#;./b$;À/Y$$%;A/,#;À/#$+")("'#&'#06*%;A/,#;À/#$+")("'#&'#&/#$+$)($'#(#'#("'#&'#`),h(`%;6/;#;</2$;6.# &;H/#$+#)(#'#("'#&'#`),h(";Â.G &;Ä.A &;Æ.; &;È.5 &;É./ &;Ê.) &;Ë.# &;À"),h(`%3Ī""5%7ī/5#;</,$;Ã/#$+#)(#'#("'#&'#`),h("%;I/' 8!:Ĭ!! )"),h(`%3ĭ""5&7Į/#;</$;D/$;Å/|$$%$;'/&#0#*;'&&&#/,#;Å/#$+")("'#&'#0C*%$;'/&#0#*;'&&&#/,#;Å/#$+")("'#&'#&/,$;E/#$+&)(&'#(%'#($'#(#'#("'#&'#`),h(";t.# &;w"),h(`%3į""5%7İ/5#;</,$;Ç/#$+#)(#'#("'#&'#`),h("%;I/' 8!:ı!! )"),h(`%3Ĳ""5&7ĳ/:#;</1$;I/($8#:Ĵ#! )(#'#("'#&'#`),h(`%3ĵ""5%7Ķ/]#;</T$%3ķ""5$7ĸ/& 8!:Ĺ! ).4 &%3ĺ""5%7Ļ/& 8!:ļ! )/#$+#)(#'#("'#&'#`),h(`%3Ľ""5)7ľ/R#;</I$3Ŀ""5#7ŀ./ &3Ł""5(7ł.# &;6/($8#:Ń#! )(#'#("'#&'#`),h(`%3ń""5#7Ņ/#;</$;D/$%;Ì/e#$%2D""6D7E/,#;Ì/#$+")("'#&'#0<*%2D""6D7E/,#;Ì/#$+")("'#&'#&/#$+")("'#&'#/,$;E/#$+%)(%'#($'#(#'#("'#&'#`),h(`%3ņ""5(7Ň./ &3ň""5$7ŉ.# &;6/' 8!:Ŋ!! )`),h(`%;6/Y#$%;A/,#;6/#$+")("'#&'#06*%;A/,#;6/#$+")("'#&'#&/#$+")("'#&'#`),h(`%;Ï/G#;./>$;Ï/5$;./,$;/#$+%)(%'#($'#(#'#("'#&'#`),h("%$;!/&#0#*;!&&&#/' 8!:ŋ!! )"),h(`%;Ñ/]#$%;A/,#;Ñ/#$+")("'#&'#06*%;A/,#;Ñ/#$+")("'#&'#&/'$8":Ō" )("'#&'#`),h(`%;/]#$%;B/,#; /#$+")("'#&'#06*%;B/,#; /#$+")("'#&'#&/'$8":ō" )("'#&'#`),h(`%;L.O &;.I &%;@." &"/:#;t/1$;?." &"/#$+#)(#'#("'#&'#/]#$%;B/,#; /#$+")("'#&'#06*%;B/,#; /#$+")("'#&'#&/'$8":Ŏ" )("'#&'#`),h(`%;Ô/]#$%;B/,#;Õ/#$+")("'#&'#06*%;B/,#;Õ/#$+")("'#&'#&/'$8":ŏ" )("'#&'#`),h("%;/& 8!:Ő! )"),h(`%3ő""5(7Œ/:#;</1$;6/($8#:œ#! )(#'#("'#&'#.g &%3Ŕ""5&7ŕ/:#;</1$;6/($8#:Ŗ#! )(#'#("'#&'#.: &%3ŗ""5*7Ř/& 8!:ř! ).# &; `),h(`%%;6/k#$%;A/2#;6/)$8":Ś""$ )("'#&'#0<*%;A/2#;6/)$8":Ś""$ )("'#&'#&/)$8":ś""! )("'#&'#." &"/' 8!:Ŝ!! )`),h(`%;Ø/Y#$%;A/,#;Ø/#$+")("'#&'#06*%;A/,#;Ø/#$+")("'#&'#&/#$+")("'#&'#`),h(`%;/Y#$%;B/,#; /#$+")("'#&'#06*%;B/,#; /#$+")("'#&'#&/#$+")("'#&'#`),h("%$;!/&#0#*;!&&&#/' 8!:ŝ!! )"),h(`%;Û/Y#$%;B/,#;Ü/#$+")("'#&'#06*%;B/,#;Ü/#$+")("'#&'#&/#$+")("'#&'#`),h(`%3Ş""5&7ş.; &3Š""5'7š./ &3Ţ""5*7ţ.# &;6/& 8!:Ť! )`),h(`%3ť""5&7Ŧ/:#;</1$;Ý/($8#:ŧ#! )(#'#("'#&'#.} &%3õ""5'7ö/:#;</1$;/($8#:Ũ#! )(#'#("'#&'#.P &%3ũ""5+7Ū/:#;</1$;/($8#:ū#! )(#'#("'#&'#.# &; `),h(`3Ŭ""5+7ŭ.k &3Ů""5)7ů._ &3Ű""5(7ű.S &3Ų""5'7ų.G &3Ŵ""5&7ŵ.; &3Ŷ""5*7ŷ./ &3Ÿ""5)7Ź.# &;6`),h(';1." &"'),h(`%%;6/k#$%;A/2#;6/)$8":Ś""$ )("'#&'#0<*%;A/2#;6/)$8":Ś""$ )("'#&'#&/)$8":ś""! )("'#&'#." &"/' 8!:ź!! )`),h(`%;L.# &;/]#$%;B/,#;á/#$+")("'#&'#06*%;B/,#;á/#$+")("'#&'#&/'$8":Ż" )("'#&'#`),h(";¹.# &; "),h(`%;ã/Y#$%;A/,#;ã/#$+")("'#&'#06*%;A/,#;ã/#$+")("'#&'#&/#$+")("'#&'#`),h(`%;ê/k#;./b$;í/Y$$%;B/,#;ä/#$+")("'#&'#06*%;B/,#;ä/#$+")("'#&'#&/#$+$)($'#(#'#("'#&'#`),h(";å.; &;æ.5 &;ç./ &;è.) &;é.# &; "),h(`%3ż""5#7Ž/:#;</1$;ð/($8#:ž#! )(#'#("'#&'#`),h(`%3ſ""5%7ƀ/:#;</1$;T/($8#:Ɓ#! )(#'#("'#&'#`),h(`%3Ƃ""5(7ƃ/F#;</=$;\\.) &;Y.# &;X/($8#:Ƅ#! )(#'#("'#&'#`),h(`%3ƅ""5&7Ɔ/:#;</1$;6/($8#:Ƈ#! )(#'#("'#&'#`),h(`%3ƈ""5%7Ɖ/A#;</8$$;!0#*;!&/($8#:Ɗ#! )(#'#("'#&'#`),h(`%;ë/G#;;/>$;6/5$;;/,$;ì/#$+%)(%'#($'#(#'#("'#&'#`),h(`%3""5#7Ó.# &;6/' 8!:Ƌ!! )`),h(`%3±""5#7ƌ.G &3³""5#7ƍ.; &3·""5#7Ǝ./ &3µ""5$7Ə.# &;6/' 8!:Ɛ!! )`),h(`%;î/D#%;C/,#;ï/#$+")("'#&'#." &"/#$+")("'#&'#`),h("%;U.) &;\\.# &;X/& 8!:Ƒ! )"),h(`%%;!." &"/[#;!." &"/M$;!." &"/?$;!." &"/1$;!." &"/#$+%)(%'#($'#(#'#("'#&'#/' 8!:ƒ!! )`),h(`%%;!/?#;!." &"/1$;!." &"/#$+#)(#'#("'#&'#/' 8!:Ɠ!! )`),h(";¾"),h(`%;/^#$%;B/,#;ó/#$+")("'#&'#06*%;B/,#;ó/#$+")("'#&'#&/($8":Ɣ"!!)("'#&'#`),h(";ô.# &; "),h(`%2ƕ""6ƕ7Ɩ/L#;</C$2Ɨ""6Ɨ7Ƙ.) &2ƙ""6ƙ7ƚ/($8#:ƛ#! )(#'#("'#&'#`),h(`%;/^#$%;B/,#; /#$+")("'#&'#06*%;B/,#; /#$+")("'#&'#&/($8":Ɯ"!!)("'#&'#`),h(`%;6/5#;0/,$;÷/#$+#)(#'#("'#&'#`),h("$;2.) &;4.# &;.0/*;2.) &;4.# &;.&"),h("$;%0#*;%&"),h(`%;ú/;#28""6879/,$;û/#$+#)(#'#("'#&'#`),h(`%3Ɲ""5%7ƞ.) &3Ɵ""5$7Ơ/' 8!:ơ!! )`),h(`%;ü/J#%28""6879/,#;^/#$+")("'#&'#." &"/#$+")("'#&'#`),h("%;\\.) &;X.# &;/' 8!:Ƣ!! )"),h(';".S &;!.M &2F""6F7G.A &2J""6J7K.5 &2H""6H7I.) &2N""6N7O'),h('2L""6L7M. &2B""6B7C. &2<""6<7=.} &2R""6R7S.q &2T""6T7U.e &2V""6V7W.Y &2P""6P7Q.M &2@""6@7A.A &2D""6D7E.5 &22""6273.) &2>""6>7?'),h(`%;Ā/b#28""6879/S$;û/J$%2ƣ""6ƣ7Ƥ/,#;ì/#$+")("'#&'#." &"/#$+$)($'#(#'#("'#&'#`),h(`%3ƥ""5%7Ʀ.) &3Ƨ""5$7ƨ/' 8!:ơ!! )`),h(`%3±""5#7².6 &3³""5#7´.* &$;+0#*;+&/' 8!:Ʃ!! )`),h(`%;Ą/#2F""6F7G/x$;ă/o$2F""6F7G/\`$;ă/W$2F""6F7G/H$;ă/?$2F""6F7G/0$;ą/'$8):ƪ) )()'#(('#(''#(&'#(%'#($'#(#'#("'#&'#`),h(`%;#/>#;#/5$;#/,$;#/#$+$)($'#(#'#("'#&'#`),h(`%;ă/,#;ă/#$+")("'#&'#`),h(`%;ă/5#;ă/,$;ă/#$+#)(#'#("'#&'#`),h(`%;q/T#$;m0#*;m&/D$%; /,#;ø/#$+")("'#&'#." &"/#$+#)(#'#("'#&'#`),h(`%2ƫ""6ƫ7Ƭ.) &2ƭ""6ƭ7Ʈ/w#;0/n$;Ĉ/e$$%;B/2#;ĉ.# &; /#$+")("'#&'#0<*%;B/2#;ĉ.# &; /#$+")("'#&'#&/#$+$)($'#(#'#("'#&'#`),h(";.# &;L"),h(`%2Ư""6Ư7ư/5#;</,$;Ċ/#$+#)(#'#("'#&'#`),h(`%;D/S#;,/J$2:""6:7;/;$;,.# &;T/,$;E/#$+%)(%'#($'#(#'#("'#&'#`)];let c=0,d=0;const l=[{line:1,column:1}];let u=0,p=[],y=0,w;if(e.startRule!==void 0){if(!(e.startRule in i))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');n=i[e.startRule]}function C(){return t.substring(d,c)}function A(){return W(d,c)}function f(b,T){return{type:"literal",text:b,ignoreCase:T}}function I(b,T,x){return{type:"class",parts:b,inverted:T,ignoreCase:x}}function j(){return{type:"end"}}function R(b){let T=l[b],x;if(T)return T;for(x=b-1;!l[x];)x--;for(T=l[x],T={line:T.line,column:T.column};x<b;)t.charCodeAt(x)===10?(T.line++,T.column=1):T.column++,x++;return l[b]=T,T}function W(b,T){const x=R(b),ke=R(T);return{source:r,start:{offset:b,line:x.line,column:x.column},end:{offset:T,line:ke.line,column:ke.column}}}function xe(b){c<u||(c>u&&(u=c,p=[]),p.push(b))}function he(b,T,x){return new Hs(Hs.buildMessage(b,T),b,T,x)}function h(b){return b.split("").map(T=>T.charCodeAt(0)-32)}function ee(b){const T=a[b];let x=0;const ke=[];let le=T.length;const re=[],M=[];let fe;for(;;){for(;x<le;)switch(T[x]){case 0:M.push(o[T[x+1]]),x+=2;break;case 1:M.push(void 0),x++;break;case 2:M.push(null),x++;break;case 3:M.push(s),x++;break;case 4:M.push([]),x++;break;case 5:M.push(c),x++;break;case 6:M.pop(),x++;break;case 7:c=M.pop(),x++;break;case 8:M.length-=T[x+1],x+=2;break;case 9:M.splice(-2,1),x++;break;case 10:M[M.length-2].push(M.pop()),x++;break;case 11:M.push(M.splice(M.length-T[x+1],T[x+1])),x+=2;break;case 12:M.push(t.substring(M.pop(),c)),x++;break;case 13:re.push(le),ke.push(x+3+T[x+1]+T[x+2]),M[M.length-1]?(le=x+3+T[x+1],x+=3):(le=x+3+T[x+1]+T[x+2],x+=3+T[x+1]);break;case 14:re.push(le),ke.push(x+3+T[x+1]+T[x+2]),M[M.length-1]===s?(le=x+3+T[x+1],x+=3):(le=x+3+T[x+1]+T[x+2],x+=3+T[x+1]);break;case 15:re.push(le),ke.push(x+3+T[x+1]+T[x+2]),M[M.length-1]!==s?(le=x+3+T[x+1],x+=3):(le=x+3+T[x+1]+T[x+2],x+=3+T[x+1]);break;case 16:M[M.length-1]!==s?(re.push(le),ke.push(x),le=x+2+T[x+1],x+=2):x+=2+T[x+1];break;case 17:re.push(le),ke.push(x+3+T[x+1]+T[x+2]),t.length>c?(le=x+3+T[x+1],x+=3):(le=x+3+T[x+1]+T[x+2],x+=3+T[x+1]);break;case 18:re.push(le),ke.push(x+4+T[x+2]+T[x+3]),t.substr(c,o[T[x+1]].length)===o[T[x+1]]?(le=x+4+T[x+2],x+=4):(le=x+4+T[x+2]+T[x+3],x+=4+T[x+2]);break;case 19:re.push(le),ke.push(x+4+T[x+2]+T[x+3]),t.substr(c,o[T[x+1]].length).toLowerCase()===o[T[x+1]]?(le=x+4+T[x+2],x+=4):(le=x+4+T[x+2]+T[x+3],x+=4+T[x+2]);break;case 20:re.push(le),ke.push(x+4+T[x+2]+T[x+3]),o[T[x+1]].test(t.charAt(c))?(le=x+4+T[x+2],x+=4):(le=x+4+T[x+2]+T[x+3],x+=4+T[x+2]);break;case 21:M.push(t.substr(c,T[x+1])),c+=T[x+1],x+=2;break;case 22:M.push(o[T[x+1]]),c+=o[T[x+1]].length,x+=2;break;case 23:M.push(s),y===0&&xe(o[T[x+1]]),x+=2;break;case 24:d=M[M.length-1-T[x+1]],x+=2;break;case 25:d=c,x++;break;case 26:fe=T.slice(x+4,x+4+T[x+3]).map(function(Pt){return M[M.length-1-Pt]}),M.splice(M.length-T[x+2],T[x+2],o[T[x+1]].apply(null,fe)),x+=4+T[x+3];break;case 27:M.push(ee(T[x+1])),x+=2;break;case 28:y++,x++;break;case 29:y--,x++;break;default:throw new Error("Invalid opcode: "+T[x]+".")}if(re.length>0)le=re.pop(),x=ke.pop();else break}return M[0]}e.data={};function we(b,T){return[b].concat(T)}if(w=ee(n),w!==s&&c===t.length)return w;throw w!==s&&c<t.length&&xe(j()),he(p,u<t.length?t.charAt(u):null,u<t.length?W(u,u+1):W(u,u))}const Tf=Cf;var Pe;(function(t){function e(i,n){const o={startRule:n};try{Tf(i,o)}catch{o.data=-1}return o.data}t.parse=e;function s(i){const n=t.parse(i,"Name_Addr_Header");return n!==-1?n:void 0}t.nameAddrHeaderParse=s;function r(i){const n=t.parse(i,"SIP_URI");return n!==-1?n:void 0}t.URIParse=r})(Pe=Pe||(Pe={}));const Ef={100:"Trying",180:"Ringing",181:"Call Is Being Forwarded",182:"Queued",183:"Session Progress",199:"Early Dialog Terminated",200:"OK",202:"Accepted",204:"No Notification",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",305:"Use Proxy",380:"Alternative Service",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",410:"Gone",412:"Conditional Request Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Unsupported URI Scheme",417:"Unknown Resource-Priority",420:"Bad Extension",421:"Extension Required",422:"Session Interval Too Small",423:"Interval Too Brief",428:"Use Identity Header",429:"Provide Referrer Identity",430:"Flow Failed",433:"Anonymity Disallowed",436:"Bad Identity-Info",437:"Unsupported Certificate",438:"Invalid Identity Header",439:"First Hop Lacks Outbound Support",440:"Max-Breadth Exceeded",469:"Bad Info Package",470:"Consent Needed",478:"Unresolvable Destination",480:"Temporarily Unavailable",481:"Call/Transaction Does Not Exist",482:"Loop Detected",483:"Too Many Hops",484:"Address Incomplete",485:"Ambiguous",486:"Busy Here",487:"Request Terminated",488:"Not Acceptable Here",489:"Bad Event",491:"Request Pending",493:"Undecipherable",494:"Security Agreement Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Server Time-out",505:"Version Not Supported",513:"Message Too Large",580:"Precondition Failure",600:"Busy Everywhere",603:"Decline",604:"Does Not Exist Anywhere",606:"Not Acceptable"};function gs(t,e=32){let s="";for(let r=0;r<t;r++){const i=Math.floor(Math.random()*e);s+=i.toString(e)}return s}function xi(t){return Ef[t]||""}function Ci(){return gs(10)}function Rt(t){const e={"Call-Id":"Call-ID",Cseq:"CSeq","Min-Se":"Min-SE",Rack:"RAck",Rseq:"RSeq","Www-Authenticate":"WWW-Authenticate"},s=t.toLowerCase().replace(/_/g,"-").split("-"),r=s.length;let i="";for(let n=0;n<r;n++)n!==0&&(i+="-"),i+=s[n].charAt(0).toUpperCase()+s[n].substring(1);return e[i]&&(i=e[i]),i}function ur(t){return encodeURIComponent(t).replace(/%[A-F\d]{2}/g,"U").length}class Bc{constructor(){this.headers={}}addHeader(e,s){const r={raw:s};e=Rt(e),this.headers[e]?this.headers[e].push(r):this.headers[e]=[r]}getHeader(e){const s=this.headers[Rt(e)];if(s){if(s[0])return s[0].raw}else return}getHeaders(e){const s=this.headers[Rt(e)],r=[];if(!s)return[];for(const i of s)r.push(i.raw);return r}hasHeader(e){return!!this.headers[Rt(e)]}parseHeader(e,s=0){if(e=Rt(e),this.headers[e]){if(s>=this.headers[e].length)return}else return;const r=this.headers[e][s],i=r.raw;if(r.parsed)return r.parsed;const n=Pe.parse(i,e.replace(/-/g,"_"));if(n===-1){this.headers[e].splice(s,1);return}else return r.parsed=n,n}s(e,s=0){return this.parseHeader(e,s)}setHeader(e,s){this.headers[Rt(e)]=[{raw:s}]}toString(){return this.data}}class Ps extends Bc{constructor(){super()}}class ss extends Bc{constructor(){super()}}class bs{constructor(e,s,r,i,n,o,a){this.headers={},this.extraHeaders=[],this.options=bs.getDefaultOptions(),n&&(this.options=Object.assign(Object.assign({},this.options),n),this.options.optionTags&&this.options.optionTags.length&&(this.options.optionTags=this.options.optionTags.slice()),this.options.routeSet&&this.options.routeSet.length&&(this.options.routeSet=this.options.routeSet.slice())),o&&o.length&&(this.extraHeaders=o.slice()),a&&(this.body={body:a.content,contentType:a.contentType}),this.method=e,this.ruri=s.clone(),this.fromURI=r.clone(),this.fromTag=this.options.fromTag?this.options.fromTag:Ci(),this.from=bs.makeNameAddrHeader(this.fromURI,this.options.fromDisplayName,this.fromTag),this.toURI=i.clone(),this.toTag=this.options.toTag,this.to=bs.makeNameAddrHeader(this.toURI,this.options.toDisplayName,this.toTag),this.callId=this.options.callId?this.options.callId:this.options.callIdPrefix+gs(15),this.cseq=this.options.cseq,this.setHeader("route",this.options.routeSet),this.setHeader("via",""),this.setHeader("to",this.to.toString()),this.setHeader("from",this.from.toString()),this.setHeader("cseq",this.cseq+" "+this.method),this.setHeader("call-id",this.callId),this.setHeader("max-forwards","70")}static getDefaultOptions(){return{callId:"",callIdPrefix:"",cseq:1,toDisplayName:"",toTag:"",fromDisplayName:"",fromTag:"",forceRport:!1,hackViaTcp:!1,optionTags:["outbound"],routeSet:[],userAgentString:"sip.js",viaHost:""}}static makeNameAddrHeader(e,s,r){const i={};return r&&(i.tag=r),new Je(e,s,i)}getHeader(e){const s=this.headers[Rt(e)];if(s){if(s[0])return s[0]}else{const r=new RegExp("^\\s*"+e+"\\s*:","i");for(const i of this.extraHeaders)if(r.test(i))return i.substring(i.indexOf(":")+1).trim()}}getHeaders(e){const s=[],r=this.headers[Rt(e)];if(r)for(const i of r)s.push(i);else{const i=new RegExp("^\\s*"+e+"\\s*:","i");for(const n of this.extraHeaders)i.test(n)&&s.push(n.substring(n.indexOf(":")+1).trim())}return s}hasHeader(e){if(this.headers[Rt(e)])return!0;{const s=new RegExp("^\\s*"+e+"\\s*:","i");for(const r of this.extraHeaders)if(s.test(r))return!0}return!1}setHeader(e,s){this.headers[Rt(e)]=s instanceof Array?s:[s]}setViaHeader(e,s){this.options.hackViaTcp&&(s="TCP");let r="SIP/2.0/"+s;r+=" "+this.options.viaHost+";branch="+e,this.options.forceRport&&(r+=";rport"),this.setHeader("via",r),this.branch=e}toString(){let e="";e+=this.method+" "+this.ruri.toRaw()+` SIP/2.0\r
`;for(const s in this.headers)if(this.headers[s])for(const r of this.headers[s])e+=s+": "+r+`\r
`;for(const s of this.extraHeaders)e+=s.trim()+`\r
`;return e+="Supported: "+this.options.optionTags.join(", ")+`\r
`,e+="User-Agent: "+this.options.userAgentString+`\r
`,this.body?typeof this.body=="string"?(e+="Content-Length: "+ur(this.body)+`\r
\r
`,e+=this.body):this.body.body&&this.body.contentType?(e+="Content-Type: "+this.body.contentType+`\r
`,e+="Content-Length: "+ur(this.body.body)+`\r
\r
`,e+=this.body.body):e+=`Content-Length: 0\r
\r
`:e+=`Content-Length: 0\r
\r
`,e}}function Uc(t){return t==="application/sdp"?"session":"render"}function Xr(t){const e=typeof t=="string"?t:t.body,s=typeof t=="string"?"application/sdp":t.contentType;return{contentDisposition:Uc(s),contentType:s,content:e}}function jc(t){return t&&typeof t.content=="string"&&typeof t.contentType=="string"&&t.contentDisposition===void 0?!0:typeof t.contentDisposition=="string"}function rr(t){let e,s,r;if(t instanceof Ps&&t.body){const i=t.parseHeader("Content-Disposition");e=i?i.type:void 0,s=t.parseHeader("Content-Type"),r=t.body}if(t instanceof ss&&t.body){const i=t.parseHeader("Content-Disposition");e=i?i.type:void 0,s=t.parseHeader("Content-Type"),r=t.body}if(t instanceof bs&&t.body)if(e=t.getHeader("Content-Disposition"),s=t.getHeader("Content-Type"),typeof t.body=="string"){if(!s)throw new Error("Header content type header does not equal body content type.");r=t.body}else{if(s&&s!==t.body.contentType)throw new Error("Header content type header does not equal body content type.");s=t.body.contentType,r=t.body.body}if(jc(t)&&(e=t.contentDisposition,s=t.contentType,r=t.content),!!r){if(s&&!e&&(e=Uc(s)),!e)throw new Error("Content disposition undefined.");if(!s)throw new Error("Content type undefined.");return{contentDisposition:e,contentType:s,content:r}}}var dt;(function(t){t.Initial="Initial",t.Early="Early",t.AckWait="AckWait",t.Confirmed="Confirmed",t.Terminated="Terminated"})(dt=dt||(dt={}));var F;(function(t){t.Initial="Initial",t.HaveLocalOffer="HaveLocalOffer",t.HaveRemoteOffer="HaveRemoteOffer",t.Stable="Stable",t.Closed="Closed"})(F=F||(F={}));const Ot=500,Sf=4e3,Vi=5e3,Fe={T1:Ot,T2:Sf,T4:Vi,TIMER_B:64*Ot,TIMER_D:0*Ot,TIMER_F:64*Ot,TIMER_H:64*Ot,TIMER_I:0*Vi,TIMER_J:0*Ot,TIMER_K:0*Vi,TIMER_L:64*Ot,TIMER_M:64*Ot,TIMER_N:64*Ot,PROVISIONAL_RESPONSE_INTERVAL:6e4};class zt extends xs{constructor(e){super(e||"Transaction state error.")}}var U;(function(t){t.ACK="ACK",t.BYE="BYE",t.CANCEL="CANCEL",t.INFO="INFO",t.INVITE="INVITE",t.MESSAGE="MESSAGE",t.NOTIFY="NOTIFY",t.OPTIONS="OPTIONS",t.REGISTER="REGISTER",t.UPDATE="UPDATE",t.SUBSCRIBE="SUBSCRIBE",t.PUBLISH="PUBLISH",t.REFER="REFER",t.PRACK="PRACK"})(U=U||(U={}));const Xt=[U.ACK,U.BYE,U.CANCEL,U.INFO,U.INVITE,U.MESSAGE,U.NOTIFY,U.OPTIONS,U.PRACK,U.REFER,U.REGISTER,U.SUBSCRIBE];class Vc{constructor(e){this.incomingMessageRequest=e}get request(){return this.incomingMessageRequest.message}accept(e){return this.incomingMessageRequest.accept(e),Promise.resolve()}reject(e){return this.incomingMessageRequest.reject(e),Promise.resolve()}}class wn{constructor(e){this.incomingNotifyRequest=e}get request(){return this.incomingNotifyRequest.message}accept(e){return this.incomingNotifyRequest.accept(e),Promise.resolve()}reject(e){return this.incomingNotifyRequest.reject(e),Promise.resolve()}}class _f{constructor(e,s){this.incomingReferRequest=e,this.session=s}get referTo(){const e=this.incomingReferRequest.message.parseHeader("refer-to");if(!(e instanceof Je))throw new Error("Failed to parse Refer-To header.");return e}get referredBy(){return this.incomingReferRequest.message.getHeader("referred-by")}get replaces(){const e=this.referTo.uri.getHeader("replaces");return e instanceof Array?e[0]:e}get request(){return this.incomingReferRequest.message}accept(e={statusCode:202}){return this.incomingReferRequest.accept(e),Promise.resolve()}reject(e){return this.incomingReferRequest.reject(e),Promise.resolve()}makeInviter(e){if(this.inviter)return this.inviter;const s=this.referTo.uri.clone();s.clearHeaders(),e=e||{};const r=(e.extraHeaders||[]).slice(),i=this.replaces;i&&r.push("Replaces: "+decodeURIComponent(i));const n=this.referredBy;return n&&r.push("Referred-By: "+n),e.extraHeaders=r,this.inviter=this.session.userAgent._makeInviter(s,e),this.inviter._referred=this.session,this.session._referral=this.inviter,this.inviter}}var S;(function(t){t.Initial="Initial",t.Establishing="Establishing",t.Established="Established",t.Terminating="Terminating",t.Terminated="Terminated"})(S=S||(S={}));class hr{constructor(e,s={}){this.pendingReinvite=!1,this.pendingReinviteAck=!1,this._state=S.Initial,this.delegate=s.delegate,this._stateEventEmitter=new dr,this._userAgent=e}dispose(){switch(this.logger.log(`Session ${this.id} in state ${this._state} is being disposed`),delete this.userAgent._sessions[this.id],this._sessionDescriptionHandler&&this._sessionDescriptionHandler.close(),this.state){case S.Initial:break;case S.Establishing:break;case S.Established:return new Promise(e=>{this._bye({onAccept:()=>e(),onRedirect:()=>e(),onReject:()=>e()})});case S.Terminating:break;case S.Terminated:break;default:throw new Error("Unknown state.")}return Promise.resolve()}get assertedIdentity(){return this._assertedIdentity}get dialog(){return this._dialog}get id(){return this._id}get replacee(){return this._replacee}get sessionDescriptionHandler(){return this._sessionDescriptionHandler}get sessionDescriptionHandlerFactory(){return this.userAgent.configuration.sessionDescriptionHandlerFactory}get sessionDescriptionHandlerModifiers(){return this._sessionDescriptionHandlerModifiers||[]}set sessionDescriptionHandlerModifiers(e){this._sessionDescriptionHandlerModifiers=e.slice()}get sessionDescriptionHandlerOptions(){return this._sessionDescriptionHandlerOptions||{}}set sessionDescriptionHandlerOptions(e){this._sessionDescriptionHandlerOptions=Object.assign({},e)}get sessionDescriptionHandlerModifiersReInvite(){return this._sessionDescriptionHandlerModifiersReInvite||[]}set sessionDescriptionHandlerModifiersReInvite(e){this._sessionDescriptionHandlerModifiersReInvite=e.slice()}get sessionDescriptionHandlerOptionsReInvite(){return this._sessionDescriptionHandlerOptionsReInvite||{}}set sessionDescriptionHandlerOptionsReInvite(e){this._sessionDescriptionHandlerOptionsReInvite=Object.assign({},e)}get state(){return this._state}get stateChange(){return this._stateEventEmitter}get userAgent(){return this._userAgent}bye(e={}){let s="Session.bye() may only be called if established session.";switch(this.state){case S.Initial:typeof this.cancel=="function"?(s+=" However Inviter.invite() has not yet been called.",s+=" Perhaps you should have called Inviter.cancel()?"):typeof this.reject=="function"&&(s+=" However Invitation.accept() has not yet been called.",s+=" Perhaps you should have called Invitation.reject()?");break;case S.Establishing:typeof this.cancel=="function"?(s+=" However a dialog does not yet exist.",s+=" Perhaps you should have called Inviter.cancel()?"):typeof this.reject=="function"&&(s+=" However Invitation.accept() has not yet been called (or not yet resolved).",s+=" Perhaps you should have called Invitation.reject()?");break;case S.Established:{const r=e.requestDelegate,i=this.copyRequestOptions(e.requestOptions);return this._bye(r,i)}case S.Terminating:s+=" However this session is already terminating.",typeof this.cancel=="function"?s+=" Perhaps you have already called Inviter.cancel()?":typeof this.reject=="function"&&(s+=" Perhaps you have already called Session.bye()?");break;case S.Terminated:s+=" However this session is already terminated.";break;default:throw new Error("Unknown state")}return this.logger.error(s),Promise.reject(new Error(`Invalid session state ${this.state}`))}info(e={}){if(this.state!==S.Established)return this.logger.error("Session.info() may only be called if established session."),Promise.reject(new Error(`Invalid session state ${this.state}`));const s=e.requestDelegate,r=this.copyRequestOptions(e.requestOptions);return this._info(s,r)}invite(e={}){if(this.logger.log("Session.invite"),this.state!==S.Established)return Promise.reject(new Error(`Invalid session state ${this.state}`));if(this.pendingReinvite)return Promise.reject(new bn("Reinvite in progress. Please wait until complete, then try again."));this.pendingReinvite=!0,e.sessionDescriptionHandlerModifiers&&(this.sessionDescriptionHandlerModifiersReInvite=e.sessionDescriptionHandlerModifiers),e.sessionDescriptionHandlerOptions&&(this.sessionDescriptionHandlerOptionsReInvite=e.sessionDescriptionHandlerOptions);const s={onAccept:n=>{const o=rr(n.message);if(!o){this.logger.error("Received 2xx response to re-INVITE without a session description"),this.ackAndBye(n,400,"Missing session description"),this.stateTransition(S.Terminated),this.pendingReinvite=!1;return}if(e.withoutSdp){const a={sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptionsReInvite,sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiersReInvite};this.setOfferAndGetAnswer(o,a).then(c=>{n.ack({body:c})}).catch(c=>{this.logger.error("Failed to handle offer in 2xx response to re-INVITE"),this.logger.error(c.message),this.state===S.Terminated?n.ack():(this.ackAndBye(n,488,"Bad Media Description"),this.stateTransition(S.Terminated))}).then(()=>{this.pendingReinvite=!1,e.requestDelegate&&e.requestDelegate.onAccept&&e.requestDelegate.onAccept(n)})}else{const a={sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptionsReInvite,sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiersReInvite};this.setAnswer(o,a).then(()=>{n.ack()}).catch(c=>{this.logger.error("Failed to handle answer in 2xx response to re-INVITE"),this.logger.error(c.message),this.state!==S.Terminated?(this.ackAndBye(n,488,"Bad Media Description"),this.stateTransition(S.Terminated)):n.ack()}).then(()=>{this.pendingReinvite=!1,e.requestDelegate&&e.requestDelegate.onAccept&&e.requestDelegate.onAccept(n)})}},onProgress:n=>{},onRedirect:n=>{},onReject:n=>{this.logger.warn("Received a non-2xx response to re-INVITE"),this.pendingReinvite=!1,e.withoutSdp?e.requestDelegate&&e.requestDelegate.onReject&&e.requestDelegate.onReject(n):this.rollbackOffer().catch(o=>{if(this.logger.error("Failed to rollback offer on non-2xx response to re-INVITE"),this.logger.error(o.message),this.state!==S.Terminated){if(!this.dialog)throw new Error("Dialog undefined.");const a=[];a.push("Reason: "+this.getReasonHeaderValue(500,"Internal Server Error")),this.dialog.bye(void 0,{extraHeaders:a}),this.stateTransition(S.Terminated)}}).then(()=>{e.requestDelegate&&e.requestDelegate.onReject&&e.requestDelegate.onReject(n)})},onTrying:n=>{}},r=e.requestOptions||{};if(r.extraHeaders=(r.extraHeaders||[]).slice(),r.extraHeaders.push("Allow: "+Xt.toString()),r.extraHeaders.push("Contact: "+this._contact),e.withoutSdp){if(!this.dialog)throw this.pendingReinvite=!1,new Error("Dialog undefined.");return Promise.resolve(this.dialog.invite(s,r))}const i={sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptionsReInvite,sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiersReInvite};return this.getOffer(i).then(n=>{if(!this.dialog)throw this.pendingReinvite=!1,new Error("Dialog undefined.");return r.body=n,this.dialog.invite(s,r)}).catch(n=>{throw this.logger.error(n.message),this.logger.error("Failed to send re-INVITE"),this.pendingReinvite=!1,n})}message(e={}){if(this.state!==S.Established)return this.logger.error("Session.message() may only be called if established session."),Promise.reject(new Error(`Invalid session state ${this.state}`));const s=e.requestDelegate,r=this.copyRequestOptions(e.requestOptions);return this._message(s,r)}refer(e,s={}){if(this.state!==S.Established)return this.logger.error("Session.refer() may only be called if established session."),Promise.reject(new Error(`Invalid session state ${this.state}`));if(e instanceof hr&&!e.dialog)return this.logger.error("Session.refer() may only be called with session which is established. You are perhaps attempting to attended transfer to a target for which there is not dialog yet established. Perhaps you are attempting a 'semi-attended' tansfer? Regardless, this is not supported. The recommended approached is to check to see if the target Session is in the Established state before calling refer(); if the state is not Established you may proceed by falling back using a URI as the target (blind transfer)."),Promise.reject(new Error(`Invalid session state ${this.state}`));const r=s.requestDelegate,i=this.copyRequestOptions(s.requestOptions);return i.extraHeaders=i.extraHeaders?i.extraHeaders.concat(this.referExtraHeaders(this.referToString(e))):this.referExtraHeaders(this.referToString(e)),this._refer(s.onNotify,r,i)}_bye(e,s){if(!this.dialog)return Promise.reject(new Error("Session dialog undefined."));const r=this.dialog;switch(r.sessionState){case dt.Initial:throw new Error(`Invalid dialog state ${r.sessionState}`);case dt.Early:throw new Error(`Invalid dialog state ${r.sessionState}`);case dt.AckWait:return this.stateTransition(S.Terminating),new Promise(i=>{r.delegate={onAck:()=>{const n=r.bye(e,s);return this.stateTransition(S.Terminated),i(n),Promise.resolve()},onAckTimeout:()=>{const n=r.bye(e,s);this.stateTransition(S.Terminated),i(n)}}});case dt.Confirmed:{const i=r.bye(e,s);return this.stateTransition(S.Terminated),Promise.resolve(i)}case dt.Terminated:throw new Error(`Invalid dialog state ${r.sessionState}`);default:throw new Error("Unrecognized state.")}}_info(e,s){return this.dialog?Promise.resolve(this.dialog.info(e,s)):Promise.reject(new Error("Session dialog undefined."))}_message(e,s){return this.dialog?Promise.resolve(this.dialog.message(e,s)):Promise.reject(new Error("Session dialog undefined."))}_refer(e,s,r){return this.dialog?(this.onNotify=e,Promise.resolve(this.dialog.refer(s,r))):Promise.reject(new Error("Session dialog undefined."))}ackAndBye(e,s,r){e.ack();const i=[];s&&i.push("Reason: "+this.getReasonHeaderValue(s,r)),e.session.bye(void 0,{extraHeaders:i})}onAckRequest(e){if(this.logger.log("Session.onAckRequest"),this.state!==S.Established&&this.state!==S.Terminating)return this.logger.error(`ACK received while in state ${this.state}, dropping request`),Promise.resolve();const s=this.dialog;if(!s)throw new Error("Dialog undefined.");const r={sessionDescriptionHandlerOptions:this.pendingReinviteAck?this.sessionDescriptionHandlerOptionsReInvite:this.sessionDescriptionHandlerOptions,sessionDescriptionHandlerModifiers:this.pendingReinviteAck?this._sessionDescriptionHandlerModifiersReInvite:this._sessionDescriptionHandlerModifiers};if(this.delegate&&this.delegate.onAck){const i=new bf(e);this.delegate.onAck(i)}switch(this.pendingReinviteAck=!1,s.signalingState){case F.Initial:{this.logger.error(`Invalid signaling state ${s.signalingState}.`);const i=["Reason: "+this.getReasonHeaderValue(488,"Bad Media Description")];return s.bye(void 0,{extraHeaders:i}),this.stateTransition(S.Terminated),Promise.resolve()}case F.Stable:{const i=rr(e.message);return i?i.contentDisposition==="render"?(this._renderbody=i.content,this._rendertype=i.contentType,Promise.resolve()):i.contentDisposition!=="session"?Promise.resolve():this.setAnswer(i,r).catch(n=>{this.logger.error(n.message);const o=["Reason: "+this.getReasonHeaderValue(488,"Bad Media Description")];s.bye(void 0,{extraHeaders:o}),this.stateTransition(S.Terminated)}):Promise.resolve()}case F.HaveLocalOffer:{this.logger.error(`Invalid signaling state ${s.signalingState}.`);const i=["Reason: "+this.getReasonHeaderValue(488,"Bad Media Description")];return s.bye(void 0,{extraHeaders:i}),this.stateTransition(S.Terminated),Promise.resolve()}case F.HaveRemoteOffer:{this.logger.error(`Invalid signaling state ${s.signalingState}.`);const i=["Reason: "+this.getReasonHeaderValue(488,"Bad Media Description")];return s.bye(void 0,{extraHeaders:i}),this.stateTransition(S.Terminated),Promise.resolve()}case F.Closed:throw new Error(`Invalid signaling state ${s.signalingState}.`);default:throw new Error(`Invalid signaling state ${s.signalingState}.`)}}onByeRequest(e){if(this.logger.log("Session.onByeRequest"),this.state!==S.Established){this.logger.error(`BYE received while in state ${this.state}, dropping request`);return}if(this.delegate&&this.delegate.onBye){const s=new wf(e);this.delegate.onBye(s)}else e.accept();this.stateTransition(S.Terminated)}onInfoRequest(e){if(this.logger.log("Session.onInfoRequest"),this.state!==S.Established){this.logger.error(`INFO received while in state ${this.state}, dropping request`);return}if(this.delegate&&this.delegate.onInfo){const s=new xf(e);this.delegate.onInfo(s)}else e.accept()}onInviteRequest(e){if(this.logger.log("Session.onInviteRequest"),this.state!==S.Established){this.logger.error(`INVITE received while in state ${this.state}, dropping request`);return}this.pendingReinviteAck=!0;const s=["Contact: "+this._contact];if(e.message.hasHeader("P-Asserted-Identity")){const i=e.message.getHeader("P-Asserted-Identity");if(!i)throw new Error("Header undefined.");this._assertedIdentity=Pe.nameAddrHeaderParse(i)}const r={sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptionsReInvite,sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiersReInvite};this.generateResponseOfferAnswerInDialog(r).then(i=>{const n=e.accept({statusCode:200,extraHeaders:s,body:i});this.delegate&&this.delegate.onInvite&&this.delegate.onInvite(e.message,n.message,200)}).catch(i=>{if(this.logger.error(i.message),this.logger.error("Failed to handle to re-INVITE request"),!this.dialog)throw new Error("Dialog undefined.");if(this.logger.error(this.dialog.signalingState),this.dialog.signalingState===F.Stable){const n=e.reject({statusCode:488});this.delegate&&this.delegate.onInvite&&this.delegate.onInvite(e.message,n.message,488);return}this.rollbackOffer().then(()=>{const n=e.reject({statusCode:488});this.delegate&&this.delegate.onInvite&&this.delegate.onInvite(e.message,n.message,488)}).catch(n=>{this.logger.error(n.message),this.logger.error("Failed to rollback offer on re-INVITE request");const o=e.reject({statusCode:488});if(this.state!==S.Terminated){if(!this.dialog)throw new Error("Dialog undefined.");const a=[];a.push("Reason: "+this.getReasonHeaderValue(500,"Internal Server Error")),this.dialog.bye(void 0,{extraHeaders:a}),this.stateTransition(S.Terminated)}this.delegate&&this.delegate.onInvite&&this.delegate.onInvite(e.message,o.message,488)})})}onMessageRequest(e){if(this.logger.log("Session.onMessageRequest"),this.state!==S.Established){this.logger.error(`MESSAGE received while in state ${this.state}, dropping request`);return}if(this.delegate&&this.delegate.onMessage){const s=new Vc(e);this.delegate.onMessage(s)}else e.accept()}onNotifyRequest(e){if(this.logger.log("Session.onNotifyRequest"),this.state!==S.Established){this.logger.error(`NOTIFY received while in state ${this.state}, dropping request`);return}if(this.onNotify){const s=new wn(e);this.onNotify(s);return}if(this.delegate&&this.delegate.onNotify){const s=new wn(e);this.delegate.onNotify(s)}else e.accept()}onPrackRequest(e){if(this.logger.log("Session.onPrackRequest"),this.state!==S.Established){this.logger.error(`PRACK received while in state ${this.state}, dropping request`);return}throw new Error("Unimplemented.")}onReferRequest(e){if(this.logger.log("Session.onReferRequest"),this.state!==S.Established){this.logger.error(`REFER received while in state ${this.state}, dropping request`);return}if(!e.message.hasHeader("refer-to")){this.logger.warn("Invalid REFER packet. A refer-to header is required. Rejecting."),e.reject();return}const s=new _f(e,this);this.delegate&&this.delegate.onRefer?this.delegate.onRefer(s):(this.logger.log("No delegate available to handle REFER, automatically accepting and following."),s.accept().then(()=>s.makeInviter(this._referralInviterOptions).invite()).catch(r=>{this.logger.error(r.message)}))}generateResponseOfferAnswer(e,s){if(this.dialog)return this.generateResponseOfferAnswerInDialog(s);const r=rr(e.message);return!r||r.contentDisposition!=="session"?this.getOffer(s):this.setOfferAndGetAnswer(r,s)}generateResponseOfferAnswerInDialog(e){if(!this.dialog)throw new Error("Dialog undefined.");switch(this.dialog.signalingState){case F.Initial:return this.getOffer(e);case F.HaveLocalOffer:return Promise.resolve(void 0);case F.HaveRemoteOffer:if(!this.dialog.offer)throw new Error(`Session offer undefined in signaling state ${this.dialog.signalingState}.`);return this.setOfferAndGetAnswer(this.dialog.offer,e);case F.Stable:return this.state!==S.Established?Promise.resolve(void 0):this.getOffer(e);case F.Closed:throw new Error(`Invalid signaling state ${this.dialog.signalingState}.`);default:throw new Error(`Invalid signaling state ${this.dialog.signalingState}.`)}}getOffer(e){const s=this.setupSessionDescriptionHandler(),r=e.sessionDescriptionHandlerOptions,i=e.sessionDescriptionHandlerModifiers;try{return s.getDescription(r,i).then(n=>Xr(n)).catch(n=>{this.logger.error("Session.getOffer: SDH getDescription rejected...");const o=n instanceof Error?n:new Error("Session.getOffer unknown error.");throw this.logger.error(o.message),o})}catch(n){this.logger.error("Session.getOffer: SDH getDescription threw...");const o=n instanceof Error?n:new Error(n);return this.logger.error(o.message),Promise.reject(o)}}rollbackOffer(){const e=this.setupSessionDescriptionHandler();if(e.rollbackDescription===void 0)return Promise.resolve();try{return e.rollbackDescription().catch(s=>{this.logger.error("Session.rollbackOffer: SDH rollbackDescription rejected...");const r=s instanceof Error?s:new Error("Session.rollbackOffer unknown error.");throw this.logger.error(r.message),r})}catch(s){this.logger.error("Session.rollbackOffer: SDH rollbackDescription threw...");const r=s instanceof Error?s:new Error(s);return this.logger.error(r.message),Promise.reject(r)}}setAnswer(e,s){const r=this.setupSessionDescriptionHandler(),i=s.sessionDescriptionHandlerOptions,n=s.sessionDescriptionHandlerModifiers;try{if(!r.hasDescription(e.contentType))return Promise.reject(new vn)}catch(o){this.logger.error("Session.setAnswer: SDH hasDescription threw...");const a=o instanceof Error?o:new Error(o);return this.logger.error(a.message),Promise.reject(a)}try{return r.setDescription(e.content,i,n).catch(o=>{this.logger.error("Session.setAnswer: SDH setDescription rejected...");const a=o instanceof Error?o:new Error("Session.setAnswer unknown error.");throw this.logger.error(a.message),a})}catch(o){this.logger.error("Session.setAnswer: SDH setDescription threw...");const a=o instanceof Error?o:new Error(o);return this.logger.error(a.message),Promise.reject(a)}}setOfferAndGetAnswer(e,s){const r=this.setupSessionDescriptionHandler(),i=s.sessionDescriptionHandlerOptions,n=s.sessionDescriptionHandlerModifiers;try{if(!r.hasDescription(e.contentType))return Promise.reject(new vn)}catch(o){this.logger.error("Session.setOfferAndGetAnswer: SDH hasDescription threw...");const a=o instanceof Error?o:new Error(o);return this.logger.error(a.message),Promise.reject(a)}try{return r.setDescription(e.content,i,n).then(()=>r.getDescription(i,n)).then(o=>Xr(o)).catch(o=>{this.logger.error("Session.setOfferAndGetAnswer: SDH setDescription or getDescription rejected...");const a=o instanceof Error?o:new Error("Session.setOfferAndGetAnswer unknown error.");throw this.logger.error(a.message),a})}catch(o){this.logger.error("Session.setOfferAndGetAnswer: SDH setDescription or getDescription threw...");const a=o instanceof Error?o:new Error(o);return this.logger.error(a.message),Promise.reject(a)}}setSessionDescriptionHandler(e){if(this._sessionDescriptionHandler)throw new Error("Session description handler defined.");this._sessionDescriptionHandler=e}setupSessionDescriptionHandler(){var e;return this._sessionDescriptionHandler?this._sessionDescriptionHandler:(this._sessionDescriptionHandler=this.sessionDescriptionHandlerFactory(this,this.userAgent.configuration.sessionDescriptionHandlerFactoryOptions),!((e=this.delegate)===null||e===void 0)&&e.onSessionDescriptionHandler&&this.delegate.onSessionDescriptionHandler(this._sessionDescriptionHandler,!1),this._sessionDescriptionHandler)}stateTransition(e){const s=()=>{throw new Error(`Invalid state transition from ${this._state} to ${e}`)};switch(this._state){case S.Initial:e!==S.Establishing&&e!==S.Established&&e!==S.Terminating&&e!==S.Terminated&&s();break;case S.Establishing:e!==S.Established&&e!==S.Terminating&&e!==S.Terminated&&s();break;case S.Established:e!==S.Terminating&&e!==S.Terminated&&s();break;case S.Terminating:e!==S.Terminated&&s();break;case S.Terminated:s();break;default:throw new Error("Unrecognized state.")}this._state=e,this.logger.log(`Session ${this.id} transitioned to state ${this._state}`),this._stateEventEmitter.emit(this._state),e===S.Terminated&&this.dispose()}copyRequestOptions(e={}){const s=e.extraHeaders?e.extraHeaders.slice():void 0,r=e.body?{contentDisposition:e.body.contentDisposition||"render",contentType:e.body.contentType||"text/plain",content:e.body.content||""}:void 0;return{extraHeaders:s,body:r}}getReasonHeaderValue(e,s){const r=e;let i=xi(e);return!i&&s&&(i=s),"SIP;cause="+r+';text="'+i+'"'}referExtraHeaders(e){const s=[];return s.push("Referred-By: <"+this.userAgent.configuration.uri+">"),s.push("Contact: "+this._contact),s.push("Allow: "+["ACK","CANCEL","INVITE","MESSAGE","BYE","OPTIONS","INFO","NOTIFY","REFER"].toString()),s.push("Refer-To: "+e),s}referToString(e){let s;if(e instanceof It)s=e.toString();else{if(!e.dialog)throw new Error("Dialog undefined.");const r=e.remoteIdentity.friendlyName,i=e.dialog.remoteTarget.toString(),n=e.dialog.callId,o=e.dialog.remoteTag,a=e.dialog.localTag,c=encodeURIComponent(`${n};to-tag=${o};from-tag=${a}`);s=`"${r}" <${i}?Replaces=${c}>`}return s}}var pt;(function(t){t.Required="Required",t.Supported="Supported",t.Unsupported="Unsupported"})(pt=pt||(pt={}));const Rf={"100rel":!0,199:!0,answermode:!0,"early-session":!0,eventlist:!0,explicitsub:!0,"from-change":!0,"geolocation-http":!0,"geolocation-sip":!0,gin:!0,gruu:!0,histinfo:!0,ice:!0,join:!0,"multiple-refer":!0,norefersub:!0,nosub:!0,outbound:!0,path:!0,policy:!0,precondition:!0,pref:!0,privacy:!0,"recipient-list-invite":!0,"recipient-list-message":!0,"recipient-list-subscribe":!0,replaces:!0,"resource-priority":!0,"sdp-anat":!0,"sec-agree":!0,tdialog:!0,timer:!0,uui:!0};class Wc extends hr{constructor(e,s){super(e),this.incomingInviteRequest=s,this.disposed=!1,this.expiresTimer=void 0,this.isCanceled=!1,this.rel100="none",this.rseq=Math.floor(Math.random()*1e4),this.userNoAnswerTimer=void 0,this.waitingForPrack=!1,this.logger=e.getLogger("sip.Invitation");const r=this.incomingInviteRequest.message,i=r.getHeader("require");i&&i.toLowerCase().includes("100rel")&&(this.rel100="required");const n=r.getHeader("supported");if(n&&n.toLowerCase().includes("100rel")&&(this.rel100="supported"),r.toTag=s.toTag,typeof r.toTag!="string")throw new TypeError("toTag should have been a string.");if(this.userNoAnswerTimer=setTimeout(()=>{s.reject({statusCode:480}),this.stateTransition(S.Terminated)},this.userAgent.configuration.noAnswerTimeout?this.userAgent.configuration.noAnswerTimeout*1e3:6e4),r.hasHeader("expires")){const c=Number(r.getHeader("expires")||0)*1e3;this.expiresTimer=setTimeout(()=>{this.state===S.Initial&&(s.reject({statusCode:487}),this.stateTransition(S.Terminated))},c)}const o=this.request.getHeader("P-Asserted-Identity");o&&(this._assertedIdentity=Pe.nameAddrHeaderParse(o)),this._contact=this.userAgent.contact.toString();const a=r.parseHeader("Content-Disposition");a&&a.type==="render"&&(this._renderbody=r.body,this._rendertype=r.getHeader("Content-Type")),this._id=r.callId+r.fromTag,this.userAgent._sessions[this._id]=this}dispose(){if(this.disposed)return Promise.resolve();switch(this.disposed=!0,this.expiresTimer&&(clearTimeout(this.expiresTimer),this.expiresTimer=void 0),this.userNoAnswerTimer&&(clearTimeout(this.userNoAnswerTimer),this.userNoAnswerTimer=void 0),this.prackNeverArrived(),this.state){case S.Initial:return this.reject().then(()=>super.dispose());case S.Establishing:return this.reject().then(()=>super.dispose());case S.Established:return super.dispose();case S.Terminating:return super.dispose();case S.Terminated:return super.dispose();default:throw new Error("Unknown state.")}}get autoSendAnInitialProvisionalResponse(){return this.rel100!=="required"&&this.userAgent.configuration.sendInitialProvisionalResponse}get body(){return this.incomingInviteRequest.message.body}get localIdentity(){return this.request.to}get remoteIdentity(){return this.request.from}get request(){return this.incomingInviteRequest.message}accept(e={}){if(this.logger.log("Invitation.accept"),this.state!==S.Initial){const s=new Error(`Invalid session state ${this.state}`);return this.logger.error(s.message),Promise.reject(s)}return e.sessionDescriptionHandlerModifiers&&(this.sessionDescriptionHandlerModifiers=e.sessionDescriptionHandlerModifiers),e.sessionDescriptionHandlerOptions&&(this.sessionDescriptionHandlerOptions=e.sessionDescriptionHandlerOptions),this.stateTransition(S.Establishing),this.sendAccept(e).then(({message:s,session:r})=>{r.delegate={onAck:i=>this.onAckRequest(i),onAckTimeout:()=>this.onAckTimeout(),onBye:i=>this.onByeRequest(i),onInfo:i=>this.onInfoRequest(i),onInvite:i=>this.onInviteRequest(i),onMessage:i=>this.onMessageRequest(i),onNotify:i=>this.onNotifyRequest(i),onPrack:i=>this.onPrackRequest(i),onRefer:i=>this.onReferRequest(i)},this._dialog=r,this.stateTransition(S.Established),this._replacee&&this._replacee._bye()}).catch(s=>this.handleResponseError(s))}progress(e={}){if(this.logger.log("Invitation.progress"),this.state!==S.Initial){const r=new Error(`Invalid session state ${this.state}`);return this.logger.error(r.message),Promise.reject(r)}const s=e.statusCode||180;if(s<100||s>199)throw new TypeError("Invalid statusCode: "+s);return e.sessionDescriptionHandlerModifiers&&(this.sessionDescriptionHandlerModifiers=e.sessionDescriptionHandlerModifiers),e.sessionDescriptionHandlerOptions&&(this.sessionDescriptionHandlerOptions=e.sessionDescriptionHandlerOptions),this.waitingForPrack?(this.logger.warn("Unexpected call for progress while waiting for prack, ignoring"),Promise.resolve()):e.statusCode===100?this.sendProgressTrying().then(()=>{}).catch(r=>this.handleResponseError(r)):this.rel100!=="required"&&!(this.rel100==="supported"&&e.rel100)&&!(this.rel100==="supported"&&this.userAgent.configuration.sipExtension100rel===pt.Required)?this.sendProgress(e).then(()=>{}).catch(r=>this.handleResponseError(r)):this.sendProgressReliableWaitForPrack(e).then(()=>{}).catch(r=>this.handleResponseError(r))}reject(e={}){if(this.logger.log("Invitation.reject"),this.state!==S.Initial&&this.state!==S.Establishing){const o=new Error(`Invalid session state ${this.state}`);return this.logger.error(o.message),Promise.reject(o)}const s=e.statusCode||480,r=e.reasonPhrase?e.reasonPhrase:xi(s),i=e.extraHeaders||[];if(s<300||s>699)throw new TypeError("Invalid statusCode: "+s);const n=e.body?Xr(e.body):void 0;return s<400?this.incomingInviteRequest.redirect([],{statusCode:s,reasonPhrase:r,extraHeaders:i,body:n}):this.incomingInviteRequest.reject({statusCode:s,reasonPhrase:r,extraHeaders:i,body:n}),this.stateTransition(S.Terminated),Promise.resolve()}_onCancel(e){if(this.logger.log("Invitation._onCancel"),this.state!==S.Initial&&this.state!==S.Establishing){this.logger.error(`CANCEL received while in state ${this.state}, dropping request`);return}if(this.delegate&&this.delegate.onCancel){const s=new yf(e);this.delegate.onCancel(s)}this.isCanceled=!0,this.incomingInviteRequest.reject({statusCode:487}),this.stateTransition(S.Terminated)}handlePrackOfferAnswer(e){if(!this.dialog)throw new Error("Dialog undefined.");const s=rr(e.message);if(!s||s.contentDisposition!=="session")return Promise.resolve(void 0);const r={sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptions,sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiers};switch(this.dialog.signalingState){case F.Initial:throw new Error(`Invalid signaling state ${this.dialog.signalingState}.`);case F.Stable:return this.setAnswer(s,r).then(()=>{});case F.HaveLocalOffer:throw new Error(`Invalid signaling state ${this.dialog.signalingState}.`);case F.HaveRemoteOffer:return this.setOfferAndGetAnswer(s,r);case F.Closed:throw new Error(`Invalid signaling state ${this.dialog.signalingState}.`);default:throw new Error(`Invalid signaling state ${this.dialog.signalingState}.`)}}handleResponseError(e){let s=480;if(e instanceof Error?this.logger.error(e.message):this.logger.error(e),e instanceof vn?(this.logger.error("A session description handler occurred while sending response (content type unsupported"),s=415):e instanceof vf?this.logger.error("A session description handler occurred while sending response"):e instanceof Ui?this.logger.error("Session ended before response could be formulated and sent (while waiting for PRACK)"):e instanceof zt&&this.logger.error("Session changed state before response could be formulated and sent"),this.state===S.Initial||this.state===S.Establishing)try{this.incomingInviteRequest.reject({statusCode:s}),this.stateTransition(S.Terminated)}catch(r){throw this.logger.error("An error occurred attempting to reject the request while handling another error"),r}if(this.isCanceled){this.logger.warn("An error occurred while attempting to formulate and send a response to an incoming INVITE. However a CANCEL was received and processed while doing so which can (and often does) result in errors occurring as the session terminates in the meantime. Said error is being ignored.");return}throw e}onAckTimeout(){if(this.logger.log("Invitation.onAckTimeout"),!this.dialog)throw new Error("Dialog undefined.");this.logger.log("No ACK received for an extended period of time, terminating session"),this.dialog.bye(),this.stateTransition(S.Terminated)}sendAccept(e={}){const s={sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptions,sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiers},r=e.extraHeaders||[];return this.waitingForPrack?this.waitForArrivalOfPrack().then(()=>clearTimeout(this.userNoAnswerTimer)).then(()=>this.generateResponseOfferAnswer(this.incomingInviteRequest,s)).then(i=>this.incomingInviteRequest.accept({statusCode:200,body:i,extraHeaders:r})):(clearTimeout(this.userNoAnswerTimer),this.generateResponseOfferAnswer(this.incomingInviteRequest,s).then(i=>this.incomingInviteRequest.accept({statusCode:200,body:i,extraHeaders:r})))}sendProgress(e={}){const s=e.statusCode||180,r=e.reasonPhrase,i=(e.extraHeaders||[]).slice(),n=e.body?Xr(e.body):void 0;if(s===183&&!n)return this.sendProgressWithSDP(e);try{const o=this.incomingInviteRequest.progress({statusCode:s,reasonPhrase:r,extraHeaders:i,body:n});return this._dialog=o.session,Promise.resolve(o)}catch(o){return Promise.reject(o)}}sendProgressWithSDP(e={}){const s={sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptions,sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiers},r=e.statusCode||183,i=e.reasonPhrase,n=(e.extraHeaders||[]).slice();return this.generateResponseOfferAnswer(this.incomingInviteRequest,s).then(o=>this.incomingInviteRequest.progress({statusCode:r,reasonPhrase:i,extraHeaders:n,body:o})).then(o=>(this._dialog=o.session,o))}sendProgressReliable(e={}){return e.extraHeaders=(e.extraHeaders||[]).slice(),e.extraHeaders.push("Require: 100rel"),e.extraHeaders.push("RSeq: "+Math.floor(Math.random()*1e4)),this.sendProgressWithSDP(e)}sendProgressReliableWaitForPrack(e={}){const s={sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptions,sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiers},r=e.statusCode||183,i=e.reasonPhrase,n=(e.extraHeaders||[]).slice();n.push("Require: 100rel"),n.push("RSeq: "+this.rseq++);let o;return new Promise((a,c)=>{this.waitingForPrack=!0,this.generateResponseOfferAnswer(this.incomingInviteRequest,s).then(d=>(o=d,this.incomingInviteRequest.progress({statusCode:r,reasonPhrase:i,extraHeaders:n,body:o}))).then(d=>{this._dialog=d.session;let l,u;d.session.delegate={onPrack:f=>{l=f,clearTimeout(y),clearTimeout(A),this.waitingForPrack&&(this.waitingForPrack=!1,this.handlePrackOfferAnswer(l).then(I=>{try{u=l.accept({statusCode:200,body:I}),this.prackArrived(),a({prackRequest:l,prackResponse:u,progressResponse:d})}catch(j){c(j)}}).catch(I=>c(I)))}};const y=setTimeout(()=>{this.waitingForPrack&&(this.waitingForPrack=!1,this.logger.warn("No PRACK received, rejecting INVITE."),clearTimeout(A),this.reject({statusCode:504}).then(()=>c(new Ui)).catch(f=>c(f)))},Fe.T1*64),w=()=>{try{this.incomingInviteRequest.progress({statusCode:r,reasonPhrase:i,extraHeaders:n,body:o})}catch(f){this.waitingForPrack=!1,c(f);return}A=setTimeout(w,C*=2)};let C=Fe.T1,A=setTimeout(w,C)}).catch(d=>{this.waitingForPrack=!1,c(d)})})}sendProgressTrying(){try{const e=this.incomingInviteRequest.trying();return Promise.resolve(e)}catch(e){return Promise.reject(e)}}waitForArrivalOfPrack(){if(this.waitingForPrackPromise)throw new Error("Already waiting for PRACK");return this.waitingForPrackPromise=new Promise((e,s)=>{this.waitingForPrackResolve=e,this.waitingForPrackReject=s}),this.waitingForPrackPromise}prackArrived(){this.waitingForPrackResolve&&this.waitingForPrackResolve(),this.waitingForPrackPromise=void 0,this.waitingForPrackResolve=void 0,this.waitingForPrackReject=void 0}prackNeverArrived(){this.waitingForPrackReject&&this.waitingForPrackReject(new Ui),this.waitingForPrackPromise=void 0,this.waitingForPrackResolve=void 0,this.waitingForPrackReject=void 0}}class Lr extends hr{constructor(e,s,r={}){super(e,r),this.disposed=!1,this.earlyMedia=!1,this.earlyMediaSessionDescriptionHandlers=new Map,this.isCanceled=!1,this.inviteWithoutSdp=!1,this.logger=e.getLogger("sip.Inviter"),this.earlyMedia=r.earlyMedia!==void 0?r.earlyMedia:this.earlyMedia,this.fromTag=Ci(),this.inviteWithoutSdp=r.inviteWithoutSdp!==void 0?r.inviteWithoutSdp:this.inviteWithoutSdp;const i=Object.assign({},r);i.params=Object.assign({},r.params);const n=r.anonymous||!1,o=e.contact.toString({anonymous:n,outbound:n?!e.contact.tempGruu:!e.contact.pubGruu});n&&e.configuration.uri&&(i.params.fromDisplayName="Anonymous",i.params.fromUri="sip:anonymous@anonymous.invalid");let a=e.userAgentCore.configuration.aor;if(i.params.fromUri&&(a=typeof i.params.fromUri=="string"?Pe.URIParse(i.params.fromUri):i.params.fromUri),!a)throw new TypeError("Invalid from URI: "+i.params.fromUri);let c=s;if(i.params.toUri&&(c=typeof i.params.toUri=="string"?Pe.URIParse(i.params.toUri):i.params.toUri),!c)throw new TypeError("Invalid to URI: "+i.params.toUri);const d=Object.assign({},i.params);d.fromTag=this.fromTag;const l=(i.extraHeaders||[]).slice();n&&e.configuration.uri&&(l.push("P-Preferred-Identity: "+e.configuration.uri.toString()),l.push("Privacy: id")),l.push("Contact: "+o),l.push("Allow: "+["ACK","CANCEL","INVITE","MESSAGE","BYE","OPTIONS","INFO","NOTIFY","REFER"].toString()),e.configuration.sipExtension100rel===pt.Required&&l.push("Require: 100rel"),e.configuration.sipExtensionReplaces===pt.Required&&l.push("Require: replaces"),i.extraHeaders=l;const u=void 0;this.outgoingRequestMessage=e.userAgentCore.makeOutgoingRequestMessage(U.INVITE,s,a,c,d,l,u),this._contact=o,this._referralInviterOptions=i,this._renderbody=r.renderbody,this._rendertype=r.rendertype,r.sessionDescriptionHandlerModifiers&&(this.sessionDescriptionHandlerModifiers=r.sessionDescriptionHandlerModifiers),r.sessionDescriptionHandlerOptions&&(this.sessionDescriptionHandlerOptions=r.sessionDescriptionHandlerOptions),r.sessionDescriptionHandlerModifiersReInvite&&(this.sessionDescriptionHandlerModifiersReInvite=r.sessionDescriptionHandlerModifiersReInvite),r.sessionDescriptionHandlerOptionsReInvite&&(this.sessionDescriptionHandlerOptionsReInvite=r.sessionDescriptionHandlerOptionsReInvite),this._id=this.outgoingRequestMessage.callId+this.fromTag,this.userAgent._sessions[this._id]=this}dispose(){if(this.disposed)return Promise.resolve();switch(this.disposed=!0,this.disposeEarlyMedia(),this.state){case S.Initial:return this.cancel().then(()=>super.dispose());case S.Establishing:return this.cancel().then(()=>super.dispose());case S.Established:return super.dispose();case S.Terminating:return super.dispose();case S.Terminated:return super.dispose();default:throw new Error("Unknown state.")}}get body(){return this.outgoingRequestMessage.body}get localIdentity(){return this.outgoingRequestMessage.from}get remoteIdentity(){return this.outgoingRequestMessage.to}get request(){return this.outgoingRequestMessage}cancel(e={}){if(this.logger.log("Inviter.cancel"),this.state!==S.Initial&&this.state!==S.Establishing){const r=new Error(`Invalid session state ${this.state}`);return this.logger.error(r.message),Promise.reject(r)}this.isCanceled=!0,this.stateTransition(S.Terminating);function s(r,i){if(r&&r<200||r>699)throw new TypeError("Invalid statusCode: "+r);if(r){const n=r,o=xi(r)||i;return"SIP;cause="+n+';text="'+o+'"'}}if(this.outgoingInviteRequest){let r;e.statusCode&&e.reasonPhrase&&(r=s(e.statusCode,e.reasonPhrase)),this.outgoingInviteRequest.cancel(r,e)}else this.logger.warn("Canceled session before INVITE was sent"),this.stateTransition(S.Terminated);return Promise.resolve()}invite(e={}){if(this.logger.log("Inviter.invite"),this.state!==S.Initial)return super.invite(e);if(e.sessionDescriptionHandlerModifiers&&(this.sessionDescriptionHandlerModifiers=e.sessionDescriptionHandlerModifiers),e.sessionDescriptionHandlerOptions&&(this.sessionDescriptionHandlerOptions=e.sessionDescriptionHandlerOptions),e.withoutSdp||this.inviteWithoutSdp)return this._renderbody&&this._rendertype&&(this.outgoingRequestMessage.body={contentType:this._rendertype,body:this._renderbody}),this.stateTransition(S.Establishing),Promise.resolve(this.sendInvite(e));const s={sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiers,sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptions};return this.getOffer(s).then(r=>(this.outgoingRequestMessage.body={body:r.content,contentType:r.contentType},this.stateTransition(S.Establishing),this.sendInvite(e))).catch(r=>{throw this.logger.log(r.message),this.state!==S.Terminated&&this.stateTransition(S.Terminated),r})}sendInvite(e={}){return this.outgoingInviteRequest=this.userAgent.userAgentCore.invite(this.outgoingRequestMessage,{onAccept:s=>{if(this.dialog){this.logger.log("Additional confirmed dialog, sending ACK and BYE"),this.ackAndBye(s);return}if(this.isCanceled){this.logger.log("Canceled session accepted, sending ACK and BYE"),this.ackAndBye(s),this.stateTransition(S.Terminated);return}this.notifyReferer(s),this.onAccept(s).then(()=>{this.disposeEarlyMedia()}).catch(()=>{this.disposeEarlyMedia()}).then(()=>{e.requestDelegate&&e.requestDelegate.onAccept&&e.requestDelegate.onAccept(s)})},onProgress:s=>{this.isCanceled||(this.notifyReferer(s),this.onProgress(s).catch(()=>{this.disposeEarlyMedia()}).then(()=>{e.requestDelegate&&e.requestDelegate.onProgress&&e.requestDelegate.onProgress(s)}))},onRedirect:s=>{this.notifyReferer(s),this.onRedirect(s),e.requestDelegate&&e.requestDelegate.onRedirect&&e.requestDelegate.onRedirect(s)},onReject:s=>{this.notifyReferer(s),this.onReject(s),e.requestDelegate&&e.requestDelegate.onReject&&e.requestDelegate.onReject(s)},onTrying:s=>{this.notifyReferer(s),this.onTrying(s),e.requestDelegate&&e.requestDelegate.onTrying&&e.requestDelegate.onTrying(s)}}),this.outgoingInviteRequest}disposeEarlyMedia(){this.earlyMediaSessionDescriptionHandlers.forEach(e=>{e.close()}),this.earlyMediaSessionDescriptionHandlers.clear()}notifyReferer(e){if(!this._referred)return;if(!(this._referred instanceof hr))throw new Error("Referred session not instance of session");if(!this._referred.dialog)return;if(!e.message.statusCode)throw new Error("Status code undefined.");if(!e.message.reasonPhrase)throw new Error("Reason phrase undefined.");const s=e.message.statusCode,r=e.message.reasonPhrase,i=`SIP/2.0 ${s} ${r}`.trim(),n=this._referred.dialog.notify(void 0,{extraHeaders:["Event: refer","Subscription-State: terminated"],body:{contentDisposition:"render",contentType:"message/sipfrag",content:i}});n.delegate={onReject:()=>{this._referred=void 0}}}onAccept(e){if(this.logger.log("Inviter.onAccept"),this.state!==S.Establishing)return this.logger.error(`Accept received while in state ${this.state}, dropping response`),Promise.reject(new Error(`Invalid session state ${this.state}`));const s=e.message,r=e.session;switch(s.hasHeader("P-Asserted-Identity")&&(this._assertedIdentity=Pe.nameAddrHeaderParse(s.getHeader("P-Asserted-Identity"))),r.delegate={onAck:i=>this.onAckRequest(i),onBye:i=>this.onByeRequest(i),onInfo:i=>this.onInfoRequest(i),onInvite:i=>this.onInviteRequest(i),onMessage:i=>this.onMessageRequest(i),onNotify:i=>this.onNotifyRequest(i),onPrack:i=>this.onPrackRequest(i),onRefer:i=>this.onReferRequest(i)},this._dialog=r,r.signalingState){case F.Initial:return this.logger.error("Received 2xx response to INVITE without a session description"),this.ackAndBye(e,400,"Missing session description"),this.stateTransition(S.Terminated),Promise.reject(new Error("Bad Media Description"));case F.HaveLocalOffer:return this.logger.error("Received 2xx response to INVITE without a session description"),this.ackAndBye(e,400,"Missing session description"),this.stateTransition(S.Terminated),Promise.reject(new Error("Bad Media Description"));case F.HaveRemoteOffer:{if(!this._dialog.offer)throw new Error(`Session offer undefined in signaling state ${this._dialog.signalingState}.`);const i={sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiers,sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptions};return this.setOfferAndGetAnswer(this._dialog.offer,i).then(n=>{e.ack({body:n}),this.stateTransition(S.Established)}).catch(n=>{throw this.ackAndBye(e,488,"Invalid session description"),this.stateTransition(S.Terminated),n})}case F.Stable:{if(this.earlyMediaSessionDescriptionHandlers.size>0){const o=this.earlyMediaSessionDescriptionHandlers.get(r.id);if(!o)throw new Error("Session description handler undefined.");return this.setSessionDescriptionHandler(o),this.earlyMediaSessionDescriptionHandlers.delete(r.id),e.ack(),this.stateTransition(S.Established),Promise.resolve()}if(this.earlyMediaDialog){if(this.earlyMediaDialog!==r){this.earlyMedia&&this.logger.error("You have set the 'earlyMedia' option to 'true' which requires that your INVITE requests do not fork and yet this INVITE request did in fact fork. Consequentially and not surprisingly the end point which accepted the INVITE (confirmed dialog) does not match the end point with which early media has been setup (early dialog) and thus this session is unable to proceed. In accordance with the SIP specifications, the SIP servers your end point is connected to determine if an INVITE forks and the forking behavior of those servers cannot be controlled by this library. If you wish to use early media with this library you must configure those servers accordingly. Alternatively you may set the 'earlyMedia' to 'false' which will allow this library to function with any INVITE requests which do fork.");const o=new Error("Early media dialog does not equal confirmed dialog, terminating session");return this.logger.error(o.message),this.ackAndBye(e,488,"Not Acceptable Here"),this.stateTransition(S.Terminated),Promise.reject(o)}return e.ack(),this.stateTransition(S.Established),Promise.resolve()}const i=r.answer;if(!i)throw new Error("Answer is undefined.");const n={sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiers,sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptions};return this.setAnswer(i,n).then(()=>{let o;this._renderbody&&this._rendertype&&(o={body:{contentDisposition:"render",contentType:this._rendertype,content:this._renderbody}}),e.ack(o),this.stateTransition(S.Established)}).catch(o=>{throw this.logger.error(o.message),this.ackAndBye(e,488,"Not Acceptable Here"),this.stateTransition(S.Terminated),o})}case F.Closed:return Promise.reject(new Error("Terminated."));default:throw new Error("Unknown session signaling state.")}}onProgress(e){var s;if(this.logger.log("Inviter.onProgress"),this.state!==S.Establishing)return this.logger.error(`Progress received while in state ${this.state}, dropping response`),Promise.reject(new Error(`Invalid session state ${this.state}`));if(!this.outgoingInviteRequest)throw new Error("Outgoing INVITE request undefined.");const r=e.message,i=e.session;r.hasHeader("P-Asserted-Identity")&&(this._assertedIdentity=Pe.nameAddrHeaderParse(r.getHeader("P-Asserted-Identity")));const n=r.getHeader("require"),o=r.getHeader("rseq"),c=!!(n&&n.includes("100rel")&&o?Number(o):void 0),d=[];switch(c&&d.push("RAck: "+r.getHeader("rseq")+" "+r.getHeader("cseq")),i.signalingState){case F.Initial:return c&&(this.logger.warn("First reliable provisional response received MUST contain an offer when INVITE does not contain an offer."),e.prack({extraHeaders:d})),Promise.resolve();case F.HaveLocalOffer:return c&&e.prack({extraHeaders:d}),Promise.resolve();case F.HaveRemoteOffer:if(!c)return this.logger.warn("Non-reliable provisional response MUST NOT contain an initial offer, discarding response."),Promise.resolve();{const l=this.sessionDescriptionHandlerFactory(this,this.userAgent.configuration.sessionDescriptionHandlerFactoryOptions||{});return!((s=this.delegate)===null||s===void 0)&&s.onSessionDescriptionHandler&&this.delegate.onSessionDescriptionHandler(l,!0),this.earlyMediaSessionDescriptionHandlers.set(i.id,l),l.setDescription(r.body,this.sessionDescriptionHandlerOptions,this.sessionDescriptionHandlerModifiers).then(()=>l.getDescription(this.sessionDescriptionHandlerOptions,this.sessionDescriptionHandlerModifiers)).then(u=>{const p={contentDisposition:"session",contentType:u.contentType,content:u.body};e.prack({extraHeaders:d,body:p})}).catch(u=>{throw this.stateTransition(S.Terminated),u})}case F.Stable:if(c&&e.prack({extraHeaders:d}),this.earlyMedia&&!this.earlyMediaDialog){this.earlyMediaDialog=i;const l=i.answer;if(!l)throw new Error("Answer is undefined.");const u={sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiers,sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptions};return this.setAnswer(l,u).catch(p=>{throw this.stateTransition(S.Terminated),p})}return Promise.resolve();case F.Closed:return Promise.reject(new Error("Terminated."));default:throw new Error("Unknown session signaling state.")}}onRedirect(e){if(this.logger.log("Inviter.onRedirect"),this.state!==S.Establishing&&this.state!==S.Terminating){this.logger.error(`Redirect received while in state ${this.state}, dropping response`);return}this.stateTransition(S.Terminated)}onReject(e){if(this.logger.log("Inviter.onReject"),this.state!==S.Establishing&&this.state!==S.Terminating){this.logger.error(`Reject received while in state ${this.state}, dropping response`);return}this.stateTransition(S.Terminated)}onTrying(e){if(this.logger.log("Inviter.onTrying"),this.state!==S.Establishing){this.logger.error(`Trying received while in state ${this.state}, dropping response`);return}}}var ie;(function(t){t.Initial="Initial",t.Registered="Registered",t.Unregistered="Unregistered",t.Terminated="Terminated"})(ie=ie||(ie={}));class $t{constructor(e,s={}){this.disposed=!1,this._contacts=[],this._retryAfter=void 0,this._state=ie.Initial,this._waiting=!1,this._stateEventEmitter=new dr,this._waitingEventEmitter=new dr,this.userAgent=e;const r=e.configuration.uri.clone();if(r.user=void 0,this.options=Object.assign(Object.assign(Object.assign({},$t.defaultOptions()),{registrar:r}),$t.stripUndefinedProperties(s)),this.options.extraContactHeaderParams=(this.options.extraContactHeaderParams||[]).slice(),this.options.extraHeaders=(this.options.extraHeaders||[]).slice(),!this.options.registrar)throw new Error("Registrar undefined.");if(this.options.registrar=this.options.registrar.clone(),this.options.regId&&!this.options.instanceId?this.options.instanceId=this.userAgent.instanceId:!this.options.regId&&this.options.instanceId&&(this.options.regId=1),this.options.instanceId&&Pe.parse(this.options.instanceId,"uuid")===-1)throw new Error("Invalid instanceId.");if(this.options.regId&&this.options.regId<0)throw new Error("Invalid regId.");const i=this.options.registrar,n=this.options.params&&this.options.params.fromUri||e.userAgentCore.configuration.aor,o=this.options.params&&this.options.params.toUri||e.configuration.uri,a=this.options.params||{},c=(s.extraHeaders||[]).slice();if(this.request=e.userAgentCore.makeOutgoingRequestMessage(U.REGISTER,i,n,o,a,c,void 0),this.expires=this.options.expires||$t.defaultExpires,this.expires<0)throw new Error("Invalid expires.");if(this.refreshFrequency=this.options.refreshFrequency||$t.defaultRefreshFrequency,this.refreshFrequency<50||this.refreshFrequency>99)throw new Error("Invalid refresh frequency. The value represents a percentage of the expiration time and should be between 50 and 99.");this.logger=e.getLogger("sip.Registerer"),this.options.logConfiguration&&(this.logger.log("Configuration:"),Object.keys(this.options).forEach(d=>{const l=this.options[d];switch(d){case"registrar":this.logger.log("· "+d+": "+l);break;default:this.logger.log("· "+d+": "+JSON.stringify(l))}})),this.id=this.request.callId+this.request.from.parameters.tag,this.userAgent._registerers[this.id]=this}static defaultOptions(){return{expires:$t.defaultExpires,extraContactHeaderParams:[],extraHeaders:[],logConfiguration:!0,instanceId:"",params:{},regId:0,registrar:new It("sip","anonymous","anonymous.invalid"),refreshFrequency:$t.defaultRefreshFrequency}}static stripUndefinedProperties(e){return Object.keys(e).reduce((s,r)=>(e[r]!==void 0&&(s[r]=e[r]),s),{})}get contacts(){return this._contacts.slice()}get retryAfter(){return this._retryAfter}get state(){return this._state}get stateChange(){return this._stateEventEmitter}dispose(){return this.disposed?Promise.resolve():(this.disposed=!0,this.logger.log(`Registerer ${this.id} in state ${this.state} is being disposed`),delete this.userAgent._registerers[this.id],new Promise(e=>{const s=()=>{if(!this.waiting&&this._state===ie.Registered){this.stateChange.addListener(()=>{this.terminated(),e()},{once:!0}),this.unregister();return}this.terminated(),e()};this.waiting?this.waitingChange.addListener(()=>{s()},{once:!0}):s()}))}register(e={}){if(this.state===ie.Terminated)throw this.stateError(),new Error("Registerer terminated. Unable to register.");if(this.disposed)throw this.stateError(),new Error("Registerer disposed. Unable to register.");if(this.waiting){this.waitingWarning();const i=new bn("REGISTER request already in progress, waiting for final response");return Promise.reject(i)}e.requestOptions&&(this.options=Object.assign(Object.assign({},this.options),e.requestOptions));const s=(this.options.extraHeaders||[]).slice();s.push("Contact: "+this.generateContactHeader(this.expires)),s.push("Allow: "+["ACK","CANCEL","INVITE","MESSAGE","BYE","OPTIONS","INFO","NOTIFY","REFER"].toString()),this.request.cseq++,this.request.setHeader("cseq",this.request.cseq+" REGISTER"),this.request.extraHeaders=s,this.waitingToggle(!0);const r=this.userAgent.userAgentCore.register(this.request,{onAccept:i=>{let n;i.message.hasHeader("expires")&&(n=Number(i.message.getHeader("expires"))),this._contacts=i.message.getHeaders("contact");let o=this._contacts.length;if(!o){this.logger.error("No Contact header in response to REGISTER, dropping response."),this.unregistered();return}let a;for(;o--;){if(a=i.message.parseHeader("contact",o),!a)throw new Error("Contact undefined");if(this.userAgent.contact.pubGruu&&Wo(a.uri,this.userAgent.contact.pubGruu)){n=Number(a.getParam("expires"));break}if(this.userAgent.configuration.contactName===""){if(a.uri.user===this.userAgent.contact.uri.user){n=Number(a.getParam("expires"));break}}else if(Wo(a.uri,this.userAgent.contact.uri)){n=Number(a.getParam("expires"));break}a=void 0}if(a===void 0){this.logger.error("No Contact header pointing to us, dropping response"),this.unregistered(),this.waitingToggle(!1);return}if(n===void 0){this.logger.error("Contact pointing to us is missing expires parameter, dropping response"),this.unregistered(),this.waitingToggle(!1);return}if(a.hasParam("temp-gruu")){const c=a.getParam("temp-gruu");c&&(this.userAgent.contact.tempGruu=Pe.URIParse(c.replace(/"/g,"")))}if(a.hasParam("pub-gruu")){const c=a.getParam("pub-gruu");c&&(this.userAgent.contact.pubGruu=Pe.URIParse(c.replace(/"/g,"")))}this.registered(n),e.requestDelegate&&e.requestDelegate.onAccept&&e.requestDelegate.onAccept(i),this.waitingToggle(!1)},onProgress:i=>{e.requestDelegate&&e.requestDelegate.onProgress&&e.requestDelegate.onProgress(i)},onRedirect:i=>{this.logger.error("Redirect received. Not supported."),this.unregistered(),e.requestDelegate&&e.requestDelegate.onRedirect&&e.requestDelegate.onRedirect(i),this.waitingToggle(!1)},onReject:i=>{if(i.message.statusCode===423){if(!i.message.hasHeader("min-expires")){this.logger.error("423 response received for REGISTER without Min-Expires, dropping response"),this.unregistered(),this.waitingToggle(!1);return}this.expires=Number(i.message.getHeader("min-expires")),this.waitingToggle(!1),this.register();return}this.logger.warn(`Failed to register, status code ${i.message.statusCode}`);let n=NaN;if(i.message.statusCode===500||i.message.statusCode===503){const o=i.message.getHeader("retry-after");o&&(n=Number.parseInt(o,void 0))}this._retryAfter=isNaN(n)?void 0:n,this.unregistered(),e.requestDelegate&&e.requestDelegate.onReject&&e.requestDelegate.onReject(i),this._retryAfter=void 0,this.waitingToggle(!1)},onTrying:i=>{e.requestDelegate&&e.requestDelegate.onTrying&&e.requestDelegate.onTrying(i)}});return Promise.resolve(r)}unregister(e={}){if(this.state===ie.Terminated)throw this.stateError(),new Error("Registerer terminated. Unable to register.");if(this.disposed&&this.state!==ie.Registered)throw this.stateError(),new Error("Registerer disposed. Unable to register.");if(this.waiting){this.waitingWarning();const i=new bn("REGISTER request already in progress, waiting for final response");return Promise.reject(i)}this._state!==ie.Registered&&!e.all&&this.logger.warn("Not currently registered, but sending an unregister anyway.");const s=(e.requestOptions&&e.requestOptions.extraHeaders||[]).slice();this.request.extraHeaders=s,e.all?(s.push("Contact: *"),s.push("Expires: 0")):s.push("Contact: "+this.generateContactHeader(0)),this.request.cseq++,this.request.setHeader("cseq",this.request.cseq+" REGISTER"),this.registrationTimer!==void 0&&(clearTimeout(this.registrationTimer),this.registrationTimer=void 0),this.waitingToggle(!0);const r=this.userAgent.userAgentCore.register(this.request,{onAccept:i=>{this._contacts=i.message.getHeaders("contact"),this.unregistered(),e.requestDelegate&&e.requestDelegate.onAccept&&e.requestDelegate.onAccept(i),this.waitingToggle(!1)},onProgress:i=>{e.requestDelegate&&e.requestDelegate.onProgress&&e.requestDelegate.onProgress(i)},onRedirect:i=>{this.logger.error("Unregister redirected. Not currently supported."),this.unregistered(),e.requestDelegate&&e.requestDelegate.onRedirect&&e.requestDelegate.onRedirect(i),this.waitingToggle(!1)},onReject:i=>{this.logger.error(`Unregister rejected with status code ${i.message.statusCode}`),this.unregistered(),e.requestDelegate&&e.requestDelegate.onReject&&e.requestDelegate.onReject(i),this.waitingToggle(!1)},onTrying:i=>{e.requestDelegate&&e.requestDelegate.onTrying&&e.requestDelegate.onTrying(i)}});return Promise.resolve(r)}clearTimers(){this.registrationTimer!==void 0&&(clearTimeout(this.registrationTimer),this.registrationTimer=void 0),this.registrationExpiredTimer!==void 0&&(clearTimeout(this.registrationExpiredTimer),this.registrationExpiredTimer=void 0)}generateContactHeader(e){let s=this.userAgent.contact.toString({register:!0});return this.options.regId&&this.options.instanceId&&(s+=";reg-id="+this.options.regId,s+=';+sip.instance="<urn:uuid:'+this.options.instanceId+'>"'),this.options.extraContactHeaderParams&&this.options.extraContactHeaderParams.forEach(r=>{s+=";"+r}),s+=";expires="+e,s}registered(e){this.clearTimers(),this.registrationTimer=setTimeout(()=>{this.registrationTimer=void 0,this.register()},this.refreshFrequency/100*e*1e3),this.registrationExpiredTimer=setTimeout(()=>{this.logger.warn("Registration expired"),this.unregistered()},e*1e3),this._state!==ie.Registered&&this.stateTransition(ie.Registered)}unregistered(){this.clearTimers(),this._state!==ie.Unregistered&&this.stateTransition(ie.Unregistered)}terminated(){this.clearTimers(),this._state!==ie.Terminated&&this.stateTransition(ie.Terminated)}stateTransition(e){const s=()=>{throw new Error(`Invalid state transition from ${this._state} to ${e}`)};switch(this._state){case ie.Initial:e!==ie.Registered&&e!==ie.Unregistered&&e!==ie.Terminated&&s();break;case ie.Registered:e!==ie.Unregistered&&e!==ie.Terminated&&s();break;case ie.Unregistered:e!==ie.Registered&&e!==ie.Terminated&&s();break;case ie.Terminated:s();break;default:throw new Error("Unrecognized state.")}this._state=e,this.logger.log(`Registration transitioned to state ${this._state}`),this._stateEventEmitter.emit(this._state),e===ie.Terminated&&this.dispose()}get waiting(){return this._waiting}get waitingChange(){return this._waitingEventEmitter}waitingToggle(e){if(this._waiting===e)throw new Error(`Invalid waiting transition from ${this._waiting} to ${e}`);this._waiting=e,this.logger.log(`Waiting toggled to ${this._waiting}`),this._waitingEventEmitter.emit(this._waiting)}waitingWarning(){let e="An attempt was made to send a REGISTER request while a prior one was still in progress.";e+=" RFC 3261 requires UAs MUST NOT send a new registration until they have received a final response",e+=" from the registrar for the previous one or the previous REGISTER request has timed out.",e+=" Note that if the transport disconnects, you still must wait for the prior request to time out before",e+=" sending a new REGISTER request or alternatively dispose of the current Registerer and create a new Registerer.",this.logger.warn(e)}stateError(){let s=`An attempt was made to send a REGISTER request when the Registerer ${this.state===ie.Terminated?"is in 'Terminated' state":"has been disposed"}.`;s+=" The Registerer transitions to 'Terminated' when Registerer.dispose() is called.",s+=" Perhaps you called UserAgent.stop() which dipsoses of all Registerers?",this.logger.error(s)}}$t.defaultExpires=600;$t.defaultRefreshFrequency=99;var ne;(function(t){t.Initial="Initial",t.NotifyWait="NotifyWait",t.Pending="Pending",t.Active="Active",t.Terminated="Terminated"})(ne=ne||(ne={}));var G;(function(t){t.Connecting="Connecting",t.Connected="Connected",t.Disconnecting="Disconnecting",t.Disconnected="Disconnected"})(G=G||(G={}));var qe;(function(t){t.Started="Started",t.Stopped="Stopped"})(qe=qe||(qe={}));class $e{constructor(){this._dataLength=0,this._bufferLength=0,this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashStr(e,s=!1){return this.onePassHasher.start().appendStr(e).end(s)}static hashAsciiStr(e,s=!1){return this.onePassHasher.start().appendAsciiStr(e).end(s)}static _hex(e){const s=$e.hexChars,r=$e.hexOut;let i,n,o,a;for(a=0;a<4;a+=1)for(n=a*8,i=e[a],o=0;o<8;o+=2)r[n+1+o]=s.charAt(i&15),i>>>=4,r[n+0+o]=s.charAt(i&15),i>>>=4;return r.join("")}static _md5cycle(e,s){let r=e[0],i=e[1],n=e[2],o=e[3];r+=(i&n|~i&o)+s[0]-680876936|0,r=(r<<7|r>>>25)+i|0,o+=(r&i|~r&n)+s[1]-389564586|0,o=(o<<12|o>>>20)+r|0,n+=(o&r|~o&i)+s[2]+606105819|0,n=(n<<17|n>>>15)+o|0,i+=(n&o|~n&r)+s[3]-1044525330|0,i=(i<<22|i>>>10)+n|0,r+=(i&n|~i&o)+s[4]-176418897|0,r=(r<<7|r>>>25)+i|0,o+=(r&i|~r&n)+s[5]+1200080426|0,o=(o<<12|o>>>20)+r|0,n+=(o&r|~o&i)+s[6]-1473231341|0,n=(n<<17|n>>>15)+o|0,i+=(n&o|~n&r)+s[7]-45705983|0,i=(i<<22|i>>>10)+n|0,r+=(i&n|~i&o)+s[8]+1770035416|0,r=(r<<7|r>>>25)+i|0,o+=(r&i|~r&n)+s[9]-1958414417|0,o=(o<<12|o>>>20)+r|0,n+=(o&r|~o&i)+s[10]-42063|0,n=(n<<17|n>>>15)+o|0,i+=(n&o|~n&r)+s[11]-1990404162|0,i=(i<<22|i>>>10)+n|0,r+=(i&n|~i&o)+s[12]+1804603682|0,r=(r<<7|r>>>25)+i|0,o+=(r&i|~r&n)+s[13]-40341101|0,o=(o<<12|o>>>20)+r|0,n+=(o&r|~o&i)+s[14]-1502002290|0,n=(n<<17|n>>>15)+o|0,i+=(n&o|~n&r)+s[15]+1236535329|0,i=(i<<22|i>>>10)+n|0,r+=(i&o|n&~o)+s[1]-165796510|0,r=(r<<5|r>>>27)+i|0,o+=(r&n|i&~n)+s[6]-1069501632|0,o=(o<<9|o>>>23)+r|0,n+=(o&i|r&~i)+s[11]+643717713|0,n=(n<<14|n>>>18)+o|0,i+=(n&r|o&~r)+s[0]-373897302|0,i=(i<<20|i>>>12)+n|0,r+=(i&o|n&~o)+s[5]-701558691|0,r=(r<<5|r>>>27)+i|0,o+=(r&n|i&~n)+s[10]+38016083|0,o=(o<<9|o>>>23)+r|0,n+=(o&i|r&~i)+s[15]-660478335|0,n=(n<<14|n>>>18)+o|0,i+=(n&r|o&~r)+s[4]-405537848|0,i=(i<<20|i>>>12)+n|0,r+=(i&o|n&~o)+s[9]+568446438|0,r=(r<<5|r>>>27)+i|0,o+=(r&n|i&~n)+s[14]-1019803690|0,o=(o<<9|o>>>23)+r|0,n+=(o&i|r&~i)+s[3]-187363961|0,n=(n<<14|n>>>18)+o|0,i+=(n&r|o&~r)+s[8]+1163531501|0,i=(i<<20|i>>>12)+n|0,r+=(i&o|n&~o)+s[13]-1444681467|0,r=(r<<5|r>>>27)+i|0,o+=(r&n|i&~n)+s[2]-51403784|0,o=(o<<9|o>>>23)+r|0,n+=(o&i|r&~i)+s[7]+1735328473|0,n=(n<<14|n>>>18)+o|0,i+=(n&r|o&~r)+s[12]-1926607734|0,i=(i<<20|i>>>12)+n|0,r+=(i^n^o)+s[5]-378558|0,r=(r<<4|r>>>28)+i|0,o+=(r^i^n)+s[8]-2022574463|0,o=(o<<11|o>>>21)+r|0,n+=(o^r^i)+s[11]+1839030562|0,n=(n<<16|n>>>16)+o|0,i+=(n^o^r)+s[14]-35309556|0,i=(i<<23|i>>>9)+n|0,r+=(i^n^o)+s[1]-1530992060|0,r=(r<<4|r>>>28)+i|0,o+=(r^i^n)+s[4]+1272893353|0,o=(o<<11|o>>>21)+r|0,n+=(o^r^i)+s[7]-155497632|0,n=(n<<16|n>>>16)+o|0,i+=(n^o^r)+s[10]-1094730640|0,i=(i<<23|i>>>9)+n|0,r+=(i^n^o)+s[13]+681279174|0,r=(r<<4|r>>>28)+i|0,o+=(r^i^n)+s[0]-358537222|0,o=(o<<11|o>>>21)+r|0,n+=(o^r^i)+s[3]-722521979|0,n=(n<<16|n>>>16)+o|0,i+=(n^o^r)+s[6]+76029189|0,i=(i<<23|i>>>9)+n|0,r+=(i^n^o)+s[9]-640364487|0,r=(r<<4|r>>>28)+i|0,o+=(r^i^n)+s[12]-421815835|0,o=(o<<11|o>>>21)+r|0,n+=(o^r^i)+s[15]+530742520|0,n=(n<<16|n>>>16)+o|0,i+=(n^o^r)+s[2]-995338651|0,i=(i<<23|i>>>9)+n|0,r+=(n^(i|~o))+s[0]-198630844|0,r=(r<<6|r>>>26)+i|0,o+=(i^(r|~n))+s[7]+1126891415|0,o=(o<<10|o>>>22)+r|0,n+=(r^(o|~i))+s[14]-1416354905|0,n=(n<<15|n>>>17)+o|0,i+=(o^(n|~r))+s[5]-57434055|0,i=(i<<21|i>>>11)+n|0,r+=(n^(i|~o))+s[12]+1700485571|0,r=(r<<6|r>>>26)+i|0,o+=(i^(r|~n))+s[3]-1894986606|0,o=(o<<10|o>>>22)+r|0,n+=(r^(o|~i))+s[10]-1051523|0,n=(n<<15|n>>>17)+o|0,i+=(o^(n|~r))+s[1]-2054922799|0,i=(i<<21|i>>>11)+n|0,r+=(n^(i|~o))+s[8]+1873313359|0,r=(r<<6|r>>>26)+i|0,o+=(i^(r|~n))+s[15]-30611744|0,o=(o<<10|o>>>22)+r|0,n+=(r^(o|~i))+s[6]-1560198380|0,n=(n<<15|n>>>17)+o|0,i+=(o^(n|~r))+s[13]+1309151649|0,i=(i<<21|i>>>11)+n|0,r+=(n^(i|~o))+s[4]-145523070|0,r=(r<<6|r>>>26)+i|0,o+=(i^(r|~n))+s[11]-1120210379|0,o=(o<<10|o>>>22)+r|0,n+=(r^(o|~i))+s[2]+718787259|0,n=(n<<15|n>>>17)+o|0,i+=(o^(n|~r))+s[9]-343485551|0,i=(i<<21|i>>>11)+n|0,e[0]=r+e[0]|0,e[1]=i+e[1]|0,e[2]=n+e[2]|0,e[3]=o+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set($e.stateIdentity),this}appendStr(e){const s=this._buffer8,r=this._buffer32;let i=this._bufferLength,n,o;for(o=0;o<e.length;o+=1){if(n=e.charCodeAt(o),n<128)s[i++]=n;else if(n<2048)s[i++]=(n>>>6)+192,s[i++]=n&63|128;else if(n<55296||n>56319)s[i++]=(n>>>12)+224,s[i++]=n>>>6&63|128,s[i++]=n&63|128;else{if(n=(n-55296)*1024+(e.charCodeAt(++o)-56320)+65536,n>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");s[i++]=(n>>>18)+240,s[i++]=n>>>12&63|128,s[i++]=n>>>6&63|128,s[i++]=n&63|128}i>=64&&(this._dataLength+=64,$e._md5cycle(this._state,r),i-=64,r[0]=r[16])}return this._bufferLength=i,this}appendAsciiStr(e){const s=this._buffer8,r=this._buffer32;let i=this._bufferLength,n,o=0;for(;;){for(n=Math.min(e.length-o,64-i);n--;)s[i++]=e.charCodeAt(o++);if(i<64)break;this._dataLength+=64,$e._md5cycle(this._state,r),i=0}return this._bufferLength=i,this}appendByteArray(e){const s=this._buffer8,r=this._buffer32;let i=this._bufferLength,n,o=0;for(;;){for(n=Math.min(e.length-o,64-i);n--;)s[i++]=e[o++];if(i<64)break;this._dataLength+=64,$e._md5cycle(this._state,r),i=0}return this._bufferLength=i,this}getState(){const e=this,s=e._state;return{buffer:String.fromCharCode.apply(null,e._buffer8),buflen:e._bufferLength,length:e._dataLength,state:[s[0],s[1],s[2],s[3]]}}setState(e){const s=e.buffer,r=e.state,i=this._state;let n;for(this._dataLength=e.length,this._bufferLength=e.buflen,i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],n=0;n<s.length;n+=1)this._buffer8[n]=s.charCodeAt(n)}end(e=!1){const s=this._bufferLength,r=this._buffer8,i=this._buffer32,n=(s>>2)+1;let o;if(this._dataLength+=s,r[s]=128,r[s+1]=r[s+2]=r[s+3]=0,i.set($e.buffer32Identity.subarray(n),n),s>55&&($e._md5cycle(this._state,i),i.set($e.buffer32Identity)),o=this._dataLength*8,o<=4294967295)i[14]=o;else{const a=o.toString(16).match(/(.*?)(.{0,8})$/);if(a===null)return;const c=parseInt(a[2],16),d=parseInt(a[1],16)||0;i[14]=c,i[15]=d}return $e._md5cycle(this._state,i),e?this._state:$e._hex(this._state)}}$e.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]);$e.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);$e.hexChars="0123456789abcdef";$e.hexOut=[];$e.onePassHasher=new $e;$e.hashStr("hello")!=="5d41402abc4b2a76b9719d911017c592"&&console.error("Md5 self test failed.");function Wt(t){return $e.hashStr(t)}class $f{constructor(e,s,r,i){this.logger=e.getLogger("sipjs.digestauthentication"),this.username=r,this.password=i,this.ha1=s,this.nc=0,this.ncHex="00000000"}authenticate(e,s,r){if(this.algorithm=s.algorithm,this.realm=s.realm,this.nonce=s.nonce,this.opaque=s.opaque,this.stale=s.stale,this.algorithm){if(this.algorithm!=="MD5")return this.logger.warn("challenge with Digest algorithm different than 'MD5', authentication aborted"),!1}else this.algorithm="MD5";if(!this.realm)return this.logger.warn("challenge without Digest realm, authentication aborted"),!1;if(!this.nonce)return this.logger.warn("challenge without Digest nonce, authentication aborted"),!1;if(s.qop)if(s.qop.indexOf("auth")>-1)this.qop="auth";else if(s.qop.indexOf("auth-int")>-1)this.qop="auth-int";else return this.logger.warn("challenge without Digest qop different than 'auth' or 'auth-int', authentication aborted"),!1;else this.qop=void 0;return this.method=e.method,this.uri=e.ruri,this.cnonce=gs(12),this.nc+=1,this.updateNcHex(),this.nc===4294967296&&(this.nc=1,this.ncHex="00000001"),this.calculateResponse(r),!0}toString(){const e=[];if(!this.response)throw new Error("response field does not exist, cannot generate Authorization header");return e.push("algorithm="+this.algorithm),e.push('username="'+this.username+'"'),e.push('realm="'+this.realm+'"'),e.push('nonce="'+this.nonce+'"'),e.push('uri="'+this.uri+'"'),e.push('response="'+this.response+'"'),this.opaque&&e.push('opaque="'+this.opaque+'"'),this.qop&&(e.push("qop="+this.qop),e.push('cnonce="'+this.cnonce+'"'),e.push("nc="+this.ncHex)),"Digest "+e.join(", ")}updateNcHex(){const e=Number(this.nc).toString(16);this.ncHex="00000000".substr(0,8-e.length)+e}calculateResponse(e){let s,r;s=this.ha1,(s===""||s===void 0)&&(s=Wt(this.username+":"+this.realm+":"+this.password)),this.qop==="auth"?(r=Wt(this.method+":"+this.uri),this.response=Wt(s+":"+this.nonce+":"+this.ncHex+":"+this.cnonce+":auth:"+r)):this.qop==="auth-int"?(r=Wt(this.method+":"+this.uri+":"+Wt(e||"")),this.response=Wt(s+":"+this.nonce+":"+this.ncHex+":"+this.cnonce+":auth-int:"+r)):this.qop===void 0&&(r=Wt(this.method+":"+this.uri),this.response=Wt(s+":"+this.nonce+":"+r))}}var Le;(function(t){t[t.error=0]="error",t[t.warn=1]="warn",t[t.log=2]="log",t[t.debug=3]="debug"})(Le=Le||(Le={}));class Yo{constructor(e,s,r){this.logger=e,this.category=s,this.label=r}error(e){this.genericLog(Le.error,e)}warn(e){this.genericLog(Le.warn,e)}log(e){this.genericLog(Le.log,e)}debug(e){this.genericLog(Le.debug,e)}genericLog(e,s){this.logger.genericLog(e,this.category,this.label,s)}get level(){return this.logger.level}set level(e){this.logger.level=e}}class Af{constructor(){this.builtinEnabled=!0,this._level=Le.log,this.loggers={},this.logger=this.getLogger("sip:loggerfactory")}get level(){return this._level}set level(e){e>=0&&e<=3?this._level=e:e>3?this._level=3:Le.hasOwnProperty(e)?this._level=e:this.logger.error("invalid 'level' parameter value: "+JSON.stringify(e))}get connector(){return this._connector}set connector(e){e?typeof e=="function"?this._connector=e:this.logger.error("invalid 'connector' parameter value: "+JSON.stringify(e)):this._connector=void 0}getLogger(e,s){if(s&&this.level===3)return new Yo(this,e,s);if(this.loggers[e])return this.loggers[e];{const r=new Yo(this,e);return this.loggers[e]=r,r}}genericLog(e,s,r,i){this.level>=e&&this.builtinEnabled&&this.print(e,s,r,i),this.connector&&this.connector(Le[e],s,r,i)}print(e,s,r,i){if(typeof i=="string"){const n=[new Date,s];r&&n.push(r),i=n.concat(i).join(" | ")}switch(e){case Le.error:console.error(i);break;case Le.warn:console.warn(i);break;case Le.log:console.log(i);break;case Le.debug:console.debug(i);break}}}var Mr;(function(t){function e(i,n){let o=n,a=0,c=0;if(i.substring(o,o+2).match(/(^\r\n)/))return-2;for(;a===0;){if(c=i.indexOf(`\r
`,o),c===-1)return c;!i.substring(c+2,c+4).match(/(^\r\n)/)&&i.charAt(c+2).match(/(^\s+)/)?o=c+2:a=c}return a}t.getHeader=e;function s(i,n,o,a){const c=n.indexOf(":",o),d=n.substring(o,c).trim(),l=n.substring(c+1,a).trim();let u;switch(d.toLowerCase()){case"via":case"v":i.addHeader("via",l),i.getHeaders("via").length===1?(u=i.parseHeader("Via"),u&&(i.via=u,i.viaBranch=u.branch)):u=0;break;case"from":case"f":i.setHeader("from",l),u=i.parseHeader("from"),u&&(i.from=u,i.fromTag=u.getParam("tag"));break;case"to":case"t":i.setHeader("to",l),u=i.parseHeader("to"),u&&(i.to=u,i.toTag=u.getParam("tag"));break;case"record-route":if(u=Pe.parse(l,"Record_Route"),u===-1){u=void 0;break}if(!(u instanceof Array)){u=void 0;break}u.forEach(p=>{i.addHeader("record-route",l.substring(p.position,p.offset)),i.headers["Record-Route"][i.getHeaders("record-route").length-1].parsed=p.parsed});break;case"call-id":case"i":i.setHeader("call-id",l),u=i.parseHeader("call-id"),u&&(i.callId=l);break;case"contact":case"m":if(u=Pe.parse(l,"Contact"),u===-1){u=void 0;break}if(!(u instanceof Array)){u=void 0;break}u.forEach(p=>{i.addHeader("contact",l.substring(p.position,p.offset)),i.headers.Contact[i.getHeaders("contact").length-1].parsed=p.parsed});break;case"content-length":case"l":i.setHeader("content-length",l),u=i.parseHeader("content-length");break;case"content-type":case"c":i.setHeader("content-type",l),u=i.parseHeader("content-type");break;case"cseq":i.setHeader("cseq",l),u=i.parseHeader("cseq"),u&&(i.cseq=u.value),i instanceof ss&&(i.method=u.method);break;case"max-forwards":i.setHeader("max-forwards",l),u=i.parseHeader("max-forwards");break;case"www-authenticate":i.setHeader("www-authenticate",l),u=i.parseHeader("www-authenticate");break;case"proxy-authenticate":i.setHeader("proxy-authenticate",l),u=i.parseHeader("proxy-authenticate");break;case"refer-to":case"r":i.setHeader("refer-to",l),u=i.parseHeader("refer-to"),u&&(i.referTo=u);break;default:i.addHeader(d.toLowerCase(),l),u=0}return u===void 0?{error:"error parsing header '"+d+"'"}:!0}t.parseHeader=s;function r(i,n){let o=0,a=i.indexOf(`\r
`);if(a===-1){n.warn("no CRLF found, not a SIP message, discarded");return}const c=i.substring(0,a),d=Pe.parse(c,"Request_Response");let l;if(d===-1){n.warn('error parsing first line of SIP message: "'+c+'"');return}else d.status_code?(l=new ss,l.statusCode=d.status_code,l.reasonPhrase=d.reason_phrase):(l=new Ps,l.method=d.method,l.ruri=d.uri);l.data=i,o=a+2;let u;for(;;){if(a=e(i,o),a===-2){u=o+2;break}else if(a===-1){n.error("malformed message");return}const p=s(l,i,o,a);if(p&&p!==!0){n.error(p.error);return}o=a+2}return l.hasHeader("content-length")?l.body=i.substr(u,Number(l.getHeader("content-length"))):l.body=i.substring(u),l}t.parseMessage=r})(Mr=Mr||(Mr={}));function Yc(t,e){const s=`\r
`;if(e.statusCode<100||e.statusCode>699)throw new TypeError("Invalid statusCode: "+e.statusCode);const r=e.reasonPhrase?e.reasonPhrase:xi(e.statusCode);let i="SIP/2.0 "+e.statusCode+" "+r+s;e.statusCode>=100&&e.statusCode<200,e.statusCode;const n="From: "+t.getHeader("From")+s,o="Call-ID: "+t.callId+s,a="CSeq: "+t.cseq+" "+t.method+s,c=t.getHeaders("via").reduce((y,w)=>y+"Via: "+w+s,"");let d="To: "+t.getHeader("to");if(e.statusCode>100&&!t.parseHeader("to").hasParam("tag")){let y=e.toTag;y||(y=Ci()),d+=";tag="+y}d+=s;let l="";e.supported&&(l="Supported: "+e.supported.join(", ")+s);let u="";e.userAgent&&(u="User-Agent: "+e.userAgent+s);let p="";return e.extraHeaders&&(p=e.extraHeaders.reduce((y,w)=>y+w.trim()+s,"")),i+=c,i+=n,i+=d,i+=a,i+=o,i+=l,i+=u,i+=p,e.body?(i+="Content-Type: "+e.body.contentType+s,i+="Content-Length: "+ur(e.body.content)+s+s,i+=e.body.content):i+="Content-Length: 0"+s+s,{message:i}}class Wi extends xs{constructor(e){super(e||"Unspecified transport error.")}}class Kc{constructor(e,s,r,i,n){this._transport=e,this._user=s,this._id=r,this._state=i,this.listeners=new Array,this.logger=s.loggerFactory.getLogger(n,r),this.logger.debug(`Constructing ${this.typeToString()} with id ${this.id}.`)}dispose(){this.logger.debug(`Destroyed ${this.typeToString()} with id ${this.id}.`)}get id(){return this._id}get kind(){throw new Error("Invalid kind.")}get state(){return this._state}get transport(){return this._transport}addStateChangeListener(e,s){const r=()=>{this.removeStateChangeListener(r),e()};(s==null?void 0:s.once)===!0?this.listeners.push(r):this.listeners.push(e)}notifyStateChangeListeners(){this.listeners.slice().forEach(e=>e())}removeStateChangeListener(e){this.listeners=this.listeners.filter(s=>s!==e)}logTransportError(e,s){this.logger.error(e.message),this.logger.error(`Transport error occurred in ${this.typeToString()} with id ${this.id}.`),this.logger.error(s)}send(e){return this.transport.send(e).catch(s=>{if(s instanceof Wi)throw this.onTransportError(s),s;let r;throw s&&typeof s.message=="string"?r=new Wi(s.message):r=new Wi,this.onTransportError(r),r})}setState(e){this.logger.debug(`State change to "${e}" on ${this.typeToString()} with id ${this.id}.`),this._state=e,this._user.onStateChange&&this._user.onStateChange(e),this.notifyStateChangeListeners()}typeToString(){return"UnknownType"}}class Gc extends Kc{constructor(e,s,r,i,n){super(s,r,e.viaBranch,i,n),this._request=e,this.user=r}get request(){return this._request}}var E;(function(t){t.Accepted="Accepted",t.Calling="Calling",t.Completed="Completed",t.Confirmed="Confirmed",t.Proceeding="Proceeding",t.Terminated="Terminated",t.Trying="Trying"})(E=E||(E={}));class Qe extends Gc{constructor(e,s,r){super(e,s,r,E.Proceeding,"sip.transaction.ist")}dispose(){this.stopProgressExtensionTimer(),this.H&&(clearTimeout(this.H),this.H=void 0),this.I&&(clearTimeout(this.I),this.I=void 0),this.L&&(clearTimeout(this.L),this.L=void 0),super.dispose()}get kind(){return"ist"}receiveRequest(e){switch(this.state){case E.Proceeding:if(e.method===U.INVITE){this.lastProvisionalResponse&&this.send(this.lastProvisionalResponse).catch(r=>{this.logTransportError(r,"Failed to send retransmission of provisional response.")});return}break;case E.Accepted:if(e.method===U.INVITE)return;break;case E.Completed:if(e.method===U.INVITE){if(!this.lastFinalResponse)throw new Error("Last final response undefined.");this.send(this.lastFinalResponse).catch(r=>{this.logTransportError(r,"Failed to send retransmission of final response.")});return}if(e.method===U.ACK){this.stateTransition(E.Confirmed);return}break;case E.Confirmed:if(e.method===U.INVITE||e.method===U.ACK)return;break;case E.Terminated:if(e.method===U.INVITE||e.method===U.ACK)return;break;default:throw new Error(`Invalid state ${this.state}`)}const s=`INVITE server transaction received unexpected ${e.method} request while in state ${this.state}.`;this.logger.warn(s)}receiveResponse(e,s){if(e<100||e>699)throw new Error(`Invalid status code ${e}`);switch(this.state){case E.Proceeding:if(e>=100&&e<=199){this.lastProvisionalResponse=s,e>100&&this.startProgressExtensionTimer(),this.send(s).catch(i=>{this.logTransportError(i,"Failed to send 1xx response.")});return}if(e>=200&&e<=299){this.lastFinalResponse=s,this.stateTransition(E.Accepted),this.send(s).catch(i=>{this.logTransportError(i,"Failed to send 2xx response.")});return}if(e>=300&&e<=699){this.lastFinalResponse=s,this.stateTransition(E.Completed),this.send(s).catch(i=>{this.logTransportError(i,"Failed to send non-2xx final response.")});return}break;case E.Accepted:if(e>=200&&e<=299){this.send(s).catch(i=>{this.logTransportError(i,"Failed to send 2xx response.")});return}break;case E.Completed:break;case E.Confirmed:break;case E.Terminated:break;default:throw new Error(`Invalid state ${this.state}`)}const r=`INVITE server transaction received unexpected ${e} response from TU while in state ${this.state}.`;throw this.logger.error(r),new Error(r)}retransmitAcceptedResponse(){this.state===E.Accepted&&this.lastFinalResponse&&this.send(this.lastFinalResponse).catch(e=>{this.logTransportError(e,"Failed to send 2xx response.")})}onTransportError(e){this.user.onTransportError&&this.user.onTransportError(e)}typeToString(){return"INVITE server transaction"}stateTransition(e){const s=()=>{throw new Error(`Invalid state transition from ${this.state} to ${e}`)};switch(e){case E.Proceeding:s();break;case E.Accepted:case E.Completed:this.state!==E.Proceeding&&s();break;case E.Confirmed:this.state!==E.Completed&&s();break;case E.Terminated:this.state!==E.Accepted&&this.state!==E.Completed&&this.state!==E.Confirmed&&s();break;default:s()}this.stopProgressExtensionTimer(),e===E.Accepted&&(this.L=setTimeout(()=>this.timerL(),Fe.TIMER_L)),e===E.Completed&&(this.H=setTimeout(()=>this.timerH(),Fe.TIMER_H)),e===E.Confirmed&&(this.I=setTimeout(()=>this.timerI(),Fe.TIMER_I)),e===E.Terminated&&this.dispose(),this.setState(e)}startProgressExtensionTimer(){this.progressExtensionTimer===void 0&&(this.progressExtensionTimer=setInterval(()=>{if(this.logger.debug(`Progress extension timer expired for INVITE server transaction ${this.id}.`),!this.lastProvisionalResponse)throw new Error("Last provisional response undefined.");this.send(this.lastProvisionalResponse).catch(e=>{this.logTransportError(e,"Failed to send retransmission of provisional response.")})},Fe.PROVISIONAL_RESPONSE_INTERVAL))}stopProgressExtensionTimer(){this.progressExtensionTimer!==void 0&&(clearInterval(this.progressExtensionTimer),this.progressExtensionTimer=void 0)}timerG(){}timerH(){this.logger.debug(`Timer H expired for INVITE server transaction ${this.id}.`),this.state===E.Completed&&(this.logger.warn("ACK to negative final response was never received, terminating transaction."),this.stateTransition(E.Terminated))}timerI(){this.logger.debug(`Timer I expired for INVITE server transaction ${this.id}.`),this.stateTransition(E.Terminated)}timerL(){this.logger.debug(`Timer L expired for INVITE server transaction ${this.id}.`),this.state===E.Accepted&&this.stateTransition(E.Terminated)}}class Ti extends Kc{constructor(e,s,r,i,n){super(s,r,Ti.makeId(e),i,n),this._request=e,this.user=r,e.setViaHeader(this.id,s.protocol)}static makeId(e){if(e.method==="CANCEL"){if(!e.branch)throw new Error("Outgoing CANCEL request without a branch.");return e.branch}else return"z9hG4bK"+Math.floor(Math.random()*1e7)}get request(){return this._request}onRequestTimeout(){this.user.onRequestTimeout&&this.user.onRequestTimeout()}}class lt extends Ti{constructor(e,s,r){super(e,s,r,E.Trying,"sip.transaction.nict"),this.F=setTimeout(()=>this.timerF(),Fe.TIMER_F),this.send(e.toString()).catch(i=>{this.logTransportError(i,"Failed to send initial outgoing request.")})}dispose(){this.F&&(clearTimeout(this.F),this.F=void 0),this.K&&(clearTimeout(this.K),this.K=void 0),super.dispose()}get kind(){return"nict"}receiveResponse(e){const s=e.statusCode;if(!s||s<100||s>699)throw new Error(`Invalid status code ${s}`);switch(this.state){case E.Trying:if(s>=100&&s<=199){this.stateTransition(E.Proceeding),this.user.receiveResponse&&this.user.receiveResponse(e);return}if(s>=200&&s<=699){if(this.stateTransition(E.Completed),s===408){this.onRequestTimeout();return}this.user.receiveResponse&&this.user.receiveResponse(e);return}break;case E.Proceeding:if(s>=100&&s<=199&&this.user.receiveResponse)return this.user.receiveResponse(e);if(s>=200&&s<=699){if(this.stateTransition(E.Completed),s===408){this.onRequestTimeout();return}this.user.receiveResponse&&this.user.receiveResponse(e);return}break;case E.Completed:return;case E.Terminated:return;default:throw new Error(`Invalid state ${this.state}`)}const r=`Non-INVITE client transaction received unexpected ${s} response while in state ${this.state}.`;this.logger.warn(r)}onTransportError(e){this.user.onTransportError&&this.user.onTransportError(e),this.stateTransition(E.Terminated,!0)}typeToString(){return"non-INVITE client transaction"}stateTransition(e,s=!1){const r=()=>{throw new Error(`Invalid state transition from ${this.state} to ${e}`)};switch(e){case E.Trying:r();break;case E.Proceeding:this.state!==E.Trying&&r();break;case E.Completed:this.state!==E.Trying&&this.state!==E.Proceeding&&r();break;case E.Terminated:this.state!==E.Trying&&this.state!==E.Proceeding&&this.state!==E.Completed&&(s||r());break;default:r()}e===E.Completed&&(this.F&&(clearTimeout(this.F),this.F=void 0),this.K=setTimeout(()=>this.timerK(),Fe.TIMER_K)),e===E.Terminated&&this.dispose(),this.setState(e)}timerF(){this.logger.debug(`Timer F expired for non-INVITE client transaction ${this.id}.`),(this.state===E.Trying||this.state===E.Proceeding)&&(this.onRequestTimeout(),this.stateTransition(E.Terminated))}timerK(){this.state===E.Completed&&this.stateTransition(E.Terminated)}}class Ls{constructor(e,s){this.core=e,this.dialogState=s,this.core.dialogs.set(this.id,this)}static initialDialogStateForUserAgentClient(e,s){const i=s.getHeaders("record-route").reverse(),n=s.parseHeader("contact");if(!n)throw new Error("Contact undefined.");if(!(n instanceof Je))throw new Error("Contact not instance of NameAddrHeader.");const o=n.uri,a=e.cseq,c=void 0,d=e.callId,l=e.fromTag,u=s.toTag;if(!d)throw new Error("Call id undefined.");if(!l)throw new Error("From tag undefined.");if(!u)throw new Error("To tag undefined.");if(!e.from)throw new Error("From undefined.");if(!e.to)throw new Error("To undefined.");const p=e.from.uri,y=e.to.uri;if(!s.statusCode)throw new Error("Incoming response status code undefined.");const w=s.statusCode<200;return{id:d+l+u,early:w,callId:d,localTag:l,remoteTag:u,localSequenceNumber:a,remoteSequenceNumber:c,localURI:p,remoteURI:y,remoteTarget:o,routeSet:i,secure:!1}}static initialDialogStateForUserAgentServer(e,s,r=!1){const n=e.getHeaders("record-route"),o=e.parseHeader("contact");if(!o)throw new Error("Contact undefined.");if(!(o instanceof Je))throw new Error("Contact not instance of NameAddrHeader.");const a=o.uri,c=e.cseq,d=void 0,l=e.callId,u=s,p=e.fromTag,y=e.from.uri,w=e.to.uri;return{id:l+u+p,early:r,callId:l,localTag:u,remoteTag:p,localSequenceNumber:d,remoteSequenceNumber:c,localURI:w,remoteURI:y,remoteTarget:a,routeSet:n,secure:!1}}dispose(){this.core.dialogs.delete(this.id)}get id(){return this.dialogState.id}get early(){return this.dialogState.early}get callId(){return this.dialogState.callId}get localTag(){return this.dialogState.localTag}get remoteTag(){return this.dialogState.remoteTag}get localSequenceNumber(){return this.dialogState.localSequenceNumber}get remoteSequenceNumber(){return this.dialogState.remoteSequenceNumber}get localURI(){return this.dialogState.localURI}get remoteURI(){return this.dialogState.remoteURI}get remoteTarget(){return this.dialogState.remoteTarget}get routeSet(){return this.dialogState.routeSet}get secure(){return this.dialogState.secure}get userAgentCore(){return this.core}confirm(){this.dialogState.early=!1}receiveRequest(e){if(e.method!==U.ACK){if(this.remoteSequenceNumber){if(e.cseq<=this.remoteSequenceNumber)throw new Error("Out of sequence in dialog request. Did you forget to call sequenceGuard()?");this.dialogState.remoteSequenceNumber=e.cseq}this.remoteSequenceNumber||(this.dialogState.remoteSequenceNumber=e.cseq)}}recomputeRouteSet(e){this.dialogState.routeSet=e.getHeaders("record-route").reverse()}createOutgoingRequestMessage(e,s){const r=this.remoteURI,i=this.remoteTag,n=this.localURI,o=this.localTag,a=this.callId;let c;s&&s.cseq?c=s.cseq:this.dialogState.localSequenceNumber?c=this.dialogState.localSequenceNumber+=1:c=this.dialogState.localSequenceNumber=1;const d=this.remoteTarget,l=this.routeSet,u=s&&s.extraHeaders,p=s&&s.body;return this.userAgentCore.makeOutgoingRequestMessage(e,d,n,r,{callId:a,cseq:c,fromTag:o,toTag:i,routeSet:l},u,p)}incrementLocalSequenceNumber(){if(!this.dialogState.localSequenceNumber)throw new Error("Local sequence number undefined.");this.dialogState.localSequenceNumber+=1}sequenceGuard(e){return e.method===U.ACK?!0:this.remoteSequenceNumber&&e.cseq<=this.remoteSequenceNumber?(this.core.replyStateless(e,{statusCode:500}),!1):!0}}class Jt extends Ti{constructor(e,s,r){super(e,s,r,E.Calling,"sip.transaction.ict"),this.ackRetransmissionCache=new Map,this.B=setTimeout(()=>this.timerB(),Fe.TIMER_B),this.send(e.toString()).catch(i=>{this.logTransportError(i,"Failed to send initial outgoing request.")})}dispose(){this.B&&(clearTimeout(this.B),this.B=void 0),this.D&&(clearTimeout(this.D),this.D=void 0),this.M&&(clearTimeout(this.M),this.M=void 0),super.dispose()}get kind(){return"ict"}ackResponse(e){const s=e.toTag;if(!s)throw new Error("To tag undefined.");const r="z9hG4bK"+Math.floor(Math.random()*1e7);e.setViaHeader(r,this.transport.protocol),this.ackRetransmissionCache.set(s,e),this.send(e.toString()).catch(i=>{this.logTransportError(i,"Failed to send ACK to 2xx response.")})}receiveResponse(e){const s=e.statusCode;if(!s||s<100||s>699)throw new Error(`Invalid status code ${s}`);switch(this.state){case E.Calling:if(s>=100&&s<=199){this.stateTransition(E.Proceeding),this.user.receiveResponse&&this.user.receiveResponse(e);return}if(s>=200&&s<=299){this.ackRetransmissionCache.set(e.toTag,void 0),this.stateTransition(E.Accepted),this.user.receiveResponse&&this.user.receiveResponse(e);return}if(s>=300&&s<=699){this.stateTransition(E.Completed),this.ack(e),this.user.receiveResponse&&this.user.receiveResponse(e);return}break;case E.Proceeding:if(s>=100&&s<=199){this.user.receiveResponse&&this.user.receiveResponse(e);return}if(s>=200&&s<=299){this.ackRetransmissionCache.set(e.toTag,void 0),this.stateTransition(E.Accepted),this.user.receiveResponse&&this.user.receiveResponse(e);return}if(s>=300&&s<=699){this.stateTransition(E.Completed),this.ack(e),this.user.receiveResponse&&this.user.receiveResponse(e);return}break;case E.Accepted:if(s>=200&&s<=299){if(!this.ackRetransmissionCache.has(e.toTag)){this.ackRetransmissionCache.set(e.toTag,void 0),this.user.receiveResponse&&this.user.receiveResponse(e);return}const i=this.ackRetransmissionCache.get(e.toTag);if(i){this.send(i.toString()).catch(n=>{this.logTransportError(n,"Failed to send retransmission of ACK to 2xx response.")});return}return}break;case E.Completed:if(s>=300&&s<=699){this.ack(e);return}break;case E.Terminated:break;default:throw new Error(`Invalid state ${this.state}`)}const r=`Received unexpected ${s} response while in state ${this.state}.`;this.logger.warn(r)}onTransportError(e){this.user.onTransportError&&this.user.onTransportError(e),this.stateTransition(E.Terminated,!0)}typeToString(){return"INVITE client transaction"}ack(e){const s=this.request.ruri,r=this.request.callId,i=this.request.cseq,n=this.request.getHeader("from"),o=e.getHeader("to"),a=this.request.getHeader("via"),c=this.request.getHeader("route");if(!n)throw new Error("From undefined.");if(!o)throw new Error("To undefined.");if(!a)throw new Error("Via undefined.");let d=`ACK ${s} SIP/2.0\r
`;c&&(d+=`Route: ${c}\r
`),d+=`Via: ${a}\r
`,d+=`To: ${o}\r
`,d+=`From: ${n}\r
`,d+=`Call-ID: ${r}\r
`,d+=`CSeq: ${i} ACK\r
`,d+=`Max-Forwards: 70\r
`,d+=`Content-Length: 0\r
\r
`,this.send(d).catch(l=>{this.logTransportError(l,"Failed to send ACK to non-2xx response.")})}stateTransition(e,s=!1){const r=()=>{throw new Error(`Invalid state transition from ${this.state} to ${e}`)};switch(e){case E.Calling:r();break;case E.Proceeding:this.state!==E.Calling&&r();break;case E.Accepted:case E.Completed:this.state!==E.Calling&&this.state!==E.Proceeding&&r();break;case E.Terminated:this.state!==E.Calling&&this.state!==E.Accepted&&this.state!==E.Completed&&(s||r());break;default:r()}this.B&&(clearTimeout(this.B),this.B=void 0),E.Proceeding,e===E.Completed&&(this.D=setTimeout(()=>this.timerD(),Fe.TIMER_D)),e===E.Accepted&&(this.M=setTimeout(()=>this.timerM(),Fe.TIMER_M)),e===E.Terminated&&this.dispose(),this.setState(e)}timerA(){}timerB(){this.logger.debug(`Timer B expired for INVITE client transaction ${this.id}.`),this.state===E.Calling&&(this.onRequestTimeout(),this.stateTransition(E.Terminated))}timerD(){this.logger.debug(`Timer D expired for INVITE client transaction ${this.id}.`),this.state===E.Completed&&this.stateTransition(E.Terminated)}timerM(){this.logger.debug(`Timer M expired for INVITE client transaction ${this.id}.`),this.state===E.Accepted&&this.stateTransition(E.Terminated)}}class We{constructor(e,s,r,i){this.transactionConstructor=e,this.core=s,this.message=r,this.delegate=i,this.challenged=!1,this.stale=!1,this.logger=this.loggerFactory.getLogger("sip.user-agent-client"),this.init()}dispose(){this.transaction.dispose()}get loggerFactory(){return this.core.loggerFactory}get transaction(){if(!this._transaction)throw new Error("Transaction undefined.");return this._transaction}cancel(e,s={}){if(!this.transaction)throw new Error("Transaction undefined.");if(!this.message.to)throw new Error("To undefined.");if(!this.message.from)throw new Error("From undefined.");const r=this.core.makeOutgoingRequestMessage(U.CANCEL,this.message.ruri,this.message.from.uri,this.message.to.uri,{toTag:this.message.toTag,fromTag:this.message.fromTag,callId:this.message.callId,cseq:this.message.cseq},s.extraHeaders);return r.branch=this.message.branch,this.message.headers.Route&&(r.headers.Route=this.message.headers.Route),e&&r.setHeader("Reason",e),this.transaction.state===E.Proceeding?new We(lt,this.core,r):this.transaction.addStateChangeListener(()=>{this.transaction&&this.transaction.state===E.Proceeding&&new We(lt,this.core,r)},{once:!0}),r}authenticationGuard(e,s){const r=e.statusCode;if(!r)throw new Error("Response status code undefined.");if(r!==401&&r!==407)return!0;let i,n;if(r===401?(i=e.parseHeader("www-authenticate"),n="authorization"):(i=e.parseHeader("proxy-authenticate"),n="proxy-authorization"),!i)return this.logger.warn(r+" with wrong or missing challenge, cannot authenticate"),!0;if(this.challenged&&(this.stale||i.stale!==!0))return this.logger.warn(r+" apparently in authentication loop, cannot authenticate"),!0;if(!this.credentials&&(this.credentials=this.core.configuration.authenticationFactory(),!this.credentials))return this.logger.warn("Unable to obtain credentials, cannot authenticate"),!0;if(!this.credentials.authenticate(this.message,i))return!0;this.challenged=!0,i.stale&&(this.stale=!0);let o=this.message.cseq+=1;return s&&s.localSequenceNumber&&(s.incrementLocalSequenceNumber(),o=this.message.cseq=s.localSequenceNumber),this.message.setHeader("cseq",o+" "+this.message.method),this.message.setHeader(n,this.credentials.toString()),this.init(),!1}onRequestTimeout(){this.logger.warn("User agent client request timed out. Generating internal 408 Request Timeout.");const e=new ss;e.statusCode=408,e.reasonPhrase="Request Timeout",this.receiveResponse(e)}onTransportError(e){this.logger.error(e.message),this.logger.error("User agent client request transport error. Generating internal 503 Service Unavailable.");const s=new ss;s.statusCode=503,s.reasonPhrase="Service Unavailable",this.receiveResponse(s)}receiveResponse(e){if(!this.authenticationGuard(e))return;const s=e.statusCode?e.statusCode.toString():"";if(!s)throw new Error("Response status code undefined.");switch(!0){case/^100$/.test(s):this.delegate&&this.delegate.onTrying&&this.delegate.onTrying({message:e});break;case/^1[0-9]{2}$/.test(s):this.delegate&&this.delegate.onProgress&&this.delegate.onProgress({message:e});break;case/^2[0-9]{2}$/.test(s):this.delegate&&this.delegate.onAccept&&this.delegate.onAccept({message:e});break;case/^3[0-9]{2}$/.test(s):this.delegate&&this.delegate.onRedirect&&this.delegate.onRedirect({message:e});break;case/^[4-6][0-9]{2}$/.test(s):this.delegate&&this.delegate.onReject&&this.delegate.onReject({message:e});break;default:throw new Error(`Invalid status code ${s}`)}}init(){const e={loggerFactory:this.loggerFactory,onRequestTimeout:()=>this.onRequestTimeout(),onStateChange:i=>{i===E.Terminated&&(this.core.userAgentClients.delete(r),s===this._transaction&&this.dispose())},onTransportError:i=>this.onTransportError(i),receiveResponse:i=>this.receiveResponse(i)},s=new this.transactionConstructor(this.message,this.core.transport,e);this._transaction=s;const r=s.id+s.request.method;this.core.userAgentClients.set(r,this)}}class If extends We{constructor(e,s,r){const i=e.createOutgoingRequestMessage(U.BYE,r);super(lt,e.userAgentCore,i,s),e.dispose()}}class ot extends Gc{constructor(e,s,r){super(e,s,r,E.Trying,"sip.transaction.nist")}dispose(){this.J&&(clearTimeout(this.J),this.J=void 0),super.dispose()}get kind(){return"nist"}receiveRequest(e){switch(this.state){case E.Trying:break;case E.Proceeding:if(!this.lastResponse)throw new Error("Last response undefined.");this.send(this.lastResponse).catch(s=>{this.logTransportError(s,"Failed to send retransmission of provisional response.")});break;case E.Completed:if(!this.lastResponse)throw new Error("Last response undefined.");this.send(this.lastResponse).catch(s=>{this.logTransportError(s,"Failed to send retransmission of final response.")});break;case E.Terminated:break;default:throw new Error(`Invalid state ${this.state}`)}}receiveResponse(e,s){if(e<100||e>699)throw new Error(`Invalid status code ${e}`);if(e>100&&e<=199)throw new Error("Provisional response other than 100 not allowed.");switch(this.state){case E.Trying:if(this.lastResponse=s,e>=100&&e<200){this.stateTransition(E.Proceeding),this.send(s).catch(i=>{this.logTransportError(i,"Failed to send provisional response.")});return}if(e>=200&&e<=699){this.stateTransition(E.Completed),this.send(s).catch(i=>{this.logTransportError(i,"Failed to send final response.")});return}break;case E.Proceeding:if(this.lastResponse=s,e>=200&&e<=699){this.stateTransition(E.Completed),this.send(s).catch(i=>{this.logTransportError(i,"Failed to send final response.")});return}break;case E.Completed:return;case E.Terminated:break;default:throw new Error(`Invalid state ${this.state}`)}const r=`Non-INVITE server transaction received unexpected ${e} response from TU while in state ${this.state}.`;throw this.logger.error(r),new Error(r)}onTransportError(e){this.user.onTransportError&&this.user.onTransportError(e),this.stateTransition(E.Terminated,!0)}typeToString(){return"non-INVITE server transaction"}stateTransition(e,s=!1){const r=()=>{throw new Error(`Invalid state transition from ${this.state} to ${e}`)};switch(e){case E.Trying:r();break;case E.Proceeding:this.state!==E.Trying&&r();break;case E.Completed:this.state!==E.Trying&&this.state!==E.Proceeding&&r();break;case E.Terminated:this.state!==E.Proceeding&&this.state!==E.Completed&&(s||r());break;default:r()}e===E.Completed&&(this.J=setTimeout(()=>this.timerJ(),Fe.TIMER_J)),e===E.Terminated&&this.dispose(),this.setState(e)}timerJ(){this.logger.debug(`Timer J expired for NON-INVITE server transaction ${this.id}.`),this.state===E.Completed&&this.stateTransition(E.Terminated)}}class Ht{constructor(e,s,r,i){this.transactionConstructor=e,this.core=s,this.message=r,this.delegate=i,this.logger=this.loggerFactory.getLogger("sip.user-agent-server"),this.toTag=r.toTag?r.toTag:Ci(),this.init()}dispose(){this.transaction.dispose()}get loggerFactory(){return this.core.loggerFactory}get transaction(){if(!this._transaction)throw new Error("Transaction undefined.");return this._transaction}accept(e={statusCode:200}){if(!this.acceptable)throw new zt(`${this.message.method} not acceptable in state ${this.transaction.state}.`);const s=e.statusCode;if(s<200||s>299)throw new TypeError(`Invalid statusCode: ${s}`);return this.reply(e)}progress(e={statusCode:180}){if(!this.progressable)throw new zt(`${this.message.method} not progressable in state ${this.transaction.state}.`);const s=e.statusCode;if(s<101||s>199)throw new TypeError(`Invalid statusCode: ${s}`);return this.reply(e)}redirect(e,s={statusCode:302}){if(!this.redirectable)throw new zt(`${this.message.method} not redirectable in state ${this.transaction.state}.`);const r=s.statusCode;if(r<300||r>399)throw new TypeError(`Invalid statusCode: ${r}`);const i=new Array;return e.forEach(o=>i.push(`Contact: ${o.toString()}`)),s.extraHeaders=(s.extraHeaders||[]).concat(i),this.reply(s)}reject(e={statusCode:480}){if(!this.rejectable)throw new zt(`${this.message.method} not rejectable in state ${this.transaction.state}.`);const s=e.statusCode;if(s<400||s>699)throw new TypeError(`Invalid statusCode: ${s}`);return this.reply(e)}trying(e){if(!this.tryingable)throw new zt(`${this.message.method} not tryingable in state ${this.transaction.state}.`);return this.reply({statusCode:100})}receiveCancel(e){this.delegate&&this.delegate.onCancel&&this.delegate.onCancel(e)}get acceptable(){if(this.transaction instanceof Qe)return this.transaction.state===E.Proceeding||this.transaction.state===E.Accepted;if(this.transaction instanceof ot)return this.transaction.state===E.Trying||this.transaction.state===E.Proceeding;throw new Error("Unknown transaction type.")}get progressable(){if(this.transaction instanceof Qe)return this.transaction.state===E.Proceeding;if(this.transaction instanceof ot)return!1;throw new Error("Unknown transaction type.")}get redirectable(){if(this.transaction instanceof Qe)return this.transaction.state===E.Proceeding;if(this.transaction instanceof ot)return this.transaction.state===E.Trying||this.transaction.state===E.Proceeding;throw new Error("Unknown transaction type.")}get rejectable(){if(this.transaction instanceof Qe)return this.transaction.state===E.Proceeding;if(this.transaction instanceof ot)return this.transaction.state===E.Trying||this.transaction.state===E.Proceeding;throw new Error("Unknown transaction type.")}get tryingable(){if(this.transaction instanceof Qe)return this.transaction.state===E.Proceeding;if(this.transaction instanceof ot)return this.transaction.state===E.Trying;throw new Error("Unknown transaction type.")}reply(e){!e.toTag&&e.statusCode!==100&&(e.toTag=this.toTag),e.userAgent=e.userAgent||this.core.configuration.userAgentHeaderFieldValue,e.supported=e.supported||this.core.configuration.supportedOptionTagsResponse;const s=Yc(this.message,e);return this.transaction.receiveResponse(e.statusCode,s.message),s}init(){const e={loggerFactory:this.loggerFactory,onStateChange:i=>{i===E.Terminated&&(this.core.userAgentServers.delete(r),this.dispose())},onTransportError:i=>{this.logger.error(i.message),this.delegate&&this.delegate.onTransportError?this.delegate.onTransportError(i):this.logger.error("User agent server response transport error.")}},s=new this.transactionConstructor(this.message,this.core.transport,e);this._transaction=s;const r=s.id;this.core.userAgentServers.set(s.id,this)}}class Df extends Ht{constructor(e,s,r){super(ot,e.userAgentCore,s,r)}}class Hf extends We{constructor(e,s,r){const i=e.createOutgoingRequestMessage(U.INFO,r);super(lt,e.userAgentCore,i,s)}}class Pf extends Ht{constructor(e,s,r){super(ot,e.userAgentCore,s,r)}}class zc extends We{constructor(e,s,r){super(lt,e,s,r)}}class Xc extends Ht{constructor(e,s,r){super(ot,e,s,r)}}class kf extends We{constructor(e,s,r){const i=e.createOutgoingRequestMessage(U.NOTIFY,r);super(lt,e.userAgentCore,i,s)}}function Of(t){return t.userAgentCore!==void 0}class Jr extends Ht{constructor(e,s,r){const i=Of(e)?e.userAgentCore:e;super(ot,i,s,r)}}class Lf extends We{constructor(e,s,r){const i=e.createOutgoingRequestMessage(U.PRACK,r);super(lt,e.userAgentCore,i,s),e.signalingStateTransition(i)}}class Mf extends Ht{constructor(e,s,r){super(ot,e.userAgentCore,s,r),e.signalingStateTransition(s),this.dialog=e}accept(e={statusCode:200}){return e.body&&this.dialog.signalingStateTransition(e.body),super.accept(e)}}class Ff extends We{constructor(e,s,r){const i=e.createOutgoingRequestMessage(U.INVITE,r);super(Jt,e.userAgentCore,i,s),this.delegate=s,e.signalingStateTransition(i),e.reinviteUserAgentClient=this,this.dialog=e}receiveResponse(e){if(!this.authenticationGuard(e,this.dialog))return;const s=e.statusCode?e.statusCode.toString():"";if(!s)throw new Error("Response status code undefined.");switch(!0){case/^100$/.test(s):this.delegate&&this.delegate.onTrying&&this.delegate.onTrying({message:e});break;case/^1[0-9]{2}$/.test(s):this.delegate&&this.delegate.onProgress&&this.delegate.onProgress({message:e,session:this.dialog,prack:r=>{throw new Error("Unimplemented.")}});break;case/^2[0-9]{2}$/.test(s):this.dialog.signalingStateTransition(e),this.delegate&&this.delegate.onAccept&&this.delegate.onAccept({message:e,session:this.dialog,ack:r=>this.dialog.ack(r)});break;case/^3[0-9]{2}$/.test(s):this.dialog.signalingStateRollback(),this.dialog.reinviteUserAgentClient=void 0,this.delegate&&this.delegate.onRedirect&&this.delegate.onRedirect({message:e});break;case/^[4-6][0-9]{2}$/.test(s):this.dialog.signalingStateRollback(),this.dialog.reinviteUserAgentClient=void 0,this.delegate&&this.delegate.onReject&&this.delegate.onReject({message:e});break;default:throw new Error(`Invalid status code ${s}`)}}}class Nf extends Ht{constructor(e,s,r){super(Qe,e.userAgentCore,s,r),e.reinviteUserAgentServer=this,this.dialog=e}accept(e={statusCode:200}){e.extraHeaders=e.extraHeaders||[],e.extraHeaders=e.extraHeaders.concat(this.dialog.routeSet.map(n=>`Record-Route: ${n}`));const s=super.accept(e),r=this.dialog,i=Object.assign(Object.assign({},s),{session:r});return e.body&&this.dialog.signalingStateTransition(e.body),this.dialog.reConfirm(),i}progress(e={statusCode:180}){const s=super.progress(e),r=this.dialog,i=Object.assign(Object.assign({},s),{session:r});return e.body&&this.dialog.signalingStateTransition(e.body),i}redirect(e,s={statusCode:302}){throw this.dialog.signalingStateRollback(),this.dialog.reinviteUserAgentServer=void 0,new Error("Unimplemented.")}reject(e={statusCode:488}){return this.dialog.signalingStateRollback(),this.dialog.reinviteUserAgentServer=void 0,super.reject(e)}}class qf extends We{constructor(e,s,r){const i=e.createOutgoingRequestMessage(U.REFER,r);super(lt,e.userAgentCore,i,s)}}function Bf(t){return t.userAgentCore!==void 0}class Jc extends Ht{constructor(e,s,r){const i=Bf(e)?e.userAgentCore:e;super(ot,i,s,r)}}class Zr extends Ls{constructor(e,s,r,i){super(s,r),this.initialTransaction=e,this._signalingState=F.Initial,this.ackWait=!1,this.ackProcessing=!1,this.delegate=i,e instanceof Qe&&(this.ackWait=!0),this.early||this.start2xxRetransmissionTimer(),this.signalingStateTransition(e.request),this.logger=s.loggerFactory.getLogger("sip.invite-dialog"),this.logger.log(`INVITE dialog ${this.id} constructed`)}dispose(){super.dispose(),this._signalingState=F.Closed,this._offer=void 0,this._answer=void 0,this.invite2xxTimer&&(clearTimeout(this.invite2xxTimer),this.invite2xxTimer=void 0),this.logger.log(`INVITE dialog ${this.id} destroyed`)}get sessionState(){return this.early?dt.Early:this.ackWait?dt.AckWait:this._signalingState===F.Closed?dt.Terminated:dt.Confirmed}get signalingState(){return this._signalingState}get offer(){return this._offer}get answer(){return this._answer}confirm(){this.early&&this.start2xxRetransmissionTimer(),super.confirm()}reConfirm(){this.reinviteUserAgentServer&&this.startReInvite2xxRetransmissionTimer()}ack(e={}){this.logger.log(`INVITE dialog ${this.id} sending ACK request`);let s;if(this.reinviteUserAgentClient){if(!(this.reinviteUserAgentClient.transaction instanceof Jt))throw new Error("Transaction not instance of InviteClientTransaction.");s=this.reinviteUserAgentClient.transaction,this.reinviteUserAgentClient=void 0}else{if(!(this.initialTransaction instanceof Jt))throw new Error("Initial transaction not instance of InviteClientTransaction.");s=this.initialTransaction}const r=this.createOutgoingRequestMessage(U.ACK,{cseq:s.request.cseq,extraHeaders:e.extraHeaders,body:e.body});return s.ackResponse(r),this.signalingStateTransition(r),{message:r}}bye(e,s){if(this.logger.log(`INVITE dialog ${this.id} sending BYE request`),this.initialTransaction instanceof Qe){if(this.early)throw new Error("UAS MUST NOT send a BYE on early dialogs.");if(this.ackWait&&this.initialTransaction.state!==E.Terminated)throw new Error("UAS MUST NOT send a BYE on a confirmed dialog until it has received an ACK for its 2xx response or until the server transaction times out.")}return new If(this,e,s)}info(e,s){if(this.logger.log(`INVITE dialog ${this.id} sending INFO request`),this.early)throw new Error("Dialog not confirmed.");return new Hf(this,e,s)}invite(e,s){if(this.logger.log(`INVITE dialog ${this.id} sending INVITE request`),this.early)throw new Error("Dialog not confirmed.");if(this.reinviteUserAgentClient)throw new Error("There is an ongoing re-INVITE client transaction.");if(this.reinviteUserAgentServer)throw new Error("There is an ongoing re-INVITE server transaction.");return new Ff(this,e,s)}message(e,s){if(this.logger.log(`INVITE dialog ${this.id} sending MESSAGE request`),this.early)throw new Error("Dialog not confirmed.");const r=this.createOutgoingRequestMessage(U.MESSAGE,s);return new zc(this.core,r,e)}notify(e,s){if(this.logger.log(`INVITE dialog ${this.id} sending NOTIFY request`),this.early)throw new Error("Dialog not confirmed.");return new kf(this,e,s)}prack(e,s){return this.logger.log(`INVITE dialog ${this.id} sending PRACK request`),new Lf(this,e,s)}refer(e,s){if(this.logger.log(`INVITE dialog ${this.id} sending REFER request`),this.early)throw new Error("Dialog not confirmed.");return new qf(this,e,s)}receiveRequest(e){if(this.logger.log(`INVITE dialog ${this.id} received ${e.method} request`),e.method===U.ACK){if(this.ackWait){if(this.initialTransaction instanceof Jt){this.logger.warn(`INVITE dialog ${this.id} received unexpected ${e.method} request, dropping.`);return}if(this.initialTransaction.request.cseq!==e.cseq){this.logger.warn(`INVITE dialog ${this.id} received unexpected ${e.method} request, dropping.`);return}this.ackWait=!1}else{if(!this.reinviteUserAgentServer){this.logger.warn(`INVITE dialog ${this.id} received unexpected ${e.method} request, dropping.`);return}if(this.reinviteUserAgentServer.transaction.request.cseq!==e.cseq){this.logger.warn(`INVITE dialog ${this.id} received unexpected ${e.method} request, dropping.`);return}this.reinviteUserAgentServer=void 0}if(this.signalingStateTransition(e),this.delegate&&this.delegate.onAck){const s=this.delegate.onAck({message:e});s instanceof Promise&&(this.ackProcessing=!0,s.then(()=>this.ackProcessing=!1).catch(()=>this.ackProcessing=!1))}return}if(!this.sequenceGuard(e)){this.logger.log(`INVITE dialog ${this.id} rejected out of order ${e.method} request.`);return}if(super.receiveRequest(e),e.method===U.INVITE){const s=()=>{const n=this.ackWait?"waiting for initial ACK":"processing initial ACK";this.logger.warn(`INVITE dialog ${this.id} received re-INVITE while ${n}`);let o="RFC 5407 suggests the following to avoid this race condition... ";o+=" Note: Implementation issues are outside the scope of this document,",o+=" but the following tip is provided for avoiding race conditions of",o+=" this type.  The caller can delay sending re-INVITE F6 for some period",o+=" of time (2 seconds, perhaps), after which the caller can reasonably",o+=" assume that its ACK has been received.  Implementors can decouple the",o+=" actions of the user (e.g., pressing the hold button) from the actions",o+=" of the protocol (the sending of re-INVITE F6), so that the UA can",o+=" behave like this.  In this case, it is the implementor's choice as to",o+=" how long to wait.  In most cases, such an implementation may be",o+=" useful to prevent the type of race condition shown in this section.",o+=" This document expresses no preference about whether or not they",o+=" should wait for an ACK to be delivered.  After considering the impact",o+=" on user experience, implementors should decide whether or not to wait",o+=" for a while, because the user experience depends on the",o+=" implementation and has no direct bearing on protocol behavior.",this.logger.warn(o)},i=[`Retry-After: ${Math.floor(Math.random()*10)+1}`];if(this.ackProcessing){this.core.replyStateless(e,{statusCode:500,extraHeaders:i}),s();return}if(this.ackWait&&this.signalingState!==F.Stable){this.core.replyStateless(e,{statusCode:500,extraHeaders:i}),s();return}if(this.reinviteUserAgentServer){this.core.replyStateless(e,{statusCode:500,extraHeaders:i});return}if(this.reinviteUserAgentClient){this.core.replyStateless(e,{statusCode:491});return}}if(e.method===U.INVITE){const s=e.parseHeader("contact");if(!s)throw new Error("Contact undefined.");if(!(s instanceof Je))throw new Error("Contact not instance of NameAddrHeader.");this.dialogState.remoteTarget=s.uri}switch(e.method){case U.BYE:{const s=new Df(this,e);this.delegate&&this.delegate.onBye?this.delegate.onBye(s):s.accept(),this.dispose()}break;case U.INFO:{const s=new Pf(this,e);this.delegate&&this.delegate.onInfo?this.delegate.onInfo(s):s.reject({statusCode:469,extraHeaders:["Recv-Info:"]})}break;case U.INVITE:{const s=new Nf(this,e);this.signalingStateTransition(e),this.delegate&&this.delegate.onInvite?this.delegate.onInvite(s):s.reject({statusCode:488})}break;case U.MESSAGE:{const s=new Xc(this.core,e);this.delegate&&this.delegate.onMessage?this.delegate.onMessage(s):s.accept()}break;case U.NOTIFY:{const s=new Jr(this,e);this.delegate&&this.delegate.onNotify?this.delegate.onNotify(s):s.accept()}break;case U.PRACK:{const s=new Mf(this,e);this.delegate&&this.delegate.onPrack?this.delegate.onPrack(s):s.accept()}break;case U.REFER:{const s=new Jc(this,e);this.delegate&&this.delegate.onRefer?this.delegate.onRefer(s):s.reject()}break;default:this.logger.log(`INVITE dialog ${this.id} received unimplemented ${e.method} request`),this.core.replyStateless(e,{statusCode:501});break}}reliableSequenceGuard(e){const s=e.statusCode;if(!s)throw new Error("Status code undefined");if(s>100&&s<200){const r=e.getHeader("require"),i=e.getHeader("rseq"),n=r&&r.includes("100rel")&&i?Number(i):void 0;if(n){if(this.rseq&&this.rseq+1!==n)return!1;this.rseq=this.rseq?this.rseq+1:n}}return!0}signalingStateRollback(){(this._signalingState===F.HaveLocalOffer||this.signalingState===F.HaveRemoteOffer)&&this._rollbackOffer&&this._rollbackAnswer&&(this._signalingState=F.Stable,this._offer=this._rollbackOffer,this._answer=this._rollbackAnswer)}signalingStateTransition(e){const s=rr(e);if(!(!s||s.contentDisposition!=="session")){if(this._signalingState===F.Stable&&(this._rollbackOffer=this._offer,this._rollbackAnswer=this._answer),e instanceof Ps)switch(this._signalingState){case F.Initial:case F.Stable:this._signalingState=F.HaveRemoteOffer,this._offer=s,this._answer=void 0;break;case F.HaveLocalOffer:this._signalingState=F.Stable,this._answer=s;break;case F.HaveRemoteOffer:break;case F.Closed:break;default:throw new Error("Unexpected signaling state.")}if(e instanceof ss)switch(this._signalingState){case F.Initial:case F.Stable:this._signalingState=F.HaveRemoteOffer,this._offer=s,this._answer=void 0;break;case F.HaveLocalOffer:this._signalingState=F.Stable,this._answer=s;break;case F.HaveRemoteOffer:break;case F.Closed:break;default:throw new Error("Unexpected signaling state.")}if(e instanceof bs)switch(this._signalingState){case F.Initial:case F.Stable:this._signalingState=F.HaveLocalOffer,this._offer=s,this._answer=void 0;break;case F.HaveLocalOffer:break;case F.HaveRemoteOffer:this._signalingState=F.Stable,this._answer=s;break;case F.Closed:break;default:throw new Error("Unexpected signaling state.")}if(jc(e))switch(this._signalingState){case F.Initial:case F.Stable:this._signalingState=F.HaveLocalOffer,this._offer=s,this._answer=void 0;break;case F.HaveLocalOffer:break;case F.HaveRemoteOffer:this._signalingState=F.Stable,this._answer=s;break;case F.Closed:break;default:throw new Error("Unexpected signaling state.")}}}start2xxRetransmissionTimer(){if(this.initialTransaction instanceof Qe){const e=this.initialTransaction;let s=Fe.T1;const r=()=>{if(!this.ackWait){this.invite2xxTimer=void 0;return}this.logger.log("No ACK for 2xx response received, attempting retransmission"),e.retransmitAcceptedResponse(),s=Math.min(s*2,Fe.T2),this.invite2xxTimer=setTimeout(r,s)};this.invite2xxTimer=setTimeout(r,s);const i=()=>{e.state===E.Terminated&&(e.removeStateChangeListener(i),this.invite2xxTimer&&(clearTimeout(this.invite2xxTimer),this.invite2xxTimer=void 0),this.ackWait&&(this.delegate&&this.delegate.onAckTimeout?this.delegate.onAckTimeout():this.bye()))};e.addStateChangeListener(i)}}startReInvite2xxRetransmissionTimer(){if(this.reinviteUserAgentServer&&this.reinviteUserAgentServer.transaction instanceof Qe){const e=this.reinviteUserAgentServer.transaction;let s=Fe.T1;const r=()=>{if(!this.reinviteUserAgentServer){this.invite2xxTimer=void 0;return}this.logger.log("No ACK for 2xx response received, attempting retransmission"),e.retransmitAcceptedResponse(),s=Math.min(s*2,Fe.T2),this.invite2xxTimer=setTimeout(r,s)};this.invite2xxTimer=setTimeout(r,s);const i=()=>{e.state===E.Terminated&&(e.removeStateChangeListener(i),this.invite2xxTimer&&(clearTimeout(this.invite2xxTimer),this.invite2xxTimer=void 0),this.reinviteUserAgentServer)};e.addStateChangeListener(i)}}}class Uf extends We{constructor(e,s,r){super(Jt,e,s,r),this.confirmedDialogAcks=new Map,this.confirmedDialogs=new Map,this.earlyDialogs=new Map,this.delegate=r}dispose(){this.earlyDialogs.forEach(e=>e.dispose()),this.earlyDialogs.clear(),super.dispose()}onTransportError(e){if(this.transaction.state===E.Calling)return super.onTransportError(e);this.logger.error(e.message),this.logger.error("User agent client request transport error while sending ACK.")}receiveResponse(e){if(!this.authenticationGuard(e))return;const s=e.statusCode?e.statusCode.toString():"";if(!s)throw new Error("Response status code undefined.");switch(!0){case/^100$/.test(s):this.delegate&&this.delegate.onTrying&&this.delegate.onTrying({message:e});return;case/^1[0-9]{2}$/.test(s):{if(!e.toTag){this.logger.warn("Non-100 1xx INVITE response received without a to tag, dropping.");return}if(!e.parseHeader("contact")){this.logger.error("Non-100 1xx INVITE response received without a Contact header field, dropping.");return}const i=Ls.initialDialogStateForUserAgentClient(this.message,e);let n=this.earlyDialogs.get(i.id);if(!n){const a=this.transaction;if(!(a instanceof Jt))throw new Error("Transaction not instance of InviteClientTransaction.");n=new Zr(a,this.core,i),this.earlyDialogs.set(n.id,n)}if(!n.reliableSequenceGuard(e)){this.logger.warn("1xx INVITE reliable response received out of order or is a retransmission, dropping.");return}(n.signalingState===F.Initial||n.signalingState===F.HaveLocalOffer)&&n.signalingStateTransition(e);const o=n;this.delegate&&this.delegate.onProgress&&this.delegate.onProgress({message:e,session:o,prack:a=>o.prack(void 0,a)})}return;case/^2[0-9]{2}$/.test(s):{if(!e.toTag){this.logger.error("2xx INVITE response received without a to tag, dropping.");return}if(!e.parseHeader("contact")){this.logger.error("2xx INVITE response received without a Contact header field, dropping.");return}const i=Ls.initialDialogStateForUserAgentClient(this.message,e);let n=this.confirmedDialogs.get(i.id);if(n){const a=this.confirmedDialogAcks.get(i.id);if(a){const c=this.transaction;if(!(c instanceof Jt))throw new Error("Client transaction not instance of InviteClientTransaction.");c.ackResponse(a.message)}return}if(n=this.earlyDialogs.get(i.id),n)n.confirm(),n.recomputeRouteSet(e),this.earlyDialogs.delete(n.id),this.confirmedDialogs.set(n.id,n);else{const a=this.transaction;if(!(a instanceof Jt))throw new Error("Transaction not instance of InviteClientTransaction.");n=new Zr(a,this.core,i),this.confirmedDialogs.set(n.id,n)}(n.signalingState===F.Initial||n.signalingState===F.HaveLocalOffer)&&n.signalingStateTransition(e);const o=n;if(this.delegate&&this.delegate.onAccept)this.delegate.onAccept({message:e,session:o,ack:a=>{const c=o.ack(a);return this.confirmedDialogAcks.set(o.id,c),c}});else{const a=o.ack();this.confirmedDialogAcks.set(o.id,a)}}return;case/^3[0-9]{2}$/.test(s):this.earlyDialogs.forEach(r=>r.dispose()),this.earlyDialogs.clear(),this.delegate&&this.delegate.onRedirect&&this.delegate.onRedirect({message:e});return;case/^[4-6][0-9]{2}$/.test(s):this.earlyDialogs.forEach(r=>r.dispose()),this.earlyDialogs.clear(),this.delegate&&this.delegate.onReject&&this.delegate.onReject({message:e});return;default:throw new Error(`Invalid status code ${s}`)}}}class Yi extends Ht{constructor(e,s,r){super(Qe,e,s,r),this.core=e}dispose(){this.earlyDialog&&this.earlyDialog.dispose(),super.dispose()}accept(e={statusCode:200}){if(!this.acceptable)throw new zt(`${this.message.method} not acceptable in state ${this.transaction.state}.`);if(!this.confirmedDialog)if(this.earlyDialog)this.earlyDialog.confirm(),this.confirmedDialog=this.earlyDialog,this.earlyDialog=void 0;else{const c=this.transaction;if(!(c instanceof Qe))throw new Error("Transaction not instance of InviteClientTransaction.");const d=Ls.initialDialogStateForUserAgentServer(this.message,this.toTag);this.confirmedDialog=new Zr(c,this.core,d)}const s=this.message.getHeaders("record-route").map(c=>`Record-Route: ${c}`),r=`Contact: ${this.core.configuration.contact.toString()}`,i="Allow: "+Xt.toString();if(!e.body){if(this.confirmedDialog.signalingState===F.Stable)e.body=this.confirmedDialog.answer;else if(this.confirmedDialog.signalingState===F.Initial||this.confirmedDialog.signalingState===F.HaveRemoteOffer)throw new Error("Response must have a body.")}e.statusCode=e.statusCode||200,e.extraHeaders=e.extraHeaders||[],e.extraHeaders=e.extraHeaders.concat(s),e.extraHeaders.push(i),e.extraHeaders.push(r);const n=super.accept(e),o=this.confirmedDialog,a=Object.assign(Object.assign({},n),{session:o});return e.body&&this.confirmedDialog.signalingState!==F.Stable&&this.confirmedDialog.signalingStateTransition(e.body),a}progress(e={statusCode:180}){if(!this.progressable)throw new zt(`${this.message.method} not progressable in state ${this.transaction.state}.`);if(!this.earlyDialog){const a=this.transaction;if(!(a instanceof Qe))throw new Error("Transaction not instance of InviteClientTransaction.");const c=Ls.initialDialogStateForUserAgentServer(this.message,this.toTag,!0);this.earlyDialog=new Zr(a,this.core,c)}const s=this.message.getHeaders("record-route").map(a=>`Record-Route: ${a}`),r=`Contact: ${this.core.configuration.contact}`;e.extraHeaders=e.extraHeaders||[],e.extraHeaders=e.extraHeaders.concat(s),e.extraHeaders.push(r);const i=super.progress(e),n=this.earlyDialog,o=Object.assign(Object.assign({},i),{session:n});return e.body&&this.earlyDialog.signalingState!==F.Stable&&this.earlyDialog.signalingStateTransition(e.body),o}redirect(e,s={statusCode:302}){return super.redirect(e,s)}reject(e={statusCode:486}){return super.reject(e)}}class jf extends We{constructor(e,s,r){super(lt,e,s,r)}}class Vf extends We{constructor(e,s,r){super(lt,e,s,r)}}class Wf extends Ht{constructor(e,s,r){super(ot,e,s,r),this.core=e}}class Yf extends We{constructor(e,s,r){const i=e.createOutgoingRequestMessage(U.SUBSCRIBE,r);super(lt,e.userAgentCore,i,s),this.dialog=e}waitNotifyStop(){}receiveResponse(e){if(e.statusCode&&e.statusCode>=200&&e.statusCode<300){const s=e.getHeader("Expires");if(!s)this.logger.warn("Expires header missing in a 200-class response to SUBSCRIBE");else{const r=Number(s);this.dialog.subscriptionExpires>r&&(this.dialog.subscriptionExpires=r)}}e.statusCode&&e.statusCode>=400&&e.statusCode<700&&[404,405,410,416,480,481,482,483,484,485,489,501,604].includes(e.statusCode)&&this.dialog.terminate(),super.receiveResponse(e)}}class Ko extends Ls{constructor(e,s,r,i,n,o){super(i,n),this.delegate=o,this._autoRefresh=!1,this._subscriptionEvent=e,this._subscriptionExpires=s,this._subscriptionExpiresInitial=s,this._subscriptionExpiresLastSet=Math.floor(Date.now()/1e3),this._subscriptionRefresh=void 0,this._subscriptionRefreshLastSet=void 0,this._subscriptionState=r,this.logger=i.loggerFactory.getLogger("sip.subscribe-dialog"),this.logger.log(`SUBSCRIBE dialog ${this.id} constructed`)}static initialDialogStateForSubscription(e,s){const i=s.getHeaders("record-route"),n=s.parseHeader("contact");if(!n)throw new Error("Contact undefined.");if(!(n instanceof Je))throw new Error("Contact not instance of NameAddrHeader.");const o=n.uri,a=e.cseq,c=void 0,d=e.callId,l=e.fromTag,u=s.fromTag;if(!d)throw new Error("Call id undefined.");if(!l)throw new Error("From tag undefined.");if(!u)throw new Error("To tag undefined.");if(!e.from)throw new Error("From undefined.");if(!e.to)throw new Error("To undefined.");const p=e.from.uri,y=e.to.uri;return{id:d+l+u,early:!1,callId:d,localTag:l,remoteTag:u,localSequenceNumber:a,remoteSequenceNumber:c,localURI:p,remoteURI:y,remoteTarget:o,routeSet:i,secure:!1}}dispose(){super.dispose(),this.N&&(clearTimeout(this.N),this.N=void 0),this.refreshTimerClear(),this.logger.log(`SUBSCRIBE dialog ${this.id} destroyed`)}get autoRefresh(){return this._autoRefresh}set autoRefresh(e){this._autoRefresh=!0,this.refreshTimerSet()}get subscriptionEvent(){return this._subscriptionEvent}get subscriptionExpires(){const e=Math.floor(Date.now()/1e3)-this._subscriptionExpiresLastSet,s=this._subscriptionExpires-e;return Math.max(s,0)}set subscriptionExpires(e){if(e<0)throw new Error("Expires must be greater than or equal to zero.");if(this._subscriptionExpires=e,this._subscriptionExpiresLastSet=Math.floor(Date.now()/1e3),this.autoRefresh){const s=this.subscriptionRefresh;(s===void 0||s>=e)&&this.refreshTimerSet()}}get subscriptionExpiresInitial(){return this._subscriptionExpiresInitial}get subscriptionRefresh(){if(this._subscriptionRefresh===void 0||this._subscriptionRefreshLastSet===void 0)return;const e=Math.floor(Date.now()/1e3)-this._subscriptionRefreshLastSet,s=this._subscriptionRefresh-e;return Math.max(s,0)}get subscriptionState(){return this._subscriptionState}receiveRequest(e){if(this.logger.log(`SUBSCRIBE dialog ${this.id} received ${e.method} request`),!this.sequenceGuard(e)){this.logger.log(`SUBSCRIBE dialog ${this.id} rejected out of order ${e.method} request.`);return}switch(super.receiveRequest(e),e.method){case U.NOTIFY:this.onNotify(e);break;default:this.logger.log(`SUBSCRIBE dialog ${this.id} received unimplemented ${e.method} request`),this.core.replyStateless(e,{statusCode:501});break}}refresh(){const e="Allow: "+Xt.toString(),s={};return s.extraHeaders=(s.extraHeaders||[]).slice(),s.extraHeaders.push(e),s.extraHeaders.push("Event: "+this.subscriptionEvent),s.extraHeaders.push("Expires: "+this.subscriptionExpiresInitial),s.extraHeaders.push("Contact: "+this.core.configuration.contact.toString()),this.subscribe(void 0,s)}subscribe(e,s={}){var r;if(this.subscriptionState!==ne.Pending&&this.subscriptionState!==ne.Active)throw new Error(`Invalid state ${this.subscriptionState}. May only re-subscribe while in state "pending" or "active".`);this.logger.log(`SUBSCRIBE dialog ${this.id} sending SUBSCRIBE request`);const i=new Yf(this,e,s);return this.N&&(clearTimeout(this.N),this.N=void 0),!((r=s.extraHeaders)===null||r===void 0)&&r.includes("Expires: 0")||(this.N=setTimeout(()=>this.timerN(),Fe.TIMER_N)),i}terminate(){this.stateTransition(ne.Terminated),this.onTerminated()}unsubscribe(){const e="Allow: "+Xt.toString(),s={};return s.extraHeaders=(s.extraHeaders||[]).slice(),s.extraHeaders.push(e),s.extraHeaders.push("Event: "+this.subscriptionEvent),s.extraHeaders.push("Expires: 0"),s.extraHeaders.push("Contact: "+this.core.configuration.contact.toString()),this.subscribe(void 0,s)}onNotify(e){const s=e.parseHeader("Event").event;if(!s||s!==this.subscriptionEvent){this.core.replyStateless(e,{statusCode:489});return}this.N&&(clearTimeout(this.N),this.N=void 0);const r=e.parseHeader("Subscription-State");if(!r||!r.state){this.core.replyStateless(e,{statusCode:489});return}const i=r.state,n=r.expires?Math.max(r.expires,0):void 0;switch(i){case"pending":this.stateTransition(ne.Pending,n);break;case"active":this.stateTransition(ne.Active,n);break;case"terminated":this.stateTransition(ne.Terminated,n);break;default:this.logger.warn("Unrecognized subscription state.");break}const o=new Jr(this,e);this.delegate&&this.delegate.onNotify?this.delegate.onNotify(o):o.accept()}onRefresh(e){this.delegate&&this.delegate.onRefresh&&this.delegate.onRefresh(e)}onTerminated(){this.delegate&&this.delegate.onTerminated&&this.delegate.onTerminated()}refreshTimerClear(){this.refreshTimer&&(clearTimeout(this.refreshTimer),this.refreshTimer=void 0)}refreshTimerSet(){if(this.refreshTimerClear(),this.autoRefresh&&this.subscriptionExpires>0){const e=this.subscriptionExpires*900;this._subscriptionRefresh=Math.floor(e/1e3),this._subscriptionRefreshLastSet=Math.floor(Date.now()/1e3),this.refreshTimer=setTimeout(()=>{this.refreshTimer=void 0,this._subscriptionRefresh=void 0,this._subscriptionRefreshLastSet=void 0,this.onRefresh(this.refresh())},e)}}stateTransition(e,s){const r=()=>{this.logger.warn(`Invalid subscription state transition from ${this.subscriptionState} to ${e}`)};switch(e){case ne.Initial:r();return;case ne.NotifyWait:r();return;case ne.Pending:if(this.subscriptionState!==ne.NotifyWait&&this.subscriptionState!==ne.Pending){r();return}break;case ne.Active:if(this.subscriptionState!==ne.NotifyWait&&this.subscriptionState!==ne.Pending&&this.subscriptionState!==ne.Active){r();return}break;case ne.Terminated:if(this.subscriptionState!==ne.NotifyWait&&this.subscriptionState!==ne.Pending&&this.subscriptionState!==ne.Active){r();return}break;default:r();return}e===ne.Pending&&s&&(this.subscriptionExpires=s),e===ne.Active&&s&&(this.subscriptionExpires=s),e===ne.Terminated&&this.dispose(),this._subscriptionState=e}timerN(){this.logger.warn("Timer N expired for SUBSCRIBE dialog. Timed out waiting for NOTIFY."),this.subscriptionState!==ne.Terminated&&(this.stateTransition(ne.Terminated),this.onTerminated())}}class Kf extends We{constructor(e,s,r){const i=s.getHeader("Event");if(!i)throw new Error("Event undefined");const n=s.getHeader("Expires");if(!n)throw new Error("Expires undefined");super(lt,e,s,r),this.delegate=r,this.subscriberId=s.callId+s.fromTag+i,this.subscriptionExpiresRequested=this.subscriptionExpires=Number(n),this.subscriptionEvent=i,this.subscriptionState=ne.NotifyWait,this.waitNotifyStart()}dispose(){super.dispose()}onNotify(e){const s=e.message.parseHeader("Event").event;if(!s||s!==this.subscriptionEvent){this.logger.warn("Failed to parse event."),e.reject({statusCode:489});return}const r=e.message.parseHeader("Subscription-State");if(!r||!r.state){this.logger.warn("Failed to parse subscription state."),e.reject({statusCode:489});return}const i=r.state;switch(i){case"pending":break;case"active":break;case"terminated":break;default:this.logger.warn(`Invalid subscription state ${i}`),e.reject({statusCode:489});return}if(i!=="terminated"&&!e.message.parseHeader("contact")){this.logger.warn("Failed to parse contact."),e.reject({statusCode:489});return}if(this.dialog)throw new Error("Dialog already created. This implementation only supports install of single subscriptions.");switch(this.waitNotifyStop(),this.subscriptionExpires=r.expires?Math.min(this.subscriptionExpires,Math.max(r.expires,0)):this.subscriptionExpires,i){case"pending":this.subscriptionState=ne.Pending;break;case"active":this.subscriptionState=ne.Active;break;case"terminated":this.subscriptionState=ne.Terminated;break;default:throw new Error(`Unrecognized state ${i}.`)}if(this.subscriptionState!==ne.Terminated){const n=Ko.initialDialogStateForSubscription(this.message,e.message);this.dialog=new Ko(this.subscriptionEvent,this.subscriptionExpires,this.subscriptionState,this.core,n)}if(this.delegate&&this.delegate.onNotify){const n=e,o=this.dialog;this.delegate.onNotify({request:n,subscription:o})}else e.accept()}waitNotifyStart(){this.N||(this.core.subscribers.set(this.subscriberId,this),this.N=setTimeout(()=>this.timerN(),Fe.TIMER_N))}waitNotifyStop(){this.N&&(this.core.subscribers.delete(this.subscriberId),clearTimeout(this.N),this.N=void 0)}receiveResponse(e){if(this.authenticationGuard(e)){if(e.statusCode&&e.statusCode>=200&&e.statusCode<300){const s=e.getHeader("Expires");if(!s)this.logger.warn("Expires header missing in a 200-class response to SUBSCRIBE");else{const r=Number(s);r>this.subscriptionExpiresRequested&&this.logger.warn("Expires header in a 200-class response to SUBSCRIBE with a higher value than the one in the request"),r<this.subscriptionExpires&&(this.subscriptionExpires=r)}this.dialog&&this.dialog.subscriptionExpires>this.subscriptionExpires&&(this.dialog.subscriptionExpires=this.subscriptionExpires)}e.statusCode&&e.statusCode>=300&&e.statusCode<700&&this.waitNotifyStop(),super.receiveResponse(e)}}timerN(){this.logger.warn("Timer N expired for SUBSCRIBE user agent client. Timed out waiting for NOTIFY."),this.waitNotifyStop(),this.delegate&&this.delegate.onNotifyTimeout&&this.delegate.onNotifyTimeout()}}class Gf extends Ht{constructor(e,s,r){super(ot,e,s,r),this.core=e}}const Go=["application/sdp","application/dtmf-relay"];class zf{constructor(e,s={}){this.userAgentClients=new Map,this.userAgentServers=new Map,this.configuration=e,this.delegate=s,this.dialogs=new Map,this.subscribers=new Map,this.logger=e.loggerFactory.getLogger("sip.user-agent-core")}dispose(){this.reset()}reset(){this.dialogs.forEach(e=>e.dispose()),this.dialogs.clear(),this.subscribers.forEach(e=>e.dispose()),this.subscribers.clear(),this.userAgentClients.forEach(e=>e.dispose()),this.userAgentClients.clear(),this.userAgentServers.forEach(e=>e.dispose()),this.userAgentServers.clear()}get loggerFactory(){return this.configuration.loggerFactory}get transport(){const e=this.configuration.transportAccessor();if(!e)throw new Error("Transport undefined.");return e}invite(e,s){return new Uf(this,e,s)}message(e,s){return new zc(this,e,s)}publish(e,s){return new jf(this,e,s)}register(e,s){return new Vf(this,e,s)}subscribe(e,s){return new Kf(this,e,s)}request(e,s){return new We(lt,this,e,s)}makeOutgoingRequestMessage(e,s,r,i,n,o,a){const c=this.configuration.sipjsId,d=this.configuration.displayName,l=this.configuration.viaForceRport,u=this.configuration.hackViaTcp,p=this.configuration.supportedOptionTags.slice();e===U.REGISTER&&p.push("path","gruu"),e===U.INVITE&&(this.configuration.contact.pubGruu||this.configuration.contact.tempGruu)&&p.push("gruu");const y=this.configuration.routeSet,w=this.configuration.userAgentHeaderFieldValue,C=this.configuration.viaHost,f=Object.assign(Object.assign({},{callIdPrefix:c,forceRport:l,fromDisplayName:d,hackViaTcp:u,optionTags:p,routeSet:y,userAgentString:w,viaHost:C}),n);return new bs(e,s,r,i,f,o,a)}receiveIncomingRequestFromTransport(e){this.receiveRequestFromTransport(e)}receiveIncomingResponseFromTransport(e){this.receiveResponseFromTransport(e)}replyStateless(e,s){const r=this.configuration.userAgentHeaderFieldValue,i=this.configuration.supportedOptionTagsResponse;s=Object.assign(Object.assign({},s),{userAgent:r,supported:i});const n=Yc(e,s);return this.transport.send(n.message).catch(o=>{o instanceof Error&&this.logger.error(o.message),this.logger.error(`Transport error occurred sending stateless reply to ${e.method} request.`)}),n}receiveRequestFromTransport(e){const s=e.viaBranch,r=this.userAgentServers.get(s);if(e.method===U.ACK&&r&&r.transaction.state===E.Accepted&&r instanceof Yi){this.logger.warn(`Discarding out of dialog ACK after 2xx response sent on transaction ${s}.`);return}if(e.method===U.CANCEL){r?(this.replyStateless(e,{statusCode:200}),r.transaction instanceof Qe&&r.transaction.state===E.Proceeding&&r instanceof Yi&&r.receiveCancel(e)):this.replyStateless(e,{statusCode:481});return}if(r){r.transaction.receiveRequest(e);return}this.receiveRequest(e)}receiveRequest(e){if(!Xt.includes(e.method)){const i="Allow: "+Xt.toString();this.replyStateless(e,{statusCode:405,extraHeaders:[i]});return}if(!e.ruri)throw new Error("Request-URI undefined.");if(e.ruri.scheme!=="sip"){this.replyStateless(e,{statusCode:416});return}const s=e.ruri,r=i=>!!i&&i.user===s.user;if(!r(this.configuration.aor)&&!(r(this.configuration.contact.uri)||r(this.configuration.contact.pubGruu)||r(this.configuration.contact.tempGruu))){this.logger.warn("Request-URI does not point to us."),e.method!==U.ACK&&this.replyStateless(e,{statusCode:404});return}if(e.method===U.INVITE&&!e.hasHeader("Contact")){this.replyStateless(e,{statusCode:400,reasonPhrase:"Missing Contact Header"});return}if(!e.toTag){const i=e.viaBranch;if(!this.userAgentServers.has(i)&&Array.from(this.userAgentServers.values()).some(o=>o.transaction.request.fromTag===e.fromTag&&o.transaction.request.callId===e.callId&&o.transaction.request.cseq===e.cseq)){this.replyStateless(e,{statusCode:482});return}}e.toTag?this.receiveInsideDialogRequest(e):this.receiveOutsideDialogRequest(e)}receiveInsideDialogRequest(e){if(e.method===U.NOTIFY){const i=e.parseHeader("Event");if(!i||!i.event){this.replyStateless(e,{statusCode:489});return}const n=e.callId+e.toTag+i.event,o=this.subscribers.get(n);if(o){const a=new Jr(this,e);o.onNotify(a);return}}const s=e.callId+e.toTag+e.fromTag,r=this.dialogs.get(s);if(r){if(e.method===U.OPTIONS){const i="Allow: "+Xt.toString(),n="Accept: "+Go.toString();this.replyStateless(e,{statusCode:200,extraHeaders:[i,n]});return}r.receiveRequest(e);return}e.method!==U.ACK&&this.replyStateless(e,{statusCode:481})}receiveOutsideDialogRequest(e){switch(e.method){case U.ACK:break;case U.BYE:this.replyStateless(e,{statusCode:481});break;case U.CANCEL:throw new Error(`Unexpected out of dialog request method ${e.method}.`);case U.INFO:this.replyStateless(e,{statusCode:405});break;case U.INVITE:{const s=new Yi(this,e);this.delegate.onInvite?this.delegate.onInvite(s):s.reject()}break;case U.MESSAGE:{const s=new Xc(this,e);this.delegate.onMessage?this.delegate.onMessage(s):s.accept()}break;case U.NOTIFY:{const s=new Jr(this,e);this.delegate.onNotify?this.delegate.onNotify(s):s.reject({statusCode:405})}break;case U.OPTIONS:{const s="Allow: "+Xt.toString(),r="Accept: "+Go.toString();this.replyStateless(e,{statusCode:200,extraHeaders:[s,r]})}break;case U.REFER:{const s=new Jc(this,e);this.delegate.onRefer?this.delegate.onRefer(s):s.reject({statusCode:405})}break;case U.REGISTER:{const s=new Wf(this,e);this.delegate.onRegister?this.delegate.onRegister(s):s.reject({statusCode:405})}break;case U.SUBSCRIBE:{const s=new Gf(this,e);this.delegate.onSubscribe?this.delegate.onSubscribe(s):s.reject({statusCode:480})}break;default:throw new Error(`Unexpected out of dialog request method ${e.method}.`)}}receiveResponseFromTransport(e){if(e.getHeaders("via").length>1){this.logger.warn("More than one Via header field present in the response, dropping");return}const s=e.viaBranch+e.method,r=this.userAgentClients.get(s);r?r.transaction.receiveResponse(e):this.logger.warn(`Discarding unmatched ${e.statusCode} response to ${e.method} ${s}.`)}}function Xf(){return t=>!t.audio&&!t.video?Promise.resolve(new MediaStream):navigator.mediaDevices===void 0?Promise.reject(new Error("Media devices not available in insecure contexts.")):navigator.mediaDevices.getUserMedia.call(navigator.mediaDevices,t)}function Jf(){return{bundlePolicy:"balanced",certificates:void 0,iceCandidatePoolSize:0,iceServers:[{urls:"stun:stun.l.google.com:19302"}],iceTransportPolicy:"all",rtcpMuxPolicy:"require"}}class Mt{constructor(e,s,r){e.debug("SessionDescriptionHandler.constructor"),this.logger=e,this.mediaStreamFactory=s,this.sessionDescriptionHandlerConfiguration=r,this._localMediaStream=new MediaStream,this._remoteMediaStream=new MediaStream,this._peerConnection=new RTCPeerConnection(r==null?void 0:r.peerConnectionConfiguration),this.initPeerConnectionEventHandlers()}get localMediaStream(){return this._localMediaStream}get remoteMediaStream(){return this._remoteMediaStream}get dataChannel(){return this._dataChannel}get peerConnection(){return this._peerConnection}get peerConnectionDelegate(){return this._peerConnectionDelegate}set peerConnectionDelegate(e){this._peerConnectionDelegate=e}static dispatchAddTrackEvent(e,s){e.dispatchEvent(new MediaStreamTrackEvent("addtrack",{track:s}))}static dispatchRemoveTrackEvent(e,s){e.dispatchEvent(new MediaStreamTrackEvent("removetrack",{track:s}))}close(){this.logger.debug("SessionDescriptionHandler.close"),this._peerConnection!==void 0&&(this._peerConnection.getReceivers().forEach(e=>{e.track&&e.track.stop()}),this._peerConnection.getSenders().forEach(e=>{e.track&&e.track.stop()}),this._dataChannel&&this._dataChannel.close(),this._peerConnection.close(),this._peerConnection=void 0)}enableReceiverTracks(e){const s=this.peerConnection;if(!s)throw new Error("Peer connection closed.");s.getReceivers().forEach(r=>{r.track&&(r.track.enabled=e)})}enableSenderTracks(e){const s=this.peerConnection;if(!s)throw new Error("Peer connection closed.");s.getSenders().forEach(r=>{r.track&&(r.track.enabled=e)})}getDescription(e,s){var r,i;if(this.logger.debug("SessionDescriptionHandler.getDescription"),this._peerConnection===void 0)return Promise.reject(new Error("Peer connection closed."));this.onDataChannel=e==null?void 0:e.onDataChannel;const n=(r=e==null?void 0:e.offerOptions)===null||r===void 0?void 0:r.iceRestart,o=(e==null?void 0:e.iceGatheringTimeout)===void 0?(i=this.sessionDescriptionHandlerConfiguration)===null||i===void 0?void 0:i.iceGatheringTimeout:e==null?void 0:e.iceGatheringTimeout;return this.getLocalMediaStream(e).then(()=>this.updateDirection(e)).then(()=>this.createDataChannel(e)).then(()=>this.createLocalOfferOrAnswer(e)).then(a=>this.applyModifiers(a,s)).then(a=>this.setLocalSessionDescription(a)).then(()=>this.waitForIceGatheringComplete(n,o)).then(()=>this.getLocalSessionDescription()).then(a=>({body:a.sdp,contentType:"application/sdp"})).catch(a=>{throw this.logger.error("SessionDescriptionHandler.getDescription failed - "+a),a})}hasDescription(e){return this.logger.debug("SessionDescriptionHandler.hasDescription"),e==="application/sdp"}iceGatheringComplete(){this.logger.debug("SessionDescriptionHandler.iceGatheringComplete"),this.iceGatheringCompleteTimeoutId!==void 0&&(this.logger.debug("SessionDescriptionHandler.iceGatheringComplete - clearing timeout"),clearTimeout(this.iceGatheringCompleteTimeoutId),this.iceGatheringCompleteTimeoutId=void 0),this.iceGatheringCompletePromise!==void 0&&(this.logger.debug("SessionDescriptionHandler.iceGatheringComplete - resolving promise"),this.iceGatheringCompleteResolve&&this.iceGatheringCompleteResolve(),this.iceGatheringCompletePromise=void 0,this.iceGatheringCompleteResolve=void 0,this.iceGatheringCompleteReject=void 0)}sendDtmf(e,s){if(this.logger.debug("SessionDescriptionHandler.sendDtmf"),this._peerConnection===void 0)return this.logger.error("SessionDescriptionHandler.sendDtmf failed - peer connection closed"),!1;const r=this._peerConnection.getSenders();if(r.length===0)return this.logger.error("SessionDescriptionHandler.sendDtmf failed - no senders"),!1;const i=r[0].dtmf;if(!i)return this.logger.error("SessionDescriptionHandler.sendDtmf failed - no DTMF sender"),!1;const n=s==null?void 0:s.duration,o=s==null?void 0:s.interToneGap;try{i.insertDTMF(e,n,o)}catch(a){return this.logger.error(a.toString()),!1}return this.logger.log("SessionDescriptionHandler.sendDtmf sent via RTP: "+e.toString()),!0}setDescription(e,s,r){if(this.logger.debug("SessionDescriptionHandler.setDescription"),this._peerConnection===void 0)return Promise.reject(new Error("Peer connection closed."));this.onDataChannel=s==null?void 0:s.onDataChannel;const i=this._peerConnection.signalingState==="have-local-offer"?"answer":"offer";return this.getLocalMediaStream(s).then(()=>this.applyModifiers({sdp:e,type:i},r)).then(n=>this.setRemoteSessionDescription(n)).catch(n=>{throw this.logger.error("SessionDescriptionHandler.setDescription failed - "+n),n})}applyModifiers(e,s){return this.logger.debug("SessionDescriptionHandler.applyModifiers"),!s||s.length===0?Promise.resolve(e):s.reduce((r,i)=>r.then(i),Promise.resolve(e)).then(r=>{if(this.logger.debug("SessionDescriptionHandler.applyModifiers - modified sdp"),!r.sdp||!r.type)throw new Error("Invalid SDP.");return{sdp:r.sdp,type:r.type}})}createDataChannel(e){if(this._peerConnection===void 0)return Promise.reject(new Error("Peer connection closed."));if((e==null?void 0:e.dataChannel)!==!0||this._dataChannel)return Promise.resolve();switch(this._peerConnection.signalingState){case"stable":this.logger.debug("SessionDescriptionHandler.createDataChannel - creating data channel");try{return this._dataChannel=this._peerConnection.createDataChannel((e==null?void 0:e.dataChannelLabel)||"",e==null?void 0:e.dataChannelOptions),this.onDataChannel&&this.onDataChannel(this._dataChannel),Promise.resolve()}catch(s){return Promise.reject(s)}case"have-remote-offer":return Promise.resolve();case"have-local-offer":case"have-local-pranswer":case"have-remote-pranswer":case"closed":default:return Promise.reject(new Error("Invalid signaling state "+this._peerConnection.signalingState))}}createLocalOfferOrAnswer(e){if(this._peerConnection===void 0)return Promise.reject(new Error("Peer connection closed."));switch(this._peerConnection.signalingState){case"stable":return this.logger.debug("SessionDescriptionHandler.createLocalOfferOrAnswer - creating SDP offer"),this._peerConnection.createOffer(e==null?void 0:e.offerOptions);case"have-remote-offer":return this.logger.debug("SessionDescriptionHandler.createLocalOfferOrAnswer - creating SDP answer"),this._peerConnection.createAnswer(e==null?void 0:e.answerOptions);case"have-local-offer":case"have-local-pranswer":case"have-remote-pranswer":case"closed":default:return Promise.reject(new Error("Invalid signaling state "+this._peerConnection.signalingState))}}getLocalMediaStream(e){if(this.logger.debug("SessionDescriptionHandler.getLocalMediaStream"),this._peerConnection===void 0)return Promise.reject(new Error("Peer connection closed."));let s=Object.assign({},e==null?void 0:e.constraints);if(this.localMediaStreamConstraints){if(s.audio=s.audio||this.localMediaStreamConstraints.audio,s.video=s.video||this.localMediaStreamConstraints.video,JSON.stringify(this.localMediaStreamConstraints.audio)===JSON.stringify(s.audio)&&JSON.stringify(this.localMediaStreamConstraints.video)===JSON.stringify(s.video))return Promise.resolve()}else s.audio===void 0&&s.video===void 0&&(s={audio:!0});return this.localMediaStreamConstraints=s,this.mediaStreamFactory(s,this,e).then(r=>this.setLocalMediaStream(r))}setLocalMediaStream(e){if(this.logger.debug("SessionDescriptionHandler.setLocalMediaStream"),!this._peerConnection)throw new Error("Peer connection undefined.");const s=this._peerConnection,r=this._localMediaStream,i=[],n=c=>{const d=c.kind;if(d!=="audio"&&d!=="video")throw new Error(`Unknown new track kind ${d}.`);const l=s.getSenders().find(u=>u.track&&u.track.kind===d);l?i.push(new Promise(u=>{this.logger.debug(`SessionDescriptionHandler.setLocalMediaStream - replacing sender ${d} track`),u()}).then(()=>l.replaceTrack(c).then(()=>{const u=r.getTracks().find(p=>p.kind===d);u&&(u.stop(),r.removeTrack(u),Mt.dispatchRemoveTrackEvent(r,u)),r.addTrack(c),Mt.dispatchAddTrackEvent(r,c)}).catch(u=>{throw this.logger.error(`SessionDescriptionHandler.setLocalMediaStream - failed to replace sender ${d} track`),u}))):i.push(new Promise(u=>{this.logger.debug(`SessionDescriptionHandler.setLocalMediaStream - adding sender ${d} track`),u()}).then(()=>{try{s.addTrack(c,r)}catch(u){throw this.logger.error(`SessionDescriptionHandler.setLocalMediaStream - failed to add sender ${d} track`),u}r.addTrack(c),Mt.dispatchAddTrackEvent(r,c)}))},o=e.getAudioTracks();o.length&&n(o[0]);const a=e.getVideoTracks();return a.length&&n(a[0]),i.reduce((c,d)=>c.then(()=>d),Promise.resolve())}getLocalSessionDescription(){if(this.logger.debug("SessionDescriptionHandler.getLocalSessionDescription"),this._peerConnection===void 0)return Promise.reject(new Error("Peer connection closed."));const e=this._peerConnection.localDescription;return e?Promise.resolve(e):Promise.reject(new Error("Failed to get local session description"))}setLocalSessionDescription(e){return this.logger.debug("SessionDescriptionHandler.setLocalSessionDescription"),this._peerConnection===void 0?Promise.reject(new Error("Peer connection closed.")):this._peerConnection.setLocalDescription(e)}setRemoteSessionDescription(e){if(this.logger.debug("SessionDescriptionHandler.setRemoteSessionDescription"),this._peerConnection===void 0)return Promise.reject(new Error("Peer connection closed."));const s=e.sdp;let r;switch(this._peerConnection.signalingState){case"stable":r="offer";break;case"have-local-offer":r="answer";break;case"have-local-pranswer":case"have-remote-offer":case"have-remote-pranswer":case"closed":default:return Promise.reject(new Error("Invalid signaling state "+this._peerConnection.signalingState))}return s?this._peerConnection.setRemoteDescription({sdp:s,type:r}):(this.logger.error("SessionDescriptionHandler.setRemoteSessionDescription failed - cannot set null sdp"),Promise.reject(new Error("SDP is undefined")))}setRemoteTrack(e){this.logger.debug("SessionDescriptionHandler.setRemoteTrack");const s=this._remoteMediaStream;s.getTrackById(e.id)?this.logger.debug(`SessionDescriptionHandler.setRemoteTrack - have remote ${e.kind} track`):e.kind==="audio"?(this.logger.debug(`SessionDescriptionHandler.setRemoteTrack - adding remote ${e.kind} track`),s.getAudioTracks().forEach(r=>{r.stop(),s.removeTrack(r),Mt.dispatchRemoveTrackEvent(s,r)}),s.addTrack(e),Mt.dispatchAddTrackEvent(s,e)):e.kind==="video"&&(this.logger.debug(`SessionDescriptionHandler.setRemoteTrack - adding remote ${e.kind} track`),s.getVideoTracks().forEach(r=>{r.stop(),s.removeTrack(r),Mt.dispatchRemoveTrackEvent(s,r)}),s.addTrack(e),Mt.dispatchAddTrackEvent(s,e))}updateDirection(e){if(this._peerConnection===void 0)return Promise.reject(new Error("Peer connection closed."));switch(this._peerConnection.signalingState){case"stable":this.logger.debug("SessionDescriptionHandler.updateDirection - setting offer direction");{const s=r=>{switch(r){case"inactive":return e!=null&&e.hold?"inactive":"recvonly";case"recvonly":return e!=null&&e.hold?"inactive":"recvonly";case"sendonly":return e!=null&&e.hold?"sendonly":"sendrecv";case"sendrecv":return e!=null&&e.hold?"sendonly":"sendrecv";case"stopped":return"stopped";default:throw new Error("Should never happen")}};this._peerConnection.getTransceivers().forEach(r=>{if(r.direction){const i=s(r.direction);r.direction!==i&&(r.direction=i)}})}break;case"have-remote-offer":this.logger.debug("SessionDescriptionHandler.updateDirection - setting answer direction");{const s=(()=>{const i=this._peerConnection.remoteDescription;if(!i)throw new Error("Failed to read remote offer");const n=/a=sendrecv\r\n|a=sendonly\r\n|a=recvonly\r\n|a=inactive\r\n/.exec(i.sdp);if(n)switch(n[0]){case`a=inactive\r
`:return"inactive";case`a=recvonly\r
`:return"recvonly";case`a=sendonly\r
`:return"sendonly";case`a=sendrecv\r
`:return"sendrecv";default:throw new Error("Should never happen")}return"sendrecv"})(),r=(()=>{switch(s){case"inactive":return"inactive";case"recvonly":return"sendonly";case"sendonly":return e!=null&&e.hold?"inactive":"recvonly";case"sendrecv":return e!=null&&e.hold?"sendonly":"sendrecv";default:throw new Error("Should never happen")}})();this._peerConnection.getTransceivers().forEach(i=>{i.direction&&i.direction!=="stopped"&&i.direction!==r&&(i.direction=r)})}break;case"have-local-offer":case"have-local-pranswer":case"have-remote-pranswer":case"closed":default:return Promise.reject(new Error("Invalid signaling state "+this._peerConnection.signalingState))}return Promise.resolve()}waitForIceGatheringComplete(e=!1,s=0){return this.logger.debug("SessionDescriptionHandler.waitForIceGatheringToComplete"),this._peerConnection===void 0?Promise.reject("Peer connection closed."):!e&&this._peerConnection.iceGatheringState==="complete"?(this.logger.debug("SessionDescriptionHandler.waitForIceGatheringToComplete - already complete"),Promise.resolve()):(this.iceGatheringCompletePromise!==void 0&&(this.logger.debug("SessionDescriptionHandler.waitForIceGatheringToComplete - rejecting prior waiting promise"),this.iceGatheringCompleteReject&&this.iceGatheringCompleteReject(new Error("Promise superseded.")),this.iceGatheringCompletePromise=void 0,this.iceGatheringCompleteResolve=void 0,this.iceGatheringCompleteReject=void 0),this.iceGatheringCompletePromise=new Promise((r,i)=>{this.iceGatheringCompleteResolve=r,this.iceGatheringCompleteReject=i,s>0&&(this.logger.debug("SessionDescriptionHandler.waitForIceGatheringToComplete - timeout in "+s),this.iceGatheringCompleteTimeoutId=setTimeout(()=>{this.logger.debug("SessionDescriptionHandler.waitForIceGatheringToComplete - timeout"),this.iceGatheringComplete()},s))}),this.iceGatheringCompletePromise)}initPeerConnectionEventHandlers(){if(this.logger.debug("SessionDescriptionHandler.initPeerConnectionEventHandlers"),!this._peerConnection)throw new Error("Peer connection undefined.");const e=this._peerConnection;e.onconnectionstatechange=s=>{var r;const i=e.connectionState;this.logger.debug(`SessionDescriptionHandler.onconnectionstatechange ${i}`),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.onconnectionstatechange&&this._peerConnectionDelegate.onconnectionstatechange(s)},e.ondatachannel=s=>{var r;this.logger.debug("SessionDescriptionHandler.ondatachannel"),this._dataChannel=s.channel,this.onDataChannel&&this.onDataChannel(this._dataChannel),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.ondatachannel&&this._peerConnectionDelegate.ondatachannel(s)},e.onicecandidate=s=>{var r;this.logger.debug("SessionDescriptionHandler.onicecandidate"),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.onicecandidate&&this._peerConnectionDelegate.onicecandidate(s)},e.onicecandidateerror=s=>{var r;this.logger.debug("SessionDescriptionHandler.onicecandidateerror"),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.onicecandidateerror&&this._peerConnectionDelegate.onicecandidateerror(s)},e.oniceconnectionstatechange=s=>{var r;const i=e.iceConnectionState;this.logger.debug(`SessionDescriptionHandler.oniceconnectionstatechange ${i}`),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.oniceconnectionstatechange&&this._peerConnectionDelegate.oniceconnectionstatechange(s)},e.onicegatheringstatechange=s=>{var r;const i=e.iceGatheringState;this.logger.debug(`SessionDescriptionHandler.onicegatheringstatechange ${i}`),i==="complete"&&this.iceGatheringComplete(),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.onicegatheringstatechange&&this._peerConnectionDelegate.onicegatheringstatechange(s)},e.onnegotiationneeded=s=>{var r;this.logger.debug("SessionDescriptionHandler.onnegotiationneeded"),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.onnegotiationneeded&&this._peerConnectionDelegate.onnegotiationneeded(s)},e.onsignalingstatechange=s=>{var r;const i=e.signalingState;this.logger.debug(`SessionDescriptionHandler.onsignalingstatechange ${i}`),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.onsignalingstatechange&&this._peerConnectionDelegate.onsignalingstatechange(s)},e.ontrack=s=>{var r;const i=s.track.kind,n=s.track.enabled?"enabled":"disabled";this.logger.debug(`SessionDescriptionHandler.ontrack ${i} ${n}`),this.setRemoteTrack(s.track),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.ontrack&&this._peerConnectionDelegate.ontrack(s)}}}function Zf(t){return(e,s)=>{t===void 0&&(t=Xf());const i={iceGatheringTimeout:(s==null?void 0:s.iceGatheringTimeout)!==void 0?s==null?void 0:s.iceGatheringTimeout:5e3,peerConnectionConfiguration:Object.assign(Object.assign({},Jf()),s==null?void 0:s.peerConnectionConfiguration)},n=e.userAgent.getLogger("sip.SessionDescriptionHandler");return new Mt(n,t,i)}}class Ei{constructor(e,s){if(this._state=G.Disconnected,this.transitioningState=!1,this._stateEventEmitter=new dr,this.logger=e,s){const n=s,o=n==null?void 0:n.wsServers,a=n==null?void 0:n.maxReconnectionAttempts;o!==void 0&&this.logger.warn('The transport option "wsServers" as has apparently been specified and has been deprecated. It will no longer be available starting with SIP.js release 0.16.0. Please update accordingly.'),a!==void 0&&this.logger.warn('The transport option "maxReconnectionAttempts" as has apparently been specified and has been deprecated. It will no longer be available starting with SIP.js release 0.16.0. Please update accordingly.'),o&&!s.server&&(typeof o=="string"&&(s.server=o),o instanceof Array&&(s.server=o[0]))}this.configuration=Object.assign(Object.assign({},Ei.defaultOptions),s);const r=this.configuration.server,i=Pe.parse(r,"absoluteURI");if(i===-1)throw this.logger.error(`Invalid WebSocket Server URL "${r}"`),new Error("Invalid WebSocket Server URL");if(!["wss","ws","udp"].includes(i.scheme))throw this.logger.error(`Invalid scheme in WebSocket Server URL "${r}"`),new Error("Invalid scheme in WebSocket Server URL");this._protocol=i.scheme.toUpperCase()}dispose(){return this.disconnect()}get protocol(){return this._protocol}get server(){return this.configuration.server}get state(){return this._state}get stateChange(){return this._stateEventEmitter}get ws(){return this._ws}connect(){return this._connect()}disconnect(){return this._disconnect()}isConnected(){return this.state===G.Connected}send(e){return this._send(e)}_connect(){switch(this.logger.log(`Connecting ${this.server}`),this.state){case G.Connecting:if(this.transitioningState)return Promise.reject(this.transitionLoopDetectedError(G.Connecting));if(!this.connectPromise)throw new Error("Connect promise must be defined.");return this.connectPromise;case G.Connected:if(this.transitioningState)return Promise.reject(this.transitionLoopDetectedError(G.Connecting));if(this.connectPromise)throw new Error("Connect promise must not be defined.");return Promise.resolve();case G.Disconnecting:if(this.connectPromise)throw new Error("Connect promise must not be defined.");try{this.transitionState(G.Connecting)}catch(s){if(s instanceof Ks)return Promise.reject(s);throw s}break;case G.Disconnected:if(this.connectPromise)throw new Error("Connect promise must not be defined.");try{this.transitionState(G.Connecting)}catch(s){if(s instanceof Ks)return Promise.reject(s);throw s}break;default:throw new Error("Unknown state")}let e;try{e=new WebSocket(this.server,"sip"),e.binaryType="arraybuffer",e.addEventListener("close",s=>this.onWebSocketClose(s,e)),e.addEventListener("error",s=>this.onWebSocketError(s,e)),e.addEventListener("open",s=>this.onWebSocketOpen(s,e)),e.addEventListener("message",s=>this.onWebSocketMessage(s,e)),this._ws=e}catch(s){return this._ws=void 0,this.logger.error("WebSocket construction failed."),this.logger.error(s.toString()),new Promise((r,i)=>{this.connectResolve=r,this.connectReject=i,this.transitionState(G.Disconnected,s)})}return this.connectPromise=new Promise((s,r)=>{this.connectResolve=s,this.connectReject=r,this.connectTimeout=setTimeout(()=>{this.logger.warn("Connect timed out. Exceeded time set in configuration.connectionTimeout: "+this.configuration.connectionTimeout+"s."),e.close(1e3)},this.configuration.connectionTimeout*1e3)}),this.connectPromise}_disconnect(){switch(this.logger.log(`Disconnecting ${this.server}`),this.state){case G.Connecting:if(this.disconnectPromise)throw new Error("Disconnect promise must not be defined.");try{this.transitionState(G.Disconnecting)}catch(s){if(s instanceof Ks)return Promise.reject(s);throw s}break;case G.Connected:if(this.disconnectPromise)throw new Error("Disconnect promise must not be defined.");try{this.transitionState(G.Disconnecting)}catch(s){if(s instanceof Ks)return Promise.reject(s);throw s}break;case G.Disconnecting:if(this.transitioningState)return Promise.reject(this.transitionLoopDetectedError(G.Disconnecting));if(!this.disconnectPromise)throw new Error("Disconnect promise must be defined.");return this.disconnectPromise;case G.Disconnected:if(this.transitioningState)return Promise.reject(this.transitionLoopDetectedError(G.Disconnecting));if(this.disconnectPromise)throw new Error("Disconnect promise must not be defined.");return Promise.resolve();default:throw new Error("Unknown state")}if(!this._ws)throw new Error("WebSocket must be defined.");const e=this._ws;return this.disconnectPromise=new Promise((s,r)=>{this.disconnectResolve=s,this.disconnectReject=r;try{e.close(1e3)}catch(i){throw this.logger.error("WebSocket close failed."),this.logger.error(i.toString()),i}}),this.disconnectPromise}_send(e){if(this.configuration.traceSip===!0&&this.logger.log(`Sending WebSocket message:

`+e+`
`),this._state!==G.Connected)return Promise.reject(new Error("Not connected."));if(!this._ws)throw new Error("WebSocket undefined.");try{this._ws.send(e)}catch(s){return s instanceof Error?Promise.reject(s):Promise.reject(new Error("WebSocket send failed."))}return Promise.resolve()}onWebSocketClose(e,s){if(s!==this._ws)return;const r=`WebSocket closed ${this.server} (code: ${e.code})`,i=this.disconnectPromise?void 0:new Error(r);i&&this.logger.warn("WebSocket closed unexpectedly"),this.logger.log(r),this._ws=void 0,this.transitionState(G.Disconnected,i)}onWebSocketError(e,s){s===this._ws&&this.logger.error("WebSocket error occurred.")}onWebSocketMessage(e,s){if(s!==this._ws)return;const r=e.data;let i;if(/^(\r\n)+$/.test(r)){this.clearKeepAliveTimeout(),this.configuration.traceSip===!0&&this.logger.log("Received WebSocket message with CRLF Keep Alive response");return}if(!r){this.logger.warn("Received empty message, discarding...");return}if(typeof r!="string"){try{i=new TextDecoder().decode(new Uint8Array(r))}catch(n){this.logger.error(n.toString()),this.logger.error("Received WebSocket binary message failed to be converted into string, message discarded");return}this.configuration.traceSip===!0&&this.logger.log(`Received WebSocket binary message:

`+i+`
`)}else i=r,this.configuration.traceSip===!0&&this.logger.log(`Received WebSocket text message:

`+i+`
`);if(this.state!==G.Connected){this.logger.warn("Received message while not connected, discarding...");return}if(this.onMessage)try{this.onMessage(i)}catch(n){throw this.logger.error(n.toString()),this.logger.error("Exception thrown by onMessage callback"),n}}onWebSocketOpen(e,s){s===this._ws&&this._state===G.Connecting&&(this.logger.log(`WebSocket opened ${this.server}`),this.transitionState(G.Connected))}transitionLoopDetectedError(e){let s="A state transition loop has been detected.";return s+=` An attempt to transition from ${this._state} to ${e} before the prior transition completed.`,s+=" Perhaps you are synchronously calling connect() or disconnect() from a callback or state change handler?",this.logger.error(s),new Ks("Loop detected.")}transitionState(e,s){const r=()=>{throw new Error(`Invalid state transition from ${this._state} to ${e}`)};if(this.transitioningState)throw this.transitionLoopDetectedError(e);switch(this.transitioningState=!0,this._state){case G.Connecting:e!==G.Connected&&e!==G.Disconnecting&&e!==G.Disconnected&&r();break;case G.Connected:e!==G.Disconnecting&&e!==G.Disconnected&&r();break;case G.Disconnecting:e!==G.Connecting&&e!==G.Disconnected&&r();break;case G.Disconnected:e!==G.Connecting&&r();break;default:throw new Error("Unknown state.")}const i=this._state;this._state=e;const n=this.connectResolve,o=this.connectReject;i===G.Connecting&&(this.connectPromise=void 0,this.connectResolve=void 0,this.connectReject=void 0);const a=this.disconnectResolve,c=this.disconnectReject;if(i===G.Disconnecting&&(this.disconnectPromise=void 0,this.disconnectResolve=void 0,this.disconnectReject=void 0),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0),this.logger.log(`Transitioned from ${i} to ${this._state}`),this._stateEventEmitter.emit(this._state),e===G.Connected&&(this.startSendingKeepAlives(),this.onConnect))try{this.onConnect()}catch(d){throw this.logger.error(d.toString()),this.logger.error("Exception thrown by onConnect callback"),d}if(i===G.Connected&&(this.stopSendingKeepAlives(),this.onDisconnect))try{s?this.onDisconnect(s):this.onDisconnect()}catch(d){throw this.logger.error(d.toString()),this.logger.error("Exception thrown by onDisconnect callback"),d}if(i===G.Connecting){if(!n)throw new Error("Connect resolve undefined.");if(!o)throw new Error("Connect reject undefined.");e===G.Connected?n():o(s||new Error("Connect aborted."))}if(i===G.Disconnecting){if(!a)throw new Error("Disconnect resolve undefined.");if(!c)throw new Error("Disconnect reject undefined.");e===G.Disconnected?a():c(s||new Error("Disconnect aborted."))}this.transitioningState=!1}clearKeepAliveTimeout(){this.keepAliveDebounceTimeout&&clearTimeout(this.keepAliveDebounceTimeout),this.keepAliveDebounceTimeout=void 0}sendKeepAlive(){return this.keepAliveDebounceTimeout?Promise.resolve():(this.keepAliveDebounceTimeout=setTimeout(()=>{this.clearKeepAliveTimeout()},this.configuration.keepAliveDebounce*1e3),this.send(`\r
\r
`))}startSendingKeepAlives(){const e=s=>{const r=s*.8;return 1e3*(Math.random()*(s-r)+r)};this.configuration.keepAliveInterval&&!this.keepAliveInterval&&(this.keepAliveInterval=setInterval(()=>{this.sendKeepAlive(),this.startSendingKeepAlives()},e(this.configuration.keepAliveInterval)))}stopSendingKeepAlives(){this.keepAliveInterval&&clearInterval(this.keepAliveInterval),this.keepAliveDebounceTimeout&&clearTimeout(this.keepAliveDebounceTimeout),this.keepAliveInterval=void 0,this.keepAliveDebounceTimeout=void 0}}Ei.defaultOptions={server:"",connectionTimeout:5,keepAliveInterval:0,keepAliveDebounce:10,traceSip:!0};class qt{constructor(e={}){if(this._publishers={},this._registerers={},this._sessions={},this._subscriptions={},this._state=qe.Stopped,this._stateEventEmitter=new dr,this.delegate=e.delegate,this.options=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},qt.defaultOptions()),{sipjsId:gs(5)}),{uri:new It("sip","anonymous."+gs(6),"anonymous.invalid")}),{viaHost:gs(12)+".invalid"}),qt.stripUndefinedProperties(e)),this.options.hackIpInContact)if(typeof this.options.hackIpInContact=="boolean"&&this.options.hackIpInContact){const i=Math.floor(Math.random()*254+1);this.options.viaHost="192.0.2."+i}else this.options.hackIpInContact&&(this.options.viaHost=this.options.hackIpInContact);switch(this.loggerFactory=new Af,this.logger=this.loggerFactory.getLogger("sip.UserAgent"),this.loggerFactory.builtinEnabled=this.options.logBuiltinEnabled,this.loggerFactory.connector=this.options.logConnector,this.options.logLevel){case"error":this.loggerFactory.level=Le.error;break;case"warn":this.loggerFactory.level=Le.warn;break;case"log":this.loggerFactory.level=Le.log;break;case"debug":this.loggerFactory.level=Le.debug;break}if(this.options.logConfiguration&&(this.logger.log("Configuration:"),Object.keys(this.options).forEach(s=>{const r=this.options[s];switch(s){case"uri":case"sessionDescriptionHandlerFactory":this.logger.log("· "+s+": "+r);break;case"authorizationPassword":this.logger.log("· "+s+": NOT SHOWN");break;case"transportConstructor":this.logger.log("· "+s+": "+r.name);break;default:this.logger.log("· "+s+": "+JSON.stringify(r))}})),this.options.transportOptions){const s=this.options.transportOptions,r=s.maxReconnectionAttempts,i=s.reconnectionTimeout;r!==void 0&&this.logger.warn('The transport option "maxReconnectionAttempts" as has apparently been specified and has been deprecated. It will no longer be available starting with SIP.js release 0.16.0. Please update accordingly.'),i!==void 0&&this.logger.warn('The transport option "reconnectionTimeout" as has apparently been specified and has been deprecated. It will no longer be available starting with SIP.js release 0.16.0. Please update accordingly.'),e.reconnectionDelay===void 0&&i!==void 0&&(this.options.reconnectionDelay=i),e.reconnectionAttempts===void 0&&r!==void 0&&(this.options.reconnectionAttempts=r)}if(e.reconnectionDelay!==void 0&&this.logger.warn('The user agent option "reconnectionDelay" as has apparently been specified and has been deprecated. It will no longer be available starting with SIP.js release 0.16.0. Please update accordingly.'),e.reconnectionAttempts!==void 0&&this.logger.warn('The user agent option "reconnectionAttempts" as has apparently been specified and has been deprecated. It will no longer be available starting with SIP.js release 0.16.0. Please update accordingly.'),this._transport=new this.options.transportConstructor(this.getLogger("sip.Transport"),this.options.transportOptions),this.initTransportCallbacks(),this._contact=this.initContact(),this._instanceId=this.options.instanceId?this.options.instanceId:qt.newUUID(),Pe.parse(this._instanceId,"uuid")===-1)throw new Error("Invalid instanceId.");this._userAgentCore=this.initCore()}static makeURI(e){return Pe.URIParse(e)}static defaultOptions(){return{allowLegacyNotifications:!1,authorizationHa1:"",authorizationPassword:"",authorizationUsername:"",delegate:{},contactName:"",contactParams:{transport:"ws"},displayName:"",forceRport:!1,gracefulShutdown:!0,hackAllowUnregisteredOptionTags:!1,hackIpInContact:!1,hackViaTcp:!1,instanceId:"",instanceIdAlwaysAdded:!1,logBuiltinEnabled:!0,logConfiguration:!0,logConnector:()=>{},logLevel:"log",noAnswerTimeout:60,preloadedRouteSet:[],reconnectionAttempts:0,reconnectionDelay:4,sendInitialProvisionalResponse:!0,sessionDescriptionHandlerFactory:Zf(),sessionDescriptionHandlerFactoryOptions:{},sipExtension100rel:pt.Unsupported,sipExtensionReplaces:pt.Unsupported,sipExtensionExtraSupported:[],sipjsId:"",transportConstructor:Ei,transportOptions:{},uri:new It("sip","anonymous","anonymous.invalid"),userAgentString:"SIP.js/"+mf,viaHost:""}}static newUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const r=Math.floor(Math.random()*16);return(s==="x"?r:r%4+8).toString(16)})}static stripUndefinedProperties(e){return Object.keys(e).reduce((s,r)=>(e[r]!==void 0&&(s[r]=e[r]),s),{})}get configuration(){return this.options}get contact(){return this._contact}get instanceId(){return this._instanceId}get state(){return this._state}get stateChange(){return this._stateEventEmitter}get transport(){return this._transport}get userAgentCore(){return this._userAgentCore}getLogger(e,s){return this.loggerFactory.getLogger(e,s)}getLoggerFactory(){return this.loggerFactory}isConnected(){return this.transport.isConnected()}reconnect(){return this.state===qe.Stopped?Promise.reject(new Error("User agent stopped.")):Promise.resolve().then(()=>this.transport.connect())}start(){return this.state===qe.Started?(this.logger.warn("User agent already started"),Promise.resolve()):(this.logger.log(`Starting ${this.configuration.uri}`),this.transitionState(qe.Started),this.transport.connect())}async stop(){if(this.state===qe.Stopped)return this.logger.warn("User agent already stopped"),Promise.resolve();if(this.logger.log(`Stopping ${this.configuration.uri}`),!this.options.gracefulShutdown)return this.logger.log("Dispose of transport"),this.transport.dispose().catch(a=>{throw this.logger.error(a.message),a}),this.logger.log("Dispose of core"),this.userAgentCore.dispose(),this._publishers={},this._registerers={},this._sessions={},this._subscriptions={},this.transitionState(qe.Stopped),Promise.resolve();const e=Object.assign({},this._publishers),s=Object.assign({},this._registerers),r=Object.assign({},this._sessions),i=Object.assign({},this._subscriptions),n=this.transport,o=this.userAgentCore;this.logger.log("Dispose of registerers");for(const a in s)s[a]&&await s[a].dispose().catch(c=>{throw this.logger.error(c.message),delete this._registerers[a],c});this.logger.log("Dispose of sessions");for(const a in r)r[a]&&await r[a].dispose().catch(c=>{throw this.logger.error(c.message),delete this._sessions[a],c});this.logger.log("Dispose of subscriptions");for(const a in i)i[a]&&await i[a].dispose().catch(c=>{throw this.logger.error(c.message),delete this._subscriptions[a],c});this.logger.log("Dispose of publishers");for(const a in e)e[a]&&await e[a].dispose().catch(c=>{throw this.logger.error(c.message),delete this._publishers[a],c});this.logger.log("Dispose of transport"),await n.dispose().catch(a=>{throw this.logger.error(a.message),a}),this.logger.log("Dispose of core"),o.dispose(),this.transitionState(qe.Stopped)}_makeInviter(e,s){return new Lr(this,e,s)}attemptReconnection(e=1){const s=this.options.reconnectionAttempts,r=this.options.reconnectionDelay;if(e>s){this.logger.log("Maximum reconnection attempts reached");return}this.logger.log(`Reconnection attempt ${e} of ${s} - trying`),setTimeout(()=>{this.reconnect().then(()=>{this.logger.log(`Reconnection attempt ${e} of ${s} - succeeded`)}).catch(i=>{this.logger.error(i.message),this.logger.log(`Reconnection attempt ${e} of ${s} - failed`),this.attemptReconnection(++e)})},e===1?0:r*1e3)}initContact(){const e=this.options.contactName!==""?this.options.contactName:gs(8),s=this.options.contactParams;return{pubGruu:void 0,tempGruu:void 0,uri:new It("sip",e,this.options.viaHost,void 0,s),toString:(i={})=>{const n=i.anonymous||!1,o=i.outbound||!1,a=i.register||!1;let c="<";return n?c+=this.contact.tempGruu||`sip:anonymous@anonymous.invalid;transport=${s.transport?s.transport:"ws"}`:a?c+=this.contact.uri:c+=this.contact.pubGruu||this.contact.uri,o&&(c+=";ob"),c+=">",this.options.instanceIdAlwaysAdded&&(c+=';+sip.instance="<urn:uuid:'+this._instanceId+'>"'),c}}}initCore(){let e=[];e.push("outbound"),this.options.sipExtension100rel===pt.Supported&&e.push("100rel"),this.options.sipExtensionReplaces===pt.Supported&&e.push("replaces"),this.options.sipExtensionExtraSupported&&e.push(...this.options.sipExtensionExtraSupported),this.options.hackAllowUnregisteredOptionTags||(e=e.filter(n=>Rf[n])),e=Array.from(new Set(e));const s=e.slice();(this.contact.pubGruu||this.contact.tempGruu)&&s.push("gruu");const r={aor:this.options.uri,contact:this.contact,displayName:this.options.displayName,loggerFactory:this.loggerFactory,hackViaTcp:this.options.hackViaTcp,routeSet:this.options.preloadedRouteSet,supportedOptionTags:e,supportedOptionTagsResponse:s,sipjsId:this.options.sipjsId,userAgentHeaderFieldValue:this.options.userAgentString,viaForceRport:this.options.forceRport,viaHost:this.options.viaHost,authenticationFactory:()=>{const n=this.options.authorizationUsername?this.options.authorizationUsername:this.options.uri.user,o=this.options.authorizationPassword?this.options.authorizationPassword:void 0,a=this.options.authorizationHa1?this.options.authorizationHa1:void 0;return new $f(this.getLoggerFactory(),a,n,o)},transportAccessor:()=>this.transport},i={onInvite:n=>{var o;const a=new Wc(this,n);if(n.delegate={onCancel:c=>{a._onCancel(c)},onTransportError:c=>{this.logger.error("A transport error has occurred while handling an incoming INVITE request.")}},n.trying(),this.options.sipExtensionReplaces!==pt.Unsupported){const d=n.message.parseHeader("replaces");if(d){const l=d.call_id;if(typeof l!="string")throw new Error("Type of call id is not string");const u=d.replaces_to_tag;if(typeof u!="string")throw new Error("Type of to tag is not string");const p=d.replaces_from_tag;if(typeof p!="string")throw new Error("type of from tag is not string");const y=l+u+p,w=this.userAgentCore.dialogs.get(y);if(!w){a.reject({statusCode:481});return}if(!w.early&&d.early_only===!0){a.reject({statusCode:486});return}const C=this._sessions[l+p]||this._sessions[l+u]||void 0;if(!C)throw new Error("Session does not exist.");a._replacee=C}}if(!((o=this.delegate)===null||o===void 0)&&o.onInvite){if(a.autoSendAnInitialProvisionalResponse){a.progress().then(()=>{var c;if(((c=this.delegate)===null||c===void 0?void 0:c.onInvite)===void 0)throw new Error("onInvite undefined.");this.delegate.onInvite(a)});return}this.delegate.onInvite(a);return}a.reject({statusCode:486})},onMessage:n=>{if(this.delegate&&this.delegate.onMessage){const o=new Vc(n);this.delegate.onMessage(o)}else n.accept()},onNotify:n=>{if(this.delegate&&this.delegate.onNotify){const o=new wn(n);this.delegate.onNotify(o)}else this.options.allowLegacyNotifications?n.accept():n.reject({statusCode:481})},onRefer:n=>{this.logger.warn("Received an out of dialog REFER request"),this.delegate&&this.delegate.onReferRequest?this.delegate.onReferRequest(n):n.reject({statusCode:405})},onRegister:n=>{this.logger.warn("Received an out of dialog REGISTER request"),this.delegate&&this.delegate.onRegisterRequest?this.delegate.onRegisterRequest(n):n.reject({statusCode:405})},onSubscribe:n=>{this.logger.warn("Received an out of dialog SUBSCRIBE request"),this.delegate&&this.delegate.onSubscribeRequest?this.delegate.onSubscribeRequest(n):n.reject({statusCode:405})}};return new zf(r,i)}initTransportCallbacks(){this.transport.onConnect=()=>this.onTransportConnect(),this.transport.onDisconnect=e=>this.onTransportDisconnect(e),this.transport.onMessage=e=>this.onTransportMessage(e)}onTransportConnect(){this.state!==qe.Stopped&&this.delegate&&this.delegate.onConnect&&this.delegate.onConnect()}onTransportDisconnect(e){this.state!==qe.Stopped&&(this.delegate&&this.delegate.onDisconnect&&this.delegate.onDisconnect(e),e&&this.options.reconnectionAttempts>0&&this.attemptReconnection())}onTransportMessage(e){const s=Mr.parseMessage(e,this.getLogger("sip.Parser"));if(!s){this.logger.warn("Failed to parse incoming message. Dropping.");return}if(this.state===qe.Stopped&&s instanceof Ps){this.logger.warn(`Received ${s.method} request while stopped. Dropping.`);return}const r=()=>{const i=["from","to","call_id","cseq","via"];for(const n of i)if(!s.hasHeader(n))return this.logger.warn(`Missing mandatory header field : ${n}.`),!1;return!0};if(s instanceof Ps){if(!r()){this.logger.warn("Request missing mandatory header field. Dropping.");return}if(!s.toTag&&s.callId.substr(0,5)===this.options.sipjsId){this.userAgentCore.replyStateless(s,{statusCode:482});return}const i=ur(s.body),n=s.getHeader("content-length");if(n&&i<Number(n)){this.userAgentCore.replyStateless(s,{statusCode:400});return}}if(s instanceof ss){if(!r()){this.logger.warn("Response missing mandatory header field. Dropping.");return}if(s.getHeaders("via").length>1){this.logger.warn("More than one Via header field present in the response. Dropping.");return}if(s.via.host!==this.options.viaHost||s.via.port!==void 0){this.logger.warn("Via sent-by in the response does not match UA Via host value. Dropping.");return}const i=ur(s.body),n=s.getHeader("content-length");if(n&&i<Number(n)){this.logger.warn("Message body length is lower than the value in Content-Length header field. Dropping.");return}}if(s instanceof Ps){this.userAgentCore.receiveIncomingRequestFromTransport(s);return}if(s instanceof ss){this.userAgentCore.receiveIncomingResponseFromTransport(s);return}throw new Error("Invalid message type.")}transitionState(e,s){const r=()=>{throw new Error(`Invalid state transition from ${this._state} to ${e}`)};switch(this._state){case qe.Started:e!==qe.Stopped&&r();break;case qe.Stopped:e!==qe.Started&&r();break;default:throw new Error("Unknown state.")}this.logger.log(`Transitioned from ${this._state} to ${e}`),this._state=e,this._stateEventEmitter.emit(this._state)}}function Qf(t){if(!t.sdp||!t.type)throw new Error("Invalid SDP");let e=t.sdp;const s=t.type;return e&&(/a=(sendrecv|sendonly|recvonly|inactive)/.test(e)?(e=e.replace(/a=sendrecv\r\n/g,`a=sendonly\r
`),e=e.replace(/a=recvonly\r\n/g,`a=inactive\r
`)):e=e.replace(/(m=[^\r]*\r\n)/g,`$1a=sendonly\r
`)),Promise.resolve({sdp:e,type:s})}const yn=(t,e=0)=>{if(e>20)return console.error("reach checking limit"),!1;if(t==null||t==="")return!0;if(Array.isArray(t))return t.length===0||t.every(s=>yn(s,e+1));if(typeof t=="object"){const s=Object.values(t);return s.length===0||s.every(r=>yn(r,e+1))}return!1},fr=Wn("manualConfigStore",{state:()=>({idleInterval:null,currentData:void 0,defaultIntMili:1150}),getters:{axiosIns:()=>{var s;const t={type:"Bearer",token:"79469eecda0962ce0d4203d1be3230730eb0702231"},e=fr();return ce.create({withCredentials:!1,baseURL:`https://${(s=e.config)==null?void 0:s.realm}`,headers:{Authorization:`${t.type} ${t.token}`}})},config:()=>De().config},actions:{async fetchPhoneData(){const t=De(),e=Bt(),r={extension:t.activeUser.extension},n=await this.axiosIns.get("/api/V1/data",{params:r}).catch(a=>a.response),o=n&&yn(n.data);if(n&&[200,201].includes(n.status)&&!o){const a=n.data.phone;this.clear(),e.initiateCall(a)}},async fetchPhoneDataOnInterval(t){t=t||this.defaultIntMili,this.idleInterval=setInterval(()=>{this.fetchPhoneData()},t)},async clear(){console.info("clear intrvl"),clearInterval(this.idleInterval),await et(),this.idleInterval=null}}}),Bt=Wn("callStore",{state:()=>({autoAnswer:"auto",elapsedTime:0,timer:null,startTimestamp:null,stopTimestamp:null,userAgentOptions:{uri:void 0,allowLegacyNotifications:!0,instanceIdAlwaysAdded:!0,authorizationPassword:void 0,userAgentString:"WebRTC Call Widget SIP Client v1.0.0",logLevel:"debug",contactParams:{transport:"wss"},transportOptions:{server:""}},userAgent:null,registerer:null,callData:null,invitation:null,session:null,target:null,transferReferral:null,audioElementId:"remote-audio",localMediaPermission:!1,localMediaStream:void 0,attendedCancel:!1,attendedApply:!1,sipStatus:{registerStatus:null}}),getters:{isUserAgentConnected:t=>!!t.userAgent.isConnected,formatedTimeElapsed:t=>{const e=t.elapsedTime;if(!e)return"00:00:00";const s=Math.floor(e/3600),r=Math.floor(e%3600/60),i=e%60;return[String(s).padStart(2,"0"),String(r).padStart(2,"0"),String(i).padStart(2,"0")].join(":")}},actions:{async startSip(){const t=new qt(this.userAgentOptions),e={},s=new $t(t,e);this.registerer=s,this.userAgent=t,t.delegate={onInvite(r){const i=r,n=Bt(),o={inboundCallId:null,phoneNumber:i.remoteIdentity.uri.user,name:i.remoteIdentity.displayName,status:"incoming",ticketCode:null};n.incomingCall(r,i,o),i.stateChange.addListener(a=>{switch(a){case S.Establishing:console.log("incoming call establishing");break;case S.Established:n.remoteMedia(),console.log("incoming call established");break;case S.Initial:console.log("incoming call initial");break;case S.Terminating:console.log("incoming call terminating");break;case S.Terminated:n.terminated(),console.log("incoming call terminated");break}})},onRefer(r){var a;const i=De(),n=Bt(),o=((a=i.config)==null?void 0:a.auto_answer)||"";n.transferReferral=r,o==="auto"?r.accept().then(()=>{r.makeInviter().invite(),n.startTimestamp=new Date}):o==="manual"?n.handleIncomingTransfer(r):console.error("auto answer is specified other than on / off")},onDisconnect(r){const i=Bt();s.unregister(),r&&i.reconnect()}},t.start().then(()=>{s.register(),s.stateChange.addListener(r=>{switch(console.log("Status Register SIP:",r),r){case ie.Initial:this.sipStatus.registerStatus="Initial";break;case ie.Registered:this.sipStatus.registerStatus="Registered";break;case ie.Unregistered:this.sipStatus.registerStatus="Unregistered";break;case ie.Terminated:this.sipStatus.registerStatus="Terminated";break}})})},reconnect(){let s=!1;const r=(i=1)=>{s||i>3||(s=!0,setTimeout(()=>{var n;(n=this.userAgent)==null||n.reconnect().then(()=>{s=!1}).catch(()=>{s=!1,r(++i)})},i===1?0:4*1e3))};r()},stopSip(){var t;(t=this.userAgent)==null||t.stop().then(()=>{var e;(e=this.registerer)==null||e.unregister(),this.registerer.stateChange.removeListener(s=>{console.log("Status Register SIP:",s)})})},incomingCall(t,e,s){var i;(i=this.userAgent)==null||i.start();const r=De();r.activeCall={number:s.phoneNumber,status:"incoming",type:"incoming"},this.invitation=t,this.session=e,this.callData=s},remoteMedia(){var i;const t=new MediaStream;((i=this.session)==null?void 0:i.sessionDescriptionHandler).peerConnection.getReceivers().forEach(n=>{n.track&&t.addTrack(n.track)});const r=document.createElement("audio");r.id="remote-audio",r.preload="auto",r.style.visibility="hidden",r&&(r.srcObject=t,r.play())},InitiateLocalMedia(){navigator.mediaDevices.getUserMedia({audio:!0}).then(t=>{this.localMediaStream=t,this.localMediaPermission=!0}).catch(()=>{this.localMediaPermission=!1})},async answerCall(){if(!this.invitation)return;const t=De(),s={sessionDescriptionHandlerOptions:{constraints:{audio:!0,video:!1}}};await this.invitation.accept(s),t.activeCall={...t.activeCall,type:"incoming",status:"connected"},this.timer=setInterval(()=>{this.elapsedTime++},1e3),this.startTimestamp=new Date},async rejectCall(){if(!this.invitation)return;const t=De();await this.invitation.reject().catch(e=>console.error("failed to hangup a call",e)),this.invitation=null,t.activeCall=void 0},async terminated(){const t=De();this.stopTimestamp=new Date,this.timer&&clearInterval(this.timer),t.activeCall=void 0,this.timer=null},async blindTransfer(t){const e=De();if(!this.session)return;this.stopTimestamp=new Date;const s=qt.makeURI(`sip:${t}@${e.config.realm}`);this.session.refer(s)},async attendendTransfer(t){const e=De();if(!this.session&&!this.userAgent)return;let s={sessionDescriptionHandlerModifiers:[Qf]};this.session.invite(s);const r=qt.makeURI(`sip:${t}@${e.config.realm}`),i={sessionDescriptionHandlerOptions:{constraints:{audio:!0,video:!1}}},n=new Lr(this.userAgent,r,i);n.invite(),n.stateChange.addListener(o=>{var a;switch(o){case S.Establishing:break;case S.Established:const c=new MediaStream;(n==null?void 0:n.sessionDescriptionHandler).peerConnection.getReceivers().forEach(y=>{y.track&&c.addTrack(y.track)});const u=document.getElementById("audioElementId");u.srcObject=c,u.play();const p=setInterval(()=>{var y;this.attendedCancel===!0&&(n.bye(),s={sessionDescriptionHandlerModifiers:[]},(y=this.session)==null||y.invite(s),this.attendedCancel=!1,clearInterval(p)),this.attendedApply===!0&&(this.stopTimestamp=new Date,n.bye(),this.session.refer(r),this.attendedApply=!1,clearInterval(p))},1e3);break;case S.Terminated:s={sessionDescriptionHandlerModifiers:[]},(a=this.session)==null||a.invite(s);break}})},async handleIncomingTransfer(t){if(!this.transferReferral)return;const e=De();e.activeCall={number:`transfer call - ${t.referTo.displayName}`,status:"incoming",type:"incoming"}},async answerRejectIncomingTransfer({answer:t}){var e;if(this.transferReferral)switch(t){case!0:(e=this.transferReferral)==null||e.accept().then(()=>{var s;this.startTimestamp=new Date,(s=this.transferReferral)==null||s.makeInviter().invite()});break;case!1:this.transferReferral.reject();break}},async initiateCall(t){const e=De(),s=fr();await this.userAgent.start(),t.toString();const r=qt.makeURI(`sip:${t}@${e.config.realm}`);this.session=new Lr(this.userAgent,r,{extraHeaders:[`Call-ID: ${t}7347834783748734}`]}),this.session.invite(),this.session.stateChange.addListener(i=>{switch(i){case S.Establishing:e.activeCall={number:t,status:"dialing",type:"outgoing"},s.clear();break;case S.Established:console.log("outgoing call connected"),e.activeCall={number:t,status:"connected",type:"outgoing"},this.timer=setInterval(()=>{this.elapsedTime++},1e3),this.remoteMedia();break;case S.Terminating:console.log("outgoing call terminating");break;case S.Terminated:e.activeCall=void 0,this.terminated();break}})},async endCall(){var e;const t=De();switch(this.session.state){case S.Establishing:this.session instanceof Lr?await this.session.cancel().catch(s=>console.error("cancel call error",s)):this.session instanceof Wc&&(await this.session.reject().catch(s=>console.error("reject call error",s)),t.activeCall=void 0);break;case S.Established:(e=this.session)==null||e.bye();break}}}}),De=Wn("configStore",{state:()=>({pageType:"idle",config:void 0,activeCall:void 0,activeUser:void 0,isLoading:{submitLogin:!1},agentIdentity:{name:"Agent 101",desc:"123123"},transfer:{data:{},intended:{handshake:!1},isLoading:!1},callHistoryList:{data:[{callType:"incoming",status:"answer",number:"1231234",time:"01 Feb 24. 12:15 PM",timeElapsed:"00:02:26"}],isLoading:!1,metadata:{per_page:0,current_page:0,last_page:0}}}),getters:{isActiveCallAvailable:t=>!!t.activeCall,isUserLoggedIn:t=>!!t.activeUser,cssVars:()=>({"--primary-bg":"#08c68d","--secondary-bg":"#08C6AB","--grey":"#D1D5DE","--white":"#fafafa","--primary":"#6E44FF","--light-front":"#F0EFF4","--dark-front":"#2C302E","--success":"#7EE348","--error":"#CC2936","--secondary":"#FFA400","--accent-1":"#F46036","--info":"#00A6ED"})},actions:{async validateWidget({token:t}){var i;const e="/call/widget/verify-token",s={token:t},r=await ce.post(e,s).catch(n=>n.response);r&&[200,201].includes(r.status)&&(this.config=r.data,ce.defaults.baseURL=/^https?:\/\//i.test(this.config.realm)?(i=this.config)==null?void 0:i.realm:`https://${this.config.realm}`,console.log(ce.defaults.baseURL))},async signInWidget({extension:t,secret:e}){var n;const s=Bt(),r=fr();this.isLoading.submitLogin=!0;const i=this.isUserLoggedIn?this.activeUser:{extension:t,secret:e};s.autoAnswer=((n=this.config)==null?void 0:n.auto_answer)||"manual",s.userAgentOptions={...s.userAgentOptions,uri:qt.makeURI(`sip${i.extension}@autodial-api.c-icare.cc`),authorizationPassword:i.secret,transportOptions:{server:"wss://autodial-api.c-icare.cc:2790/ws"}},this.isLoading.submitLogin=!1,await et(),this.activeUser=i,r.fetchPhoneData(),s.startSip()},async fetchHistoryList({loadMore:t=!1,q:e}){var c;const s=fr();this.callHistoryList.isLoading=!0;const r=`/api/V1/history-call/${(c=this.activeUser)==null?void 0:c.extension}`,i=this.callHistoryList.metadata,n={};e&&e.search&&(n.search=e.search),t&&i.current_page+1<i.last_page&&(n.page=`${i.current_page+1}`);const o=await s.axiosIns.get(r,{params:n}).catch(d=>d.response);o&&[201,200].includes(o.status)&&Object.keys(this.callHistoryList.metadata).forEach(d=>{this.callHistoryList.metadata[d]=o.data[d]}),this.callHistoryList.isLoading=!1},async transferCall({}){this.transfer.isLoading=!0;const t={},s=await ce.post("",t).catch(i=>i.response);return this.transfer.isLoading=!1,{success:!!s&&[201,200].includes(s.status),message:s==null?void 0:s.data.message}},async initiateCall({phone:t}){const e="",s={phone:t},r=await ce.post(e,s).catch(n=>n.response),i=[201,200].includes(r.status);return r&&i&&(this.activeCall={number:t,status:"dialing",type:"outgoing"}),{success:i,message:(r==null?void 0:r.data.msg)||""}},async endCall({type:t="cancel"}){console.log(t);const e="",s={},r=await ce.post(e,s).catch(n=>n.response),i=[201,200].includes(r.status);return r&&i&&(console.log("connection severed"),this.activeCall=void 0),{success:i,message:(r==null?void 0:r.data.msg)||""}}}}),eg="data:image/svg+xml,%3csvg%20version='1.1'%20id='Capa_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0%200%20512%20512'%20xml:space='preserve'%3e%3cg%3e%3cg%3e%3crect%20x='128'%20y='256'%20style='fill:%235C546A;'%20width='16'%20height='136'/%3e%3c/g%3e%3cg%3e%3cpath%20style='fill:%238A8895;'%20d='M128,248h-24c-4.418,0-8-3.582-8-8v-48c0-4.418,3.582-8,8-8h24V248z'/%3e%3c/g%3e%3cg%3e%3cpath%20style='fill:%237E5C62;'%20d='M323.625,0H198.036c-18.17,0-33.444,12.604-37.558,29.524%20c-33.256,4.227-59.049,32.699-59.049,67.082v48.303c0,24.897,10.569,48.123,28.982,64.63V154.57%20c0-26.633,21.67-48.303,48.303-48.303h164.231c21.312,0,38.643,17.335,38.643,38.643v64.619%20c18.417-16.503,28.982-39.729,28.982-64.619V86.946C410.57,39.006,371.569,0,323.625,0z'/%3e%3c/g%3e%3cg%3e%3cg%3e%3cpath%20style='fill:%23FCC78D;'%20d='M256,347.784c-33.744,0-65.411-20.38-88-43.784c0-2,0,33.833,0,40%20c2.439,1.491,1.138,18.88,1.507,21.926c4.821,39.228,42.001,68.804,86.493,68.804c44.482,0,81.663-29.581,86.493-68.804%20c0.374-3.05-0.969-20.439,1.507-21.926c0-16.667,0-29.833,0-40C321.411,327.403,289.744,347.784,256,347.784z'/%3e%3c/g%3e%3c/g%3e%3cg%3e%3cg%3e%3cpath%20style='fill:%23FFB87F;'%20d='M341.063,311.682c-22.4,22.312-52.218,36.102-85.063,36.102c-33.744,0-65.411-20.38-88-43.784%20c0,10.259,0,46.333,0,40c2.439,1.491,1.138,18.88,1.507,21.926c2.131,17.34,10.6,32.778,23.213,44.625%20C250.887,402.359,316.906,344.923,341.063,311.682z'/%3e%3c/g%3e%3c/g%3e%3cg%3e%3cpath%20style='fill:%235C546A;'%20d='M144,264h-24c-4.418,0-8-3.582-8-8v-80c0-4.418,3.582-8,8-8h24V264z'/%3e%3c/g%3e%3cg%3e%3cpath%20style='fill:%238A8895;'%20d='M384,248h24c4.418,0,8-3.582,8-8v-48c0-4.418-3.582-8-8-8h-24V248z'/%3e%3c/g%3e%3cg%3e%3cpath%20style='fill:%235C546A;'%20d='M368,264h24c4.418,0,8-3.582,8-8v-80c0-4.418-3.582-8-8-8h-24V264z'/%3e%3c/g%3e%3cg%3e%3cg%3e%3cpath%20style='fill:%23FFE0B1;'%20d='M342.946,106.267H178.715c-26.633,0-48.303,21.67-48.303,48.303v57.964%20c0,74.578,56.341,135.249,125.588,135.249s125.588-60.672,125.588-135.249V144.91%20C381.588,123.603,364.258,106.267,342.946,106.267z'/%3e%3c/g%3e%3c/g%3e%3cg%3e%3cg%3e%3cpath%20style='fill:%235C546A;'%20d='M324,311.313c-19.328,0-39.148-8.672-57.406-25.418c-3.258-2.984-3.477-8.047-0.492-11.301%20c2.992-3.27,8.063-3.473,11.305-0.488c20.18,18.5,42.023,25.191,61.578,18.809c19.133-6.25,34.383-24.691,38.836-46.98%20c0.859-4.328,5.023-7.16,9.414-6.277c4.328,0.863,7.141,5.078,6.273,9.41c-5.57,27.863-25.023,51.043-49.563,59.059%20C337.422,310.258,330.742,311.313,324,311.313z'/%3e%3c/g%3e%3c/g%3e%3cg%3e%3ccircle%20style='fill:%238A8895;'%20cx='272'%20cy='280'%20r='16'/%3e%3c/g%3e%3cg%3e%3cpath%20style='fill:%23527991;'%20d='M430.659,388.39L376,375.529L256,440l-120-64.471L81.341,388.39%20C52.432,395.192,32,420.99,32,450.689V488c0,13.255,10.745,24,24,24h400c13.255,0,24-10.745,24-24v-37.311%20C480,420.99,459.568,395.192,430.659,388.39z'/%3e%3c/g%3e%3cg%3e%3crect%20x='248'%20y='432'%20style='fill:%235C546A;'%20width='16'%20height='80'/%3e%3c/g%3e%3cg%3e%3cpath%20style='fill:%235D647F;'%20d='M256,432l-48.415,42.363c-7.884,6.899-20.162,4.485-24.847-4.886L136,376l32-32L256,432z'/%3e%3c/g%3e%3cg%3e%3cpath%20style='fill:%235D647F;'%20d='M256,432l48.415,42.363c7.884,6.899,20.162,4.485,24.847-4.886L376,376l-32-32L256,432z'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",tg="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20fill='%231b1b1b'%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='18'%20height='18'%20viewBox='0%200%2072%2072'%20enable-background='new%200%200%2072%2072'%20xml:space='preserve'%3e%3cg%3e%3cpath%20d='M53.678,61.824c-2.27,0-4.404-0.885-6.01-2.49L36,47.667L24.332,59.334c-1.604,1.605-3.739,2.49-6.01,2.49%20s-4.404-0.885-6.01-2.49c-1.605-1.604-2.49-3.739-2.49-6.01c0-2.271,0.885-4.405,2.491-6.011l11.666-11.667l-10.96-10.961%20c-1.605-1.604-2.49-3.739-2.49-6.01s0.885-4.405,2.49-6.01c1.605-1.605,3.739-2.49,6.011-2.49c2.271,0,4.405,0.885,6.01,2.49%20L36,23.626l10.96-10.96c1.605-1.605,3.738-2.49,6.01-2.49s4.406,0.885,6.01,2.49c1.605,1.604,2.49,3.739,2.49,6.01%20s-0.885,4.405-2.49,6.01L48.021,35.646l11.666,11.668c1.605,1.604,2.49,3.738,2.49,6.01c0,2.271-0.885,4.405-2.49,6.01%20C58.084,60.939,55.949,61.824,53.678,61.824z%20M36,42.839c0.511,0,1.023,0.195,1.414,0.586l13.082,13.081%20c0.852,0.851,1.98,1.318,3.182,1.318c1.203,0,2.332-0.468,3.182-1.318c0.852-0.851,1.318-1.98,1.318-3.182%20c0-1.202-0.467-2.332-1.318-3.181l-13.08-13.083c-0.781-0.781-0.781-2.047,0-2.828l12.373-12.375%20c0.852-0.851,1.318-1.979,1.318-3.182s-0.467-2.331-1.318-3.182c-0.85-0.851-1.98-1.318-3.182-1.318s-2.332,0.468-3.18,1.318%20L37.414,27.868c-0.781,0.781-2.046,0.781-2.828,0L22.21,15.494c-0.85-0.851-1.979-1.318-3.181-1.318%20c-1.202,0-2.332,0.468-3.182,1.318c-0.851,0.851-1.319,1.979-1.319,3.182s0.469,2.331,1.318,3.182l12.374,12.375%20c0.781,0.781,0.781,2.047,0,2.828L15.14,50.143c-0.85,0.85-1.318,1.979-1.318,3.182c0,1.201,0.469,2.331,1.318,3.182%20c0.851,0.851,1.98,1.318,3.182,1.318c1.202,0,2.332-0.468,3.182-1.318l13.083-13.081C34.977,43.034,35.489,42.839,36,42.839z'/%3e%3c/g%3e%3c/svg%3e";function hs(t){return typeof t=="function"?t():q(t)}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const zo=()=>{};function sg(t,e){function s(...r){return new Promise((i,n)=>{Promise.resolve(t(()=>e.apply(this,r),{fn:e,thisArg:this,args:r})).then(i).catch(n)})}return s}function rg(t,e={}){let s,r,i=zo;const n=a=>{clearTimeout(a),i(),i=zo};return a=>{const c=hs(t),d=hs(e.maxWait);return s&&n(s),c<=0||d!==void 0&&d<=0?(r&&(n(r),r=null),Promise.resolve(a())):new Promise((l,u)=>{i=e.rejectOnCancel?u:l,d&&!r&&(r=setTimeout(()=>{s&&n(s),r=null,l(a())},d)),s=setTimeout(()=>{r&&n(r),r=null,l(a())},c)})}}function Qr(t,e=200,s={}){return sg(rg(e,s),t)}const ig=/[YMDHhms]o|\[([^\]]+)\]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a{1,2}|A{1,2}|m{1,2}|s{1,2}|Z{1,2}|SSS/g;function ng(t,e,s,r){let i=t<12?"AM":"PM";return r&&(i=i.split("").reduce((n,o)=>n+=`${o}.`,"")),s?i.toLowerCase():i}function ds(t){const e=["th","st","nd","rd"],s=t%100;return t+(e[(s-20)%10]||e[s]||e[0])}function og(t,e,s={}){var r;const i=t.getFullYear(),n=t.getMonth(),o=t.getDate(),a=t.getHours(),c=t.getMinutes(),d=t.getSeconds(),l=t.getMilliseconds(),u=t.getDay(),p=(r=s.customMeridiem)!=null?r:ng,y={Yo:()=>ds(i),YY:()=>String(i).slice(-2),YYYY:()=>i,M:()=>n+1,Mo:()=>ds(n+1),MM:()=>`${n+1}`.padStart(2,"0"),MMM:()=>t.toLocaleDateString(hs(s.locales),{month:"short"}),MMMM:()=>t.toLocaleDateString(hs(s.locales),{month:"long"}),D:()=>String(o),Do:()=>ds(o),DD:()=>`${o}`.padStart(2,"0"),H:()=>String(a),Ho:()=>ds(a),HH:()=>`${a}`.padStart(2,"0"),h:()=>`${a%12||12}`.padStart(1,"0"),ho:()=>ds(a%12||12),hh:()=>`${a%12||12}`.padStart(2,"0"),m:()=>String(c),mo:()=>ds(c),mm:()=>`${c}`.padStart(2,"0"),s:()=>String(d),so:()=>ds(d),ss:()=>`${d}`.padStart(2,"0"),SSS:()=>`${l}`.padStart(3,"0"),d:()=>u,dd:()=>t.toLocaleDateString(hs(s.locales),{weekday:"narrow"}),ddd:()=>t.toLocaleDateString(hs(s.locales),{weekday:"short"}),dddd:()=>t.toLocaleDateString(hs(s.locales),{weekday:"long"}),A:()=>p(a,c),AA:()=>p(a,c,!1,!0),a:()=>p(a,c,!0),aa:()=>p(a,c,!0,!0)};return e.replace(ig,(w,C)=>{var A,f;return(f=C??((A=y[w])==null?void 0:A.call(y)))!=null?f:w})}const ag=["width","height"],cg={id:"Page-1",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},lg=["fill"],Zc=Re({__name:"IconNewCall",props:{color:{default:"#fafafa"},size:{default:"250px"}},setup(t){const e=t;return(s,r)=>(V(),J("svg",{width:e.size,height:e.size,viewBox:"-0.5 0 17 17",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[r[1]||(r[1]=m("defs",null,null,-1)),m("g",cg,[m("g",{id:"Dribbble-Light-Preview",transform:"translate(-302.000000, -7321.000000)",fill:e.color},r[0]||(r[0]=[m("g",{id:"icons",transform:"translate(56.000000, 160.000000)"},[m("path",{id:"call-[#187]",d:"M260.000175,7163 L260.000175,7161 L258.000175,7161 L258.000175,7163 L256.000175,7163 L256.000175,7165 L258.000175,7165 L258.000175,7167 L260.000175,7167 L260.000175,7165 L262.000175,7165 L262.000175,7163 L260.000175,7163 Z M260.117175,7173.578 C259.422175,7173.204 258.719175,7172.778 257.992175,7172.481 C256.587175,7171.908 256.682175,7173.602 255.679175,7174.151 C255.027175,7174.508 254.107175,7173.861 253.538175,7173.503 C252.544175,7172.877 251.663175,7172.053 250.931175,7171.1 C250.556175,7170.613 249.728175,7169.697 249.830175,7169.014 C249.992175,7167.93 251.274175,7167.876 250.907175,7166.55 C250.711175,7165.84 250.360175,7165.141 250.097175,7164.457 C249.745175,7163.54 249.600175,7162.953 248.573175,7163.003 C247.831175,7163.039 247.339175,7163.356 246.883175,7163.951 C245.649175,7165.558 245.835175,7167.725 246.664175,7169.488 C247.838175,7171.983 249.850175,7174.335 251.999175,7175.855 C253.461175,7176.889 255.387175,7177.828 257.157175,7177.987 C258.453175,7178.104 260.266175,7177.403 260.730175,7175.996 C260.698175,7176.094 260.667175,7176.189 260.652175,7176.234 C260.663175,7176.199 260.687175,7176.128 260.730175,7175.996 C260.749175,7175.94 260.761175,7175.902 260.773175,7175.866 C260.760175,7175.905 260.746175,7175.948 260.731175,7175.993 C261.139175,7174.753 261.189175,7174.155 260.117175,7173.578 L260.117175,7173.578 Z M260.773175,7175.866 C260.789175,7175.817 260.803175,7175.774 260.811175,7175.751 C260.805175,7175.77 260.791175,7175.811 260.773175,7175.866 L260.773175,7175.866 Z"})],-1)]),8,lg)])],8,ag))}}),dg=["width","height"],ug=["fill"],hg=Re({__name:"IconSearch",props:{color:{default:"#fafafa"},size:{default:"24px"}},setup(t){const e=t;return(s,r)=>(V(),J("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[m("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M17.0392 15.6244C18.2714 14.084 19.0082 12.1301 19.0082 10.0041C19.0082 5.03127 14.9769 1 10.0041 1C5.03127 1 1 5.03127 1 10.0041C1 14.9769 5.03127 19.0082 10.0041 19.0082C12.1301 19.0082 14.084 18.2714 15.6244 17.0392L21.2921 22.707C21.6828 23.0977 22.3163 23.0977 22.707 22.707C23.0977 22.3163 23.0977 21.6828 22.707 21.2921L17.0392 15.6244ZM10.0041 17.0173C6.1308 17.0173 2.99087 13.8774 2.99087 10.0041C2.99087 6.1308 6.1308 2.99087 10.0041 2.99087C13.8774 2.99087 17.0173 6.1308 17.0173 10.0041C17.0173 13.8774 13.8774 17.0173 10.0041 17.0173Z",fill:e.color},null,8,ug)],8,dg))}}),fg={class:"header-wrapper"},gg={class:"call-status"},pg={class:"header"},mg={class:"profile"},vg={class:"agent-identity"},bg={class:"agent-title"},wg={class:"agent-desc"},yg={class:"action-btn-wrapper"},xg={key:1,class:"header-left-btn"},Cg=Re({__name:"MainHeader",props:{isLeftSidebar:{type:Boolean,default:!0},isShowPreviewBanner:{type:Boolean},call:{}},emits:["close","showRightContent"],setup(t,{emit:e}){const s=e,r=t,i=De(),n=Bt(),o=se(),a=se(),c=se(),d=se(),l=Qr(()=>{const w=o.value;i.fetchHistoryList({q:{search:w}})},500),u=Qr(()=>{var w;(w=c.value)==null||w.classList.remove("shake")},400),p=async()=>{var w;(w=c.value)==null||w.classList.add("shake"),await u()},y=async()=>{await et(),i.isActiveCallAvailable?await p():s("showRightContent",{displayType:"newCall"})};return ht(()=>o.value,w=>{w&&l()}),(w,C)=>{var A,f,I,j;return V(),J("div",fg,[w.isShowPreviewBanner?(V(),J("div",{key:0,ref_key:"theActiveCallBannerRef",ref:c,style:ae(q(i).cssVars),class:Te(["banner-container",`${(A=r.call)==null?void 0:A.type}`]),onClick:C[0]||(C[0]=ye(R=>s("showRightContent",{displayType:"activeCall"}),["stop"]))},[m("div",gg,Ie(((f=r.call)==null?void 0:f.status)==="dialing"?r.call.status:`call ${(I=r.call)==null?void 0:I.status}`),1)],6)):Ge("",!0),m("div",pg,[m("div",mg,[m("div",{style:ae(q(i).cssVars),class:"profile-picture-wrapper"},[C[4]||(C[4]=m("img",{width:"24",height:"auto",src:eg},null,-1)),m("div",{style:ae(q(i).cssVars),class:Te([`status-${(j=q(n).sipStatus.registerStatus)==null?void 0:j.toLocaleLowerCase()}`,"sip-status-indicator"])},null,6)],4),m("div",vg,[m("span",bg,Ie(q(i).agentIdentity.name),1),m("span",wg,Ie(q(i).agentIdentity.desc),1)])]),m("div",yg,[m("a",{class:"close-btn",onClick:C[1]||(C[1]=R=>s("close"))},C[5]||(C[5]=[m("img",{src:tg},null,-1)]))])]),r.isLeftSidebar?(V(),J("div",xg,[m("div",{style:ae(q(i).cssVars),class:Te(["btn-wrapper",{hide:d.value}])},[mt(m("input",{"onUpdate:modelValue":C[2]||(C[2]=R=>o.value=R),class:"search",placeholder:"Search.."},null,512),[[Os,o.value]])],6),m("div",{style:ae(q(i).cssVars),class:"btn-wrapper new-call",onClick:y},[d.value?(V(),Xe(hg,{key:0,class:"icon-btn",color:q(i).cssVars["--dark-front"],size:20},null,8,["color"])):(V(),Xe(Zc,{key:1,class:"icon-btn",color:q(i).cssVars["--dark-front"],size:20},null,8,["color"]))],4),m("div",{style:ae(q(i).cssVars),class:Te(["btn-wrapper input-number-new-call",{hide:!d.value}])},[mt(m("input",{"onUpdate:modelValue":C[3]||(C[3]=R=>a.value=R),class:"new-call",placeholder:""},null,512),[[Os,a.value]])],6)])):Ge("",!0)])}}}),os=(t,e)=>{const s=t.__vccOpts||t;for(const[r,i]of e)s[r]=i;return s},Tg=os(Cg,[["__scopeId","data-v-ca6f64c5"]]),Qc="data:image/svg+xml,%3csvg%20height='800px'%20width='800px'%20version='1.1'%20id='Capa_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0%200%20480%20480'%20xml:space='preserve'%3e%3cg%3e%3cg%3e%3ccircle%20style='fill:%23B8BAC0;'%20cx='240'%20cy='240'%20r='240'/%3e%3c/g%3e%3cg%3e%3cg%3e%3cpath%20style='fill:%23FFFFFF;'%20d='M240,360.07c-27.944,0-53.297-11.991-72.003-31.372c-0.014,11.615-0.436,28.379-3.516,40.611%20c2.02,1.235,3.588,3.262,3.894,5.784c3.992,32.484,34.781,56.977,71.625,56.977c36.836,0,67.625-24.496,71.625-56.977%20c0.31-2.525,1.844-4.549,3.895-5.78c-3.08-12.233-3.503-28.999-3.517-40.615C293.297,348.079,267.944,360.07,240,360.07z'/%3e%3c/g%3e%3c/g%3e%3cg%3e%3cg%3e%3cpath%20style='fill:%23D7DBE0;'%20d='M310.44,330.174c-18.549,18.477-43.242,29.896-70.44,29.896%20c-27.944,0-53.297-11.991-72.003-31.372c-0.014,11.615-0.436,28.379-3.516,40.611c2.02,1.235,3.588,3.262,3.894,5.784%20c1.765,14.359,8.778,27.144,19.223,36.954C235.766,405.265,290.437,357.702,310.44,330.174z'/%3e%3c/g%3e%3c/g%3e%3cg%3e%3cg%3e%3cpath%20style='fill:%23FFFFFF;'%20d='M312,160.07H176c-22.055,0-40,17.945-40,40v48c0,61.758,46.656,112,104,112s104-50.242,104-112%20v-56C344,174.426,329.648,160.07,312,160.07z'/%3e%3c/g%3e%3c/g%3e%3cg%3e%3cg%3e%3cpath%20style='fill:%235C546A;'%20d='M296,72.07H192c-15.047,0-27.695,10.438-31.102,24.449C133.359,100.02,112,123.598,112,152.07v40%20c0,20.617,8.752,39.851,24,53.52v-45.52c0-22.055,17.945-40,40-40h136c17.648,0,32,14.355,32,32v53.511%20c15.251-13.667,24-32.899,24-53.511v-48C368,104.371,335.703,72.07,296,72.07z'/%3e%3c/g%3e%3c/g%3e%3cg%3e%3cpath%20style='fill:%235C546A;'%20d='M61.632,400.544C105.562,449.319,169.191,480,240,480s134.438-30.681,178.368-79.456%20c-7.66-10.356-18.462-18.77-32.352-22.659c-0.32-0.09-0.641-0.16-0.969-0.207l-63.859-9.582c-0.391-0.059-1.227-0.09-1.625-0.09%20c-4.039,0-7.445,3.012-7.938,7.023c-4,32.48-34.789,56.977-71.625,56.977c-36.844,0-67.633-24.492-71.625-56.977%20c-0.5-4.129-4.219-7.234-8.141-7.02c-0.469-0.027-0.93,0.012-1.422,0.086l-63.859,9.582c-0.328,0.047-0.648,0.117-0.969,0.207%20C80.094,381.775,69.292,390.188,61.632,400.544z'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e";/*!
 * perfect-scrollbar v1.5.6
 * Copyright 2024 Hyunje Jun, MDBootstrap and Contributors
 * Licensed under MIT
 */function At(t){return getComputedStyle(t)}function Ze(t,e){for(var s in e){var r=e[s];typeof r=="number"&&(r=r+"px"),t.style[s]=r}return t}function _r(t){var e=document.createElement("div");return e.className=t,e}var Xo=typeof Element<"u"&&(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);function Zt(t,e){if(!Xo)throw new Error("No element matching method supported");return Xo.call(t,e)}function Rs(t){t.remove?t.remove():t.parentNode&&t.parentNode.removeChild(t)}function Jo(t,e){return Array.prototype.filter.call(t.children,function(s){return Zt(s,e)})}var Ae={main:"ps",rtl:"ps__rtl",element:{thumb:function(t){return"ps__thumb-"+t},rail:function(t){return"ps__rail-"+t},consuming:"ps__child--consume"},state:{focus:"ps--focus",clicking:"ps--clicking",active:function(t){return"ps--active-"+t},scrolling:function(t){return"ps--scrolling-"+t}}},el={x:null,y:null};function tl(t,e){var s=t.element.classList,r=Ae.state.scrolling(e);s.contains(r)?clearTimeout(el[e]):s.add(r)}function sl(t,e){el[e]=setTimeout(function(){return t.isAlive&&t.element.classList.remove(Ae.state.scrolling(e))},t.settings.scrollingThreshold)}function Eg(t,e){tl(t,e),sl(t,e)}var wr=function(e){this.element=e,this.handlers={}},rl={isEmpty:{configurable:!0}};wr.prototype.bind=function(e,s){typeof this.handlers[e]>"u"&&(this.handlers[e]=[]),this.handlers[e].push(s),this.element.addEventListener(e,s,!1)};wr.prototype.unbind=function(e,s){var r=this;this.handlers[e]=this.handlers[e].filter(function(i){return s&&i!==s?!0:(r.element.removeEventListener(e,i,!1),!1)})};wr.prototype.unbindAll=function(){for(var e in this.handlers)this.unbind(e)};rl.isEmpty.get=function(){var t=this;return Object.keys(this.handlers).every(function(e){return t.handlers[e].length===0})};Object.defineProperties(wr.prototype,rl);var Ns=function(){this.eventElements=[]};Ns.prototype.eventElement=function(e){var s=this.eventElements.filter(function(r){return r.element===e})[0];return s||(s=new wr(e),this.eventElements.push(s)),s};Ns.prototype.bind=function(e,s,r){this.eventElement(e).bind(s,r)};Ns.prototype.unbind=function(e,s,r){var i=this.eventElement(e);i.unbind(s,r),i.isEmpty&&this.eventElements.splice(this.eventElements.indexOf(i),1)};Ns.prototype.unbindAll=function(){this.eventElements.forEach(function(e){return e.unbindAll()}),this.eventElements=[]};Ns.prototype.once=function(e,s,r){var i=this.eventElement(e),n=function(o){i.unbind(s,n),r(o)};i.bind(s,n)};function Rr(t){if(typeof window.CustomEvent=="function")return new CustomEvent(t);var e=document.createEvent("CustomEvent");return e.initCustomEvent(t,!1,!1,void 0),e}function ei(t,e,s,r,i){r===void 0&&(r=!0),i===void 0&&(i=!1);var n;if(e==="top")n=["contentHeight","containerHeight","scrollTop","y","up","down"];else if(e==="left")n=["contentWidth","containerWidth","scrollLeft","x","left","right"];else throw new Error("A proper axis should be provided");Sg(t,s,n,r,i)}function Sg(t,e,s,r,i){var n=s[0],o=s[1],a=s[2],c=s[3],d=s[4],l=s[5];r===void 0&&(r=!0),i===void 0&&(i=!1);var u=t.element;t.reach[c]=null,u[a]<1&&(t.reach[c]="start"),u[a]>t[n]-t[o]-1&&(t.reach[c]="end"),e&&(u.dispatchEvent(Rr("ps-scroll-"+c)),e<0?u.dispatchEvent(Rr("ps-scroll-"+d)):e>0&&u.dispatchEvent(Rr("ps-scroll-"+l)),r&&Eg(t,c)),t.reach[c]&&(e||i)&&u.dispatchEvent(Rr("ps-"+c+"-reach-"+t.reach[c]))}function Ce(t){return parseInt(t,10)||0}function _g(t){return Zt(t,"input,[contenteditable]")||Zt(t,"select,[contenteditable]")||Zt(t,"textarea,[contenteditable]")||Zt(t,"button,[contenteditable]")}function Rg(t){var e=At(t);return Ce(e.width)+Ce(e.paddingLeft)+Ce(e.paddingRight)+Ce(e.borderLeftWidth)+Ce(e.borderRightWidth)}var _s={isWebKit:typeof document<"u"&&"WebkitAppearance"in document.documentElement.style,supportsTouch:typeof window<"u"&&("ontouchstart"in window||"maxTouchPoints"in window.navigator&&window.navigator.maxTouchPoints>0||window.DocumentTouch&&document instanceof window.DocumentTouch),supportsIePointer:typeof navigator<"u"&&navigator.msMaxTouchPoints,isChrome:typeof navigator<"u"&&/Chrome/i.test(navigator&&navigator.userAgent)};function Ut(t){var e=t.element,s=Math.floor(e.scrollTop),r=e.getBoundingClientRect();t.containerWidth=Math.floor(r.width),t.containerHeight=Math.floor(r.height),t.contentWidth=e.scrollWidth,t.contentHeight=e.scrollHeight,e.contains(t.scrollbarXRail)||(Jo(e,Ae.element.rail("x")).forEach(function(i){return Rs(i)}),e.appendChild(t.scrollbarXRail)),e.contains(t.scrollbarYRail)||(Jo(e,Ae.element.rail("y")).forEach(function(i){return Rs(i)}),e.appendChild(t.scrollbarYRail)),!t.settings.suppressScrollX&&t.containerWidth+t.settings.scrollXMarginOffset<t.contentWidth?(t.scrollbarXActive=!0,t.railXWidth=t.containerWidth-t.railXMarginWidth,t.railXRatio=t.containerWidth/t.railXWidth,t.scrollbarXWidth=Zo(t,Ce(t.railXWidth*t.containerWidth/t.contentWidth)),t.scrollbarXLeft=Ce((t.negativeScrollAdjustment+e.scrollLeft)*(t.railXWidth-t.scrollbarXWidth)/(t.contentWidth-t.containerWidth))):t.scrollbarXActive=!1,!t.settings.suppressScrollY&&t.containerHeight+t.settings.scrollYMarginOffset<t.contentHeight?(t.scrollbarYActive=!0,t.railYHeight=t.containerHeight-t.railYMarginHeight,t.railYRatio=t.containerHeight/t.railYHeight,t.scrollbarYHeight=Zo(t,Ce(t.railYHeight*t.containerHeight/t.contentHeight)),t.scrollbarYTop=Ce(s*(t.railYHeight-t.scrollbarYHeight)/(t.contentHeight-t.containerHeight))):t.scrollbarYActive=!1,t.scrollbarXLeft>=t.railXWidth-t.scrollbarXWidth&&(t.scrollbarXLeft=t.railXWidth-t.scrollbarXWidth),t.scrollbarYTop>=t.railYHeight-t.scrollbarYHeight&&(t.scrollbarYTop=t.railYHeight-t.scrollbarYHeight),$g(e,t),t.scrollbarXActive?e.classList.add(Ae.state.active("x")):(e.classList.remove(Ae.state.active("x")),t.scrollbarXWidth=0,t.scrollbarXLeft=0,e.scrollLeft=t.isRtl===!0?t.contentWidth:0),t.scrollbarYActive?e.classList.add(Ae.state.active("y")):(e.classList.remove(Ae.state.active("y")),t.scrollbarYHeight=0,t.scrollbarYTop=0,e.scrollTop=0)}function Zo(t,e){return t.settings.minScrollbarLength&&(e=Math.max(e,t.settings.minScrollbarLength)),t.settings.maxScrollbarLength&&(e=Math.min(e,t.settings.maxScrollbarLength)),e}function $g(t,e){var s={width:e.railXWidth},r=Math.floor(t.scrollTop);e.isRtl?s.left=e.negativeScrollAdjustment+t.scrollLeft+e.containerWidth-e.contentWidth:s.left=t.scrollLeft,e.isScrollbarXUsingBottom?s.bottom=e.scrollbarXBottom-r:s.top=e.scrollbarXTop+r,Ze(e.scrollbarXRail,s);var i={top:r,height:e.railYHeight};e.isScrollbarYUsingRight?e.isRtl?i.right=e.contentWidth-(e.negativeScrollAdjustment+t.scrollLeft)-e.scrollbarYRight-e.scrollbarYOuterWidth-9:i.right=e.scrollbarYRight-t.scrollLeft:e.isRtl?i.left=e.negativeScrollAdjustment+t.scrollLeft+e.containerWidth*2-e.contentWidth-e.scrollbarYLeft-e.scrollbarYOuterWidth:i.left=e.scrollbarYLeft+t.scrollLeft,Ze(e.scrollbarYRail,i),Ze(e.scrollbarX,{left:e.scrollbarXLeft,width:e.scrollbarXWidth-e.railBorderXWidth}),Ze(e.scrollbarY,{top:e.scrollbarYTop,height:e.scrollbarYHeight-e.railBorderYWidth})}function Ag(t){t.event.bind(t.scrollbarY,"mousedown",function(e){return e.stopPropagation()}),t.event.bind(t.scrollbarYRail,"mousedown",function(e){var s=e.pageY-window.pageYOffset-t.scrollbarYRail.getBoundingClientRect().top,r=s>t.scrollbarYTop?1:-1;t.element.scrollTop+=r*t.containerHeight,Ut(t),e.stopPropagation()}),t.event.bind(t.scrollbarX,"mousedown",function(e){return e.stopPropagation()}),t.event.bind(t.scrollbarXRail,"mousedown",function(e){var s=e.pageX-window.pageXOffset-t.scrollbarXRail.getBoundingClientRect().left,r=s>t.scrollbarXLeft?1:-1;t.element.scrollLeft+=r*t.containerWidth,Ut(t),e.stopPropagation()})}var $r=null;function Ig(t){Qo(t,["containerHeight","contentHeight","pageY","railYHeight","scrollbarY","scrollbarYHeight","scrollTop","y","scrollbarYRail"]),Qo(t,["containerWidth","contentWidth","pageX","railXWidth","scrollbarX","scrollbarXWidth","scrollLeft","x","scrollbarXRail"])}function Qo(t,e){var s=e[0],r=e[1],i=e[2],n=e[3],o=e[4],a=e[5],c=e[6],d=e[7],l=e[8],u=t.element,p=null,y=null,w=null;function C(I){I.touches&&I.touches[0]&&(I[i]=I.touches[0]["page"+d.toUpperCase()]),$r===o&&(u[c]=p+w*(I[i]-y),tl(t,d),Ut(t),I.stopPropagation(),I.preventDefault())}function A(){sl(t,d),t[l].classList.remove(Ae.state.clicking),document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",A),document.removeEventListener("touchmove",C),document.removeEventListener("touchend",A),$r=null}function f(I){$r===null&&($r=o,p=u[c],I.touches&&(I[i]=I.touches[0]["page"+d.toUpperCase()]),y=I[i],w=(t[r]-t[s])/(t[n]-t[a]),I.touches?(document.addEventListener("touchmove",C,{passive:!1}),document.addEventListener("touchend",A)):(document.addEventListener("mousemove",C),document.addEventListener("mouseup",A)),t[l].classList.add(Ae.state.clicking)),I.stopPropagation(),I.cancelable&&I.preventDefault()}t[o].addEventListener("mousedown",f),t[o].addEventListener("touchstart",f)}function Dg(t){var e=t.element,s=function(){return Zt(e,":hover")},r=function(){return Zt(t.scrollbarX,":focus")||Zt(t.scrollbarY,":focus")};function i(n,o){var a=Math.floor(e.scrollTop);if(n===0){if(!t.scrollbarYActive)return!1;if(a===0&&o>0||a>=t.contentHeight-t.containerHeight&&o<0)return!t.settings.wheelPropagation}var c=e.scrollLeft;if(o===0){if(!t.scrollbarXActive)return!1;if(c===0&&n<0||c>=t.contentWidth-t.containerWidth&&n>0)return!t.settings.wheelPropagation}return!0}t.event.bind(t.ownerDocument,"keydown",function(n){if(!(n.isDefaultPrevented&&n.isDefaultPrevented()||n.defaultPrevented)&&!(!s()&&!r())){var o=document.activeElement?document.activeElement:t.ownerDocument.activeElement;if(o){if(o.tagName==="IFRAME")o=o.contentDocument.activeElement;else for(;o.shadowRoot;)o=o.shadowRoot.activeElement;if(_g(o))return}var a=0,c=0;switch(n.which){case 37:n.metaKey?a=-t.contentWidth:n.altKey?a=-t.containerWidth:a=-30;break;case 38:n.metaKey?c=t.contentHeight:n.altKey?c=t.containerHeight:c=30;break;case 39:n.metaKey?a=t.contentWidth:n.altKey?a=t.containerWidth:a=30;break;case 40:n.metaKey?c=-t.contentHeight:n.altKey?c=-t.containerHeight:c=-30;break;case 32:n.shiftKey?c=t.containerHeight:c=-t.containerHeight;break;case 33:c=t.containerHeight;break;case 34:c=-t.containerHeight;break;case 36:c=t.contentHeight;break;case 35:c=-t.contentHeight;break;default:return}t.settings.suppressScrollX&&a!==0||t.settings.suppressScrollY&&c!==0||(e.scrollTop-=c,e.scrollLeft+=a,Ut(t),i(a,c)&&n.preventDefault())}})}function Hg(t){var e=t.element;function s(o,a){var c=Math.floor(e.scrollTop),d=e.scrollTop===0,l=c+e.offsetHeight===e.scrollHeight,u=e.scrollLeft===0,p=e.scrollLeft+e.offsetWidth===e.scrollWidth,y;return Math.abs(a)>Math.abs(o)?y=d||l:y=u||p,y?!t.settings.wheelPropagation:!0}function r(o){var a=o.deltaX,c=-1*o.deltaY;return(typeof a>"u"||typeof c>"u")&&(a=-1*o.wheelDeltaX/6,c=o.wheelDeltaY/6),o.deltaMode&&o.deltaMode===1&&(a*=10,c*=10),a!==a&&c!==c&&(a=0,c=o.wheelDelta),o.shiftKey?[-c,-a]:[a,c]}function i(o,a,c){if(!_s.isWebKit&&e.querySelector("select:focus"))return!0;if(!e.contains(o))return!1;for(var d=o;d&&d!==e;){if(d.classList.contains(Ae.element.consuming))return!0;var l=At(d);if(c&&l.overflowY.match(/(scroll|auto)/)){var u=d.scrollHeight-d.clientHeight;if(u>0&&(d.scrollTop>0&&c<0||d.scrollTop<u&&c>0))return!0}if(a&&l.overflowX.match(/(scroll|auto)/)){var p=d.scrollWidth-d.clientWidth;if(p>0&&(d.scrollLeft>0&&a<0||d.scrollLeft<p&&a>0))return!0}d=d.parentNode}return!1}function n(o){var a=r(o),c=a[0],d=a[1];if(!i(o.target,c,d)){var l=!1;t.settings.useBothWheelAxes?t.scrollbarYActive&&!t.scrollbarXActive?(d?e.scrollTop-=d*t.settings.wheelSpeed:e.scrollTop+=c*t.settings.wheelSpeed,l=!0):t.scrollbarXActive&&!t.scrollbarYActive&&(c?e.scrollLeft+=c*t.settings.wheelSpeed:e.scrollLeft-=d*t.settings.wheelSpeed,l=!0):(e.scrollTop-=d*t.settings.wheelSpeed,e.scrollLeft+=c*t.settings.wheelSpeed),Ut(t),l=l||s(c,d),l&&!o.ctrlKey&&(o.stopPropagation(),o.preventDefault())}}typeof window.onwheel<"u"?t.event.bind(e,"wheel",n):typeof window.onmousewheel<"u"&&t.event.bind(e,"mousewheel",n)}function Pg(t){if(!_s.supportsTouch&&!_s.supportsIePointer)return;var e=t.element,s={startOffset:{},startTime:0,speed:{},easingLoop:null};function r(u,p){var y=Math.floor(e.scrollTop),w=e.scrollLeft,C=Math.abs(u),A=Math.abs(p);if(A>C){if(p<0&&y===t.contentHeight-t.containerHeight||p>0&&y===0)return window.scrollY===0&&p>0&&_s.isChrome}else if(C>A&&(u<0&&w===t.contentWidth-t.containerWidth||u>0&&w===0))return!0;return!0}function i(u,p){e.scrollTop-=p,e.scrollLeft-=u,Ut(t)}function n(u){return u.targetTouches?u.targetTouches[0]:u}function o(u){return u.target===t.scrollbarX||u.target===t.scrollbarY||u.pointerType&&u.pointerType==="pen"&&u.buttons===0?!1:!!(u.targetTouches&&u.targetTouches.length===1||u.pointerType&&u.pointerType!=="mouse"&&u.pointerType!==u.MSPOINTER_TYPE_MOUSE)}function a(u){if(o(u)){var p=n(u);s.startOffset.pageX=p.pageX,s.startOffset.pageY=p.pageY,s.startTime=new Date().getTime(),s.easingLoop!==null&&clearInterval(s.easingLoop)}}function c(u,p,y){if(!e.contains(u))return!1;for(var w=u;w&&w!==e;){if(w.classList.contains(Ae.element.consuming))return!0;var C=At(w);if(y&&C.overflowY.match(/(scroll|auto)/)){var A=w.scrollHeight-w.clientHeight;if(A>0&&(w.scrollTop>0&&y<0||w.scrollTop<A&&y>0))return!0}if(p&&C.overflowX.match(/(scroll|auto)/)){var f=w.scrollWidth-w.clientWidth;if(f>0&&(w.scrollLeft>0&&p<0||w.scrollLeft<f&&p>0))return!0}w=w.parentNode}return!1}function d(u){if(o(u)){var p=n(u),y={pageX:p.pageX,pageY:p.pageY},w=y.pageX-s.startOffset.pageX,C=y.pageY-s.startOffset.pageY;if(c(u.target,w,C))return;i(w,C),s.startOffset=y;var A=new Date().getTime(),f=A-s.startTime;f>0&&(s.speed.x=w/f,s.speed.y=C/f,s.startTime=A),r(w,C)&&u.cancelable&&u.preventDefault()}}function l(){t.settings.swipeEasing&&(clearInterval(s.easingLoop),s.easingLoop=setInterval(function(){if(t.isInitialized){clearInterval(s.easingLoop);return}if(!s.speed.x&&!s.speed.y){clearInterval(s.easingLoop);return}if(Math.abs(s.speed.x)<.01&&Math.abs(s.speed.y)<.01){clearInterval(s.easingLoop);return}i(s.speed.x*30,s.speed.y*30),s.speed.x*=.8,s.speed.y*=.8},10))}_s.supportsTouch?(t.event.bind(e,"touchstart",a),t.event.bind(e,"touchmove",d),t.event.bind(e,"touchend",l)):_s.supportsIePointer&&(window.PointerEvent?(t.event.bind(e,"pointerdown",a),t.event.bind(e,"pointermove",d),t.event.bind(e,"pointerup",l)):window.MSPointerEvent&&(t.event.bind(e,"MSPointerDown",a),t.event.bind(e,"MSPointerMove",d),t.event.bind(e,"MSPointerUp",l)))}var kg=function(){return{handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollingThreshold:1e3,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:!1,suppressScrollY:!1,swipeEasing:!0,useBothWheelAxes:!1,wheelPropagation:!0,wheelSpeed:1}},Og={"click-rail":Ag,"drag-thumb":Ig,keyboard:Dg,wheel:Hg,touch:Pg},yr=function(e,s){var r=this;if(s===void 0&&(s={}),typeof e=="string"&&(e=document.querySelector(e)),!e||!e.nodeName)throw new Error("no element is specified to initialize PerfectScrollbar");this.element=e,e.classList.add(Ae.main),this.settings=kg();for(var i in s)this.settings[i]=s[i];this.containerWidth=null,this.containerHeight=null,this.contentWidth=null,this.contentHeight=null;var n=function(){return e.classList.add(Ae.state.focus)},o=function(){return e.classList.remove(Ae.state.focus)};this.isRtl=At(e).direction==="rtl",this.isRtl===!0&&e.classList.add(Ae.rtl),this.isNegativeScroll=function(){var d=e.scrollLeft,l=null;return e.scrollLeft=-1,l=e.scrollLeft<0,e.scrollLeft=d,l}(),this.negativeScrollAdjustment=this.isNegativeScroll?e.scrollWidth-e.clientWidth:0,this.event=new Ns,this.ownerDocument=e.ownerDocument||document,this.scrollbarXRail=_r(Ae.element.rail("x")),e.appendChild(this.scrollbarXRail),this.scrollbarX=_r(Ae.element.thumb("x")),this.scrollbarXRail.appendChild(this.scrollbarX),this.scrollbarX.setAttribute("tabindex",0),this.event.bind(this.scrollbarX,"focus",n),this.event.bind(this.scrollbarX,"blur",o),this.scrollbarXActive=null,this.scrollbarXWidth=null,this.scrollbarXLeft=null;var a=At(this.scrollbarXRail);this.scrollbarXBottom=parseInt(a.bottom,10),isNaN(this.scrollbarXBottom)?(this.isScrollbarXUsingBottom=!1,this.scrollbarXTop=Ce(a.top)):this.isScrollbarXUsingBottom=!0,this.railBorderXWidth=Ce(a.borderLeftWidth)+Ce(a.borderRightWidth),Ze(this.scrollbarXRail,{display:"block"}),this.railXMarginWidth=Ce(a.marginLeft)+Ce(a.marginRight),Ze(this.scrollbarXRail,{display:""}),this.railXWidth=null,this.railXRatio=null,this.scrollbarYRail=_r(Ae.element.rail("y")),e.appendChild(this.scrollbarYRail),this.scrollbarY=_r(Ae.element.thumb("y")),this.scrollbarYRail.appendChild(this.scrollbarY),this.scrollbarY.setAttribute("tabindex",0),this.event.bind(this.scrollbarY,"focus",n),this.event.bind(this.scrollbarY,"blur",o),this.scrollbarYActive=null,this.scrollbarYHeight=null,this.scrollbarYTop=null;var c=At(this.scrollbarYRail);this.scrollbarYRight=parseInt(c.right,10),isNaN(this.scrollbarYRight)?(this.isScrollbarYUsingRight=!1,this.scrollbarYLeft=Ce(c.left)):this.isScrollbarYUsingRight=!0,this.scrollbarYOuterWidth=this.isRtl?Rg(this.scrollbarY):null,this.railBorderYWidth=Ce(c.borderTopWidth)+Ce(c.borderBottomWidth),Ze(this.scrollbarYRail,{display:"block"}),this.railYMarginHeight=Ce(c.marginTop)+Ce(c.marginBottom),Ze(this.scrollbarYRail,{display:""}),this.railYHeight=null,this.railYRatio=null,this.reach={x:e.scrollLeft<=0?"start":e.scrollLeft>=this.contentWidth-this.containerWidth?"end":null,y:e.scrollTop<=0?"start":e.scrollTop>=this.contentHeight-this.containerHeight?"end":null},this.isAlive=!0,this.settings.handlers.forEach(function(d){return Og[d](r)}),this.lastScrollTop=Math.floor(e.scrollTop),this.lastScrollLeft=e.scrollLeft,this.event.bind(this.element,"scroll",function(d){return r.onScroll(d)}),Ut(this)};yr.prototype.update=function(){this.isAlive&&(this.negativeScrollAdjustment=this.isNegativeScroll?this.element.scrollWidth-this.element.clientWidth:0,Ze(this.scrollbarXRail,{display:"block"}),Ze(this.scrollbarYRail,{display:"block"}),this.railXMarginWidth=Ce(At(this.scrollbarXRail).marginLeft)+Ce(At(this.scrollbarXRail).marginRight),this.railYMarginHeight=Ce(At(this.scrollbarYRail).marginTop)+Ce(At(this.scrollbarYRail).marginBottom),Ze(this.scrollbarXRail,{display:"none"}),Ze(this.scrollbarYRail,{display:"none"}),Ut(this),ei(this,"top",0,!1,!0),ei(this,"left",0,!1,!0),Ze(this.scrollbarXRail,{display:""}),Ze(this.scrollbarYRail,{display:""}))};yr.prototype.onScroll=function(e){this.isAlive&&(Ut(this),ei(this,"top",this.element.scrollTop-this.lastScrollTop),ei(this,"left",this.element.scrollLeft-this.lastScrollLeft),this.lastScrollTop=Math.floor(this.element.scrollTop),this.lastScrollLeft=this.element.scrollLeft)};yr.prototype.destroy=function(){this.isAlive&&(this.event.unbindAll(),Rs(this.scrollbarX),Rs(this.scrollbarY),Rs(this.scrollbarXRail),Rs(this.scrollbarYRail),this.removePsClasses(),this.element=null,this.scrollbarX=null,this.scrollbarY=null,this.scrollbarXRail=null,this.scrollbarYRail=null,this.isAlive=!1)};yr.prototype.removePsClasses=function(){this.element.className=this.element.className.split(" ").filter(function(e){return!e.match(/^ps([-_].+|)$/)}).join(" ")};const il=Re({__name:"PerfectScrollbar",props:{tag:{default:"div"},options:{default:()=>({})}},emits:["scroll","ps-scroll-y","ps-scroll-x","ps-scroll-up","ps-scroll-down","ps-scroll-left","ps-scroll-right","ps-y-reach-start","ps-y-reach-end","ps-x-reach-start","ps-x-reach-end"],setup(t,{expose:e,emit:s}){const r=t,i=s,n=se(null),o=se(null);ht(()=>r.options,()=>{c(),a()},{deep:!0}),pr(()=>{n.value&&a()}),Fa(()=>{c()});function a(){n.value&&(o.value=new yr(n.value,r.options),u())}function c(){o.value&&(u(!1),o.value.destroy(),o.value=null)}const d={scroll:l("scroll"),"ps-scroll-y":l("ps-scroll-y"),"ps-scroll-x":l("ps-scroll-x"),"ps-scroll-up":l("ps-scroll-up"),"ps-scroll-down":l("ps-scroll-down"),"ps-scroll-left":l("ps-scroll-left"),"ps-scroll-right":l("ps-scroll-right"),"ps-y-reach-start":l("ps-y-reach-start"),"ps-y-reach-end":l("ps-y-reach-end"),"ps-x-reach-start":l("ps-x-reach-start"),"ps-x-reach-end":l("ps-x-reach-end")};function l(p){return function(y){i(p,y)}}function u(p=!0){var y;(y=o.value)!=null&&y.element&&Object.entries(d).forEach(([w,C])=>{var A,f;p?(A=o.value)==null||A.element.addEventListener(w,C):(f=o.value)==null||f.element.removeEventListener(w,C)})}return e({ps:o}),(p,y)=>(V(),Xe(hd(p.tag),{ref_key:"scrollbar",ref:n,class:"ps"},{default:On(()=>[gd(p.$slots,"default")]),_:3},512))}}),Lg={componentName:"PerfectScrollbar"},Mg={install(t,e){const s=Object.assign(Lg,e);t.component(s.componentName,il)}},Fg=["width","height"],Ng=["stroke"],qg=["fill"],xn=Re({__name:"IconIncomingCall",props:{color:{default:"#fafafa"},size:{default:"24px"}},setup(t){const e=t;return(s,r)=>(V(),J("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[m("path",{d:"M19 5L15 9M15 9V6M15 9H18",stroke:e.color,"stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,8,Ng),m("path",{d:"M10.0376 5.31617L10.6866 6.4791C11.2723 7.52858 11.0372 8.90532 10.1147 9.8278C10.1147 9.8278 10.1147 9.8278 10.1147 9.8278C10.1146 9.82792 8.99588 10.9468 11.0245 12.9755C13.0525 15.0035 14.1714 13.8861 14.1722 13.8853C14.1722 13.8853 14.1722 13.8853 14.1722 13.8853C15.0947 12.9628 16.4714 12.7277 17.5209 13.3134L18.6838 13.9624C20.2686 14.8468 20.4557 17.0692 19.0628 18.4622C18.2258 19.2992 17.2004 19.9505 16.0669 19.9934C14.1588 20.0658 10.9183 19.5829 7.6677 16.3323C4.41713 13.0817 3.93421 9.84122 4.00655 7.93309C4.04952 6.7996 4.7008 5.77423 5.53781 4.93723C6.93076 3.54428 9.15317 3.73144 10.0376 5.31617Z",fill:e.color},null,8,qg)],8,Fg))}}),Bg=["width","height"],Ug=["stroke"],jg=["fill"],nl=Re({__name:"IconOutgoingCall",props:{color:{default:"#fafafa"},size:{default:"24px"}},setup(t){const e=t;return(s,r)=>(V(),J("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[m("path",{d:"M15 9L19 5M19 5V8M19 5H16",stroke:e.color,"stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,8,Ug),m("path",{d:"M10.0376 5.31617L10.6866 6.4791C11.2723 7.52858 11.0372 8.90532 10.1147 9.8278C10.1147 9.8278 10.1147 9.8278 10.1147 9.8278C10.1146 9.82792 8.99588 10.9468 11.0245 12.9755C13.0525 15.0035 14.1714 13.8861 14.1722 13.8853C14.1722 13.8853 14.1722 13.8853 14.1722 13.8853C15.0947 12.9628 16.4714 12.7277 17.5209 13.3134L18.6838 13.9624C20.2686 14.8468 20.4557 17.0692 19.0628 18.4622C18.2258 19.2992 17.2004 19.9505 16.0669 19.9934C14.1588 20.0658 10.9183 19.5829 7.6677 16.3323C4.41713 13.0817 3.93421 9.84122 4.00655 7.93309C4.04952 6.7996 4.7008 5.77423 5.53781 4.93723C6.93076 3.54428 9.15317 3.73144 10.0376 5.31617Z",fill:e.color},null,8,jg)],8,Bg))}}),Vg=["width","height"],Wg=["stroke"],Yg=Re({__name:"IconRefresh",props:{color:{default:"#fafafa"},size:{default:"24px"}},setup(t){const e=t;return(s,r)=>(V(),J("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[m("path",{d:"M21 12C21 16.9706 16.9706 21 12 21C9.69494 21 7.59227 20.1334 6 18.7083L3 16M3 12C3 7.02944 7.02944 3 12 3C14.3051 3 16.4077 3.86656 18 5.29168L21 8M3 21V16M3 16H8M21 3V8M21 8H16",stroke:e.color,"stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,8,Wg)],8,Vg))}}),Kg=["width","height"],Gg={transform:"translate(80,50)"},zg={transform:"rotate(0)"},Xg=["fill"],Jg={transform:"translate(71.21320343559643,71.21320343559643)"},Zg={transform:"rotate(45)"},Qg=["fill"],ep={transform:"translate(50,80)"},tp={transform:"rotate(90)"},sp=["fill"],rp={transform:"translate(28.786796564403577,71.21320343559643)"},ip={transform:"rotate(135)"},np=["fill"],op={transform:"translate(20,50.00000000000001)"},ap={transform:"rotate(180)"},cp=["fill"],lp={transform:"translate(28.78679656440357,28.786796564403577)"},dp={transform:"rotate(225)"},up=["fill"],hp={transform:"translate(49.99999999999999,20)"},fp={transform:"rotate(270)"},gp=["fill"],pp={transform:"translate(71.21320343559643,28.78679656440357)"},mp={transform:"rotate(315)"},vp=["fill"],ol=Re({__name:"LoadingAnimation",props:{color:{default:"#6e44ff"},size:{default:"24px"}},setup(t){const e=t;return(s,r)=>(V(),J("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",style:{"shape-rendering":"auto",display:"block",background:"transparent"},width:e.size,height:e.size,"xmlns:xlink":"http://www.w3.org/1999/xlink"},[m("g",null,[m("g",Gg,[m("g",zg,[m("circle",{"fill-opacity":"1",fill:e.color,r:"6",cy:"0",cx:"0"},r[0]||(r[0]=[m("animateTransform",{repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",values:"1.5 1.5;1 1",begin:"-0.875s",type:"scale",attributeName:"transform"},null,-1),m("animate",{begin:"-0.875s",values:"1;0",repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",attributeName:"fill-opacity"},null,-1)]),8,Xg)])]),m("g",Jg,[m("g",Zg,[m("circle",{"fill-opacity":"0.875",fill:e.color,r:"6",cy:"0",cx:"0"},r[1]||(r[1]=[m("animateTransform",{repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",values:"1.5 1.5;1 1",begin:"-0.75s",type:"scale",attributeName:"transform"},null,-1),m("animate",{begin:"-0.75s",values:"1;0",repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",attributeName:"fill-opacity"},null,-1)]),8,Qg)])]),m("g",ep,[m("g",tp,[m("circle",{"fill-opacity":"0.75",fill:e.color,r:"6",cy:"0",cx:"0"},r[2]||(r[2]=[m("animateTransform",{repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",values:"1.5 1.5;1 1",begin:"-0.625s",type:"scale",attributeName:"transform"},null,-1),m("animate",{begin:"-0.625s",values:"1;0",repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",attributeName:"fill-opacity"},null,-1)]),8,sp)])]),m("g",rp,[m("g",ip,[m("circle",{"fill-opacity":"0.625",fill:e.color,r:"6",cy:"0",cx:"0"},r[3]||(r[3]=[m("animateTransform",{repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",values:"1.5 1.5;1 1",begin:"-0.5s",type:"scale",attributeName:"transform"},null,-1),m("animate",{begin:"-0.5s",values:"1;0",repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",attributeName:"fill-opacity"},null,-1)]),8,np)])]),m("g",op,[m("g",ap,[m("circle",{"fill-opacity":"0.5",fill:e.color,r:"6",cy:"0",cx:"0"},r[4]||(r[4]=[m("animateTransform",{repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",values:"1.5 1.5;1 1",begin:"-0.375s",type:"scale",attributeName:"transform"},null,-1),m("animate",{begin:"-0.375s",values:"1;0",repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",attributeName:"fill-opacity"},null,-1)]),8,cp)])]),m("g",lp,[m("g",dp,[m("circle",{"fill-opacity":"0.375",fill:e.color,r:"6",cy:"0",cx:"0"},r[5]||(r[5]=[m("animateTransform",{repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",values:"1.5 1.5;1 1",begin:"-0.25s",type:"scale",attributeName:"transform"},null,-1),m("animate",{begin:"-0.25s",values:"1;0",repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",attributeName:"fill-opacity"},null,-1)]),8,up)])]),m("g",hp,[m("g",fp,[m("circle",{"fill-opacity":"0.25",fill:e.color,r:"6",cy:"0",cx:"0"},r[6]||(r[6]=[m("animateTransform",{repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",values:"1.5 1.5;1 1",begin:"-0.125s",type:"scale",attributeName:"transform"},null,-1),m("animate",{begin:"-0.125s",values:"1;0",repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",attributeName:"fill-opacity"},null,-1)]),8,gp)])]),m("g",pp,[m("g",mp,[m("circle",{"fill-opacity":"0.125",fill:e.color,r:"6",cy:"0",cx:"0"},r[7]||(r[7]=[m("animateTransform",{repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",values:"1.5 1.5;1 1",begin:"0s",type:"scale",attributeName:"transform"},null,-1),m("animate",{begin:"0s",values:"1;0",repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",attributeName:"fill-opacity"},null,-1)]),8,vp)])]),r[8]||(r[8]=m("g",null,null,-1))])],8,Kg))}}),bp=["width","height"],wp=["stroke"],yp=["stroke"],xp=["stroke"],Cp=["fill"],Tp=["fill"],Ep=["fill"],Sp=["fill"],_p=Re({__name:"IconDate",props:{color:{default:"#fafafa"},size:{default:"18"}},setup(t){const e=t;return(s,r)=>(V(),J("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[m("rect",{x:"3",y:"6",width:"18",height:"15",rx:"2",stroke:e.color},null,8,wp),r[0]||(r[0]=m("path",{d:"M3 10C3 8.11438 3 7.17157 3.58579 6.58579C4.17157 6 5.11438 6 7 6H17C18.8856 6 19.8284 6 20.4142 6.58579C21 7.17157 21 8.11438 21 10H3Z",fill:"props.color"},null,-1)),m("path",{d:"M7 3L7 6",stroke:e.color,"stroke-linecap":"round"},null,8,yp),m("path",{d:"M17 3L17 6",stroke:e.color,"stroke-linecap":"round"},null,8,xp),m("rect",{x:"7",y:"12",width:"4",height:"2",rx:"0.5",fill:e.color},null,8,Cp),m("rect",{x:"7",y:"16",width:"4",height:"2",rx:"0.5",fill:e.color},null,8,Tp),m("rect",{x:"13",y:"12",width:"4",height:"2",rx:"0.5",fill:e.color},null,8,Ep),m("rect",{x:"13",y:"16",width:"4",height:"2",rx:"0.5",fill:e.color},null,8,Sp)],8,bp))}}),Rp={class:"left-content-container"},$p={class:"number-content-wrapper"},Ap={class:"number-identity"},Ip={class:"profile"},Dp={key:2,class:"name"},Hp={class:"number"},Pp={class:"number-info-wrapper"},kp={class:"time"},Op={key:1,class:"empty-message"},Lp=Re({__name:"LeftContent",setup(t,{expose:e}){const s=se(),r=De(),i=wt(()=>r.callHistoryList.data),n=async()=>{console.log("load more",r.callHistoryList.metadata.current_page),await r.fetchHistoryList({loadMore:!0})};return pr(async()=>{await r.fetchHistoryList({q:""})}),e({loadMore:n}),(o,a)=>(V(),J(pe,null,[a[2]||(a[2]=m("div",{class:"left-action-container"},null,-1)),m("div",Rp,[ue(q(il),{ref_key:"phoneListPS",ref:s,options:{wheelPropagation:!0,suppressScrollY:!0},class:"the-ps-scrollbar",onPsYReachEnd:n},{default:On(()=>[q(r).callHistoryList.data&&q(r).callHistoryList.data.length>0?(V(!0),J(pe,{key:0},qa(i.value,(c,d)=>{var l;return V(),J("div",{key:d,class:"number-container"},[m("div",{style:ae(q(r).cssVars),class:"number-profile-wrapper"},a[0]||(a[0]=[m("img",{src:Qc,width:"32"},null,-1)]),4),m("div",$p,[m("div",Ap,[m("div",Ip,[c.callType==="incoming"?(V(),Xe(xn,{key:0,class:"icon",color:q(r).cssVars["--success"],size:24},null,8,["color"])):c.callType==="outgoing"?(V(),Xe(nl,{key:1,class:"icon",color:q(r).cssVars["--error"],size:24},null,8,["color"])):Ge("",!0),c.number?(V(),J("span",Dp,Ie(c.number),1)):Ge("",!0)]),m("span",Hp,[ue(_p,{color:"#1b1b1b",size:14}),Oe(" "+Ie(c.time instanceof Date?q(og)(c.time,"DD/MM/YY"):c.time),1)])])]),m("div",Pp,[m("span",{style:ae(q(r).cssVars),class:Te(["call-type",(l=c==null?void 0:c.status)==null?void 0:l.toString()])},Ie(c.status),7),m("span",kp,Ie(c.timeElapsed),1)])])}),128)):(V(),J("div",Op,[a[1]||(a[1]=Oe(" empty call history ")),q(r).callHistoryList.isLoading?(V(),Xe(ol,{key:1,size:18,color:q(r).cssVars["--info"]},null,8,["color"])):(V(),Xe(Yg,{key:0,class:"refresh-btn",size:16,color:"#1b1b1b",onClick:ye(n,["stop","prevent"])}))]))]),_:1},512)])],64))}}),Mp=os(Lp,[["__scopeId","data-v-8f8f82ba"]]),Fp=["width","height"],Np={id:"style=fill"},qp={id:"call"},Bp=["fill"],Up=["fill"],Fr=Re({__name:"IconCall",props:{color:{default:"#fafafa"},size:{default:"250px"}},setup(t){const e=t;return(s,r)=>(V(),J("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[m("g",Np,[m("g",qp,[m("path",{id:"vector",d:"M21.97 18.33C21.97 18.69 21.89 19.06 21.72 19.42C21.6258 19.6195 21.5163 19.8128 21.388 20C21.3433 20.0651 21.2964 20.1295 21.2471 20.1931C21.1824 20.2767 21.1134 20.359 21.04 20.44C20.8504 20.6489 20.6534 20.8354 20.4476 21C20.1217 21.2608 19.774 21.4667 19.4 21.62C18.8 21.87 18.15 22 17.45 22C16.43 22 15.34 21.76 14.19 21.27C13.04 20.78 11.89 20.12 10.75 19.29C9.6 18.45 8.51 17.52 7.47 16.49C6.44 15.45 5.51 14.36 4.68 13.22C3.86 12.08 3.2 10.94 2.72 9.81C2.24 8.67 2 7.58 2 6.54C2 5.86 2.12 5.21 2.36 4.61C2.6 4 2.98 3.44 3.51 2.94C4.15 2.31 4.85 2 5.59 2C5.87 2 6.15 2.06 6.4 2.18C6.66 2.3 6.89 2.48 7.07 2.74L9.39 6.01C9.57 6.26 9.7 6.49 9.79 6.71C9.88 6.92 9.93 7.13 9.93 7.32C9.93 7.56 9.86 7.8 9.72 8.03C9.59 8.26 9.4 8.5 9.16 8.74L8.4 9.53C8.29 9.64 8.24 9.77 8.24 9.93C8.24 10.01 8.25 10.08 8.27 10.16C8.3 10.24 8.33 10.3 8.35 10.36C8.53 10.69 8.84 11.12 9.28 11.64C9.73 12.16 10.21 12.69 10.73 13.22C11.27 13.75 11.79 14.24 12.32 14.69C12.84 15.13 13.27 15.43 13.61 15.61C13.66 15.63 13.72 15.66 13.79 15.69C13.87 15.72 13.95 15.73 14.04 15.73C14.21 15.73 14.34 15.67 14.45 15.56L15.21 14.81C15.46 14.56 15.7 14.37 15.93 14.25C16.16 14.11 16.39 14.04 16.64 14.04C16.83 14.04 17.03 14.08 17.25 14.17C17.47 14.26 17.7 14.39 17.95 14.56L21.26 16.91C21.52 17.09 21.7 17.3 21.81 17.55C21.91 17.8 21.97 18.05 21.97 18.33Z",fill:e.color},null,8,Bp),m("path",{id:"vector (Stroke)","fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.98958 2.39989C3.74153 1.66198 4.62059 1.25 5.59 1.25C5.97318 1.25 6.36311 1.33138 6.71941 1.5014C7.08755 1.67229 7.42309 1.93393 7.68396 2.30922L10.0003 5.574C10.2053 5.85906 10.3657 6.13796 10.4818 6.42035C10.5997 6.6971 10.68 7.00644 10.68 7.32C10.68 7.70687 10.5673 8.07663 10.367 8.40939C10.1968 8.70784 9.96427 8.99567 9.69563 9.26502L9.00688 9.98096C9.01385 9.99743 9.02321 10.0197 9.03333 10.0455C9.183 10.3079 9.44802 10.6772 9.84989 11.1524C10.29 11.6609 10.7568 12.1761 11.2604 12.6897C11.7923 13.2116 12.2961 13.6858 12.8048 14.1178C13.2858 14.5247 13.6606 14.7841 13.933 14.9322C13.955 14.9417 13.9753 14.9509 13.9918 14.9584L14.6815 14.2778C14.955 14.0046 15.2482 13.7638 15.5612 13.5966C15.8882 13.4019 16.2447 13.29 16.64 13.29C16.9399 13.29 17.2362 13.354 17.534 13.4758C17.8169 13.5916 18.0939 13.7509 18.3717 13.9398L18.378 13.9441L21.6909 16.2961C22.0455 16.5425 22.3234 16.8545 22.4965 17.2479L22.5016 17.2596L22.5064 17.2715C22.6338 17.59 22.72 17.9351 22.72 18.33C22.72 18.8025 22.6147 19.2817 22.3982 19.7403C22.2879 19.9738 22.1587 20.2021 22.0066 20.424C21.9538 20.5011 21.8983 20.5773 21.84 20.6525C21.7634 20.7514 21.682 20.8484 21.5957 20.9436C21.3815 21.1797 21.1554 21.3943 20.9162 21.5856C20.537 21.8891 20.1283 22.1318 19.6865 22.3131C18.9922 22.6021 18.2445 22.75 17.45 22.75C16.3114 22.75 15.1213 22.4821 13.896 21.96C12.6885 21.4455 11.4895 20.7561 10.3086 19.8963L10.3076 19.8956C9.12671 19.0331 8.00824 18.0786 6.94224 17.0229L6.93709 17.0178C5.88147 15.9519 4.92677 14.8332 4.07368 13.6614L4.07114 13.658C3.22474 12.4813 2.5351 11.293 2.0297 10.1032L2.02877 10.101C1.51719 8.88605 1.25 7.69701 1.25 6.54C1.25 5.77184 1.3856 5.02732 1.66286 4.33342C1.94487 3.61753 2.38783 2.96904 2.98958 2.39989Z",fill:e.color},null,8,Up)])])],8,Fp))}}),al="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20fill='%231b1b1b'%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='18'%20height='18'%20viewBox='0%200%2072%2072'%20enable-background='new%200%200%2072%2072'%20xml:space='preserve'%3e%3cg%3e%3cpath%20d='M48.252,69.253c-2.271,0-4.405-0.884-6.011-2.489L17.736,42.258c-1.646-1.645-2.546-3.921-2.479-6.255%20c-0.068-2.337,0.833-4.614,2.479-6.261L42.242,5.236c1.605-1.605,3.739-2.489,6.01-2.489c2.271,0,4.405,0.884,6.01,2.489%20c3.314,3.314,3.314,8.707,0,12.021L35.519,36l18.743,18.742c3.314,3.314,3.314,8.707,0,12.021%20C52.656,68.369,50.522,69.253,48.252,69.253z%20M48.252,6.747c-1.202,0-2.332,0.468-3.182,1.317L21.038,32.57%20c-0.891,0.893-0.833,2.084-0.833,3.355c0,0.051,0,0.101,0,0.151c0,1.271-0.058,2.461,0.833,3.353l24.269,24.506%20c0.85,0.85,1.862,1.317,3.063,1.317c1.203,0,2.273-0.468,3.123-1.317c1.755-1.755,1.725-4.61-0.03-6.365L31.292,37.414%20c-0.781-0.781-0.788-2.047-0.007-2.828L51.438,14.43c1.754-1.755,1.753-4.61-0.001-6.365C50.587,7.215,49.454,6.747,48.252,6.747z'%20/%3e%3c/g%3e%3c/svg%3e",jp="data:image/svg+xml,%3csvg%20width='24px'%20height='24px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M16%209L13.0001%2011.9999M13.0001%2011.9999L10%2015M13.0001%2011.9999L10.0002%209M13.0001%2011.9999L16.0002%2015M8%206H19C19.5523%206%2020%206.44772%2020%207V17C20%2017.5523%2019.5523%2018%2019%2018H8L2%2012L8%206Z'%20stroke='%23000000'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",Vp={class:"header"},Wp={class:"numpad-wrapper"},Yp=["value","onClick"],Kp=Re({__name:"Dialpad",emits:["hide"],setup(t,{emit:e}){const s=e,r=se(),i=se(),n=se([]),o=wt(()=>[{val:1,desc:"_"},{val:2,desc:"ABC"},{val:3,desc:"DEF"},{val:4,desc:"GHI"},{val:5,desc:"JKL"},{val:6,desc:"MNO"},{val:7,desc:"PQRS"},{val:8,desc:"TUV"},{val:9,desc:"WXYZ"},{val:"*",desc:""},{val:0,desc:""},{val:"#",desc:""}]);return(a,c)=>(V(),J(pe,null,[m("div",Vp,[m("a",{class:"btn-pointer",onClick:c[0]||(c[0]=d=>s("hide"))},c[2]||(c[2]=[m("img",{class:"hide-img",src:al},null,-1)])),m("p",{ref_key:"showPickedRef",ref:r,class:"picked"},Ie(n.value.join("")),513),m("a",{class:"btn-pointer",onClick:c[1]||(c[1]=(...d)=>n.value.pop&&n.value.pop(...d))},c[3]||(c[3]=[m("img",{src:jp},null,-1)]))]),m("div",Wp,[m("div",{ref_key:"btnsRef",ref:i,class:"btns"},[(V(!0),J(pe,null,qa(o.value,(d,l)=>(V(),J("button",{key:l,value:d.val,class:"btn",onClick:u=>n.value.push(d.val)},[m("p",null,Ie(d.val),1),m("p",null,Ie(d.desc),1)],8,Yp))),128))],512)])],64))}}),ea=os(Kp,[["__scopeId","data-v-1ff2c377"]]),Gp=["fill","width","height"],zp=Re({__name:"IconRejectCall",props:{color:{default:"#fafafa"},size:{default:"24px"}},setup(t){const e=t;return(s,r)=>(V(),J("svg",{id:"Capa_1",fill:e.color,version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:e.size,height:e.size,viewBox:"0 0 523.158 523.158","xml:space":"preserve"},r[0]||(r[0]=[m("g",null,[m("path",{d:`M166.551,348.433c0.258,0.334,0.478,0.631,0.746,0.984c0.22,0.297,0.488,0.641,0.708,0.956
		c12.374,16.199,25.226,31.241,38.279,45.098l-26.66,97.47c-3.481,12.729,4.016,25.877,16.753,29.357
		c2.113,0.583,4.227,0.86,6.312,0.86c10.518,0,20.138-6.98,23.045-17.614l19.852-72.569c6.493,5.527,12.985,10.824,19.421,15.663
		l33.546,22.224c11.092,6.33,21.888,11.484,32.158,15.214c33.909,14.975,74.731,11.646,106.373-12.316
		c14.038-10.605,24.634-24.079,31.662-38.948c4.063-6.723,3.882-15.549-1.177-22.233L377.06,292.951
		c-4.753-6.283-12.432-8.836-19.632-7.45l-0.058-0.086c-16.696,2.592-33.058,9.247-47.525,20.196
		c-9.744,7.354-17.854,16.084-24.251,25.694c-3.127-3.385-6.206-7.047-9.313-10.566l47.603-174.057
		c3.48-12.728-4.017-25.876-16.754-29.356c-12.766-3.5-25.876,4.025-29.356,16.753l-38.479,140.703
		c-16.094-21.621-42.285-57.088-49.993-69.692c10.987-3.538,21.611-8.95,31.336-16.313c14.478-10.939,25.312-24.872,32.321-40.287
		l-0.02-0.039c3.279-6.541,2.84-14.716-1.874-20.942L160.555,7.893c-5.078-6.703-13.521-9.275-21.104-7.182
		c-16.208,2.707-32.073,9.266-46.101,19.861C61.708,44.536,47.412,82.91,52.604,119.611
		C56.449,172.004,114.684,279.257,166.551,348.433z`})],-1)]),8,Gp))}}),Xp=["fill","height","width"],Jp=Re({__name:"IconAnswerCall",props:{color:{default:"#fafafa"},size:{default:"24px"}},setup(t){const e=t;return(s,r)=>(V(),J("svg",{id:"Capa_1",fill:e.color,version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",height:e.size,width:e.size,viewBox:"0 0 580.178 580.178","xml:space":"preserve"},r[0]||(r[0]=[m("g",null,[m("path",{d:`M239.49,0.582c-8.578-2.419-18.159,2.955-20.636,11.514l-18.705,65.551c-2.553,8.864,2.611,18.149,11.59,20.731
		c1.473,0.411,2.983,0.612,4.504,0.612c1.76,0,3.5-0.277,5.25-0.852c5.27-1.759,9.323-5.977,10.844-11.303l18.714-65.58
		C253.566,12.411,248.402,3.135,239.49,0.582z`}),m("path",{d:`M240.886,134.399c3.146,4.036,8.09,6.445,13.216,6.445c1.769,0,3.51-0.277,5.316-0.871c1.76-0.612,3.414-1.482,4.973-2.677
		l104.165-81.31c7.258-5.689,8.539-16.218,2.858-23.495c-5.374-6.847-16.505-8.281-23.476-2.878l-104.164,81.31
		C236.516,116.604,235.225,127.123,240.886,134.399z`}),m("path",{d:`M354.049,141.925l-70.715,18.178c-8.31,2.744-13.12,11.551-10.93,20.072c1.912,7.382,8.567,12.546,16.199,12.546
		c1.396,0,2.792-0.182,4.149-0.526l69.778-17.892l0.937-0.268c8.349-2.745,13.168-11.571,10.969-20.043
		C372.208,145.243,362.999,139.668,354.049,141.925z`}),m("path",{d:`M163.009,90.25c-16.15,3.021-31.881,9.868-45.699,20.731c-31.202,24.547-44.771,63.198-38.871,99.794
		c4.81,52.297,65.072,158.442,118.212,226.623c0.258,0.335,0.497,0.631,0.755,0.984c0.239,0.277,0.517,0.612,0.746,0.938
		c31.527,39.713,65.838,72.551,98.828,96.429l33.938,21.582c11.227,6.12,22.108,11.073,32.465,14.593
		c34.177,14.354,74.941,10.241,106.125-14.315c13.827-10.872,24.184-24.519,30.915-39.541c3.931-6.799,3.605-15.615-1.587-22.204
		l-92.757-117.896c-4.867-6.187-12.584-8.596-19.756-7.085l-0.058-0.067c-16.629,2.907-32.866,9.85-47.143,21.076
		c-9.582,7.535-17.547,16.418-23.753,26.144c-12.737-13.264-25.303-27.636-37.515-42.945
		c-12.049-15.491-51.245-65.943-61.161-81.444c10.948-3.749,21.448-9.362,31.039-16.897c14.268-11.226,24.854-25.34,31.557-40.879
		l-0.01-0.039c3.156-6.607,2.554-14.764-2.275-20.913L184.247,97.039C179.055,90.431,170.554,88.012,163.009,90.25z`})],-1)]),8,Xp))}}),Zp=["width","height"],Qp={id:"页面-1",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},e0={id:"Arrow",transform:"translate(-912.000000, 0.000000)","fill-rule":"nonzero"},t0={id:"transfer_line",transform:"translate(912.000000, 0.000000)"},s0=["fill"],Ki=Re({__name:"IconTransferCall",props:{color:{default:"#fafafa"},size:{default:"24px"}},setup(t){const e=t;return(s,r)=>(V(),J("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[m("g",Qp,[m("g",e0,[m("g",t0,[r[0]||(r[0]=m("path",{id:"MingCute",d:"M24,0 L24,24 L0,24 L0,0 L24,0 Z M12.5934901,23.257841 L12.5819402,23.2595131 L12.5108777,23.2950439 L12.4918791,23.2987469 L12.4918791,23.2987469 L12.4767152,23.2950439 L12.4056548,23.2595131 C12.3958229,23.2563662 12.3870493,23.2590235 12.3821421,23.2649074 L12.3780323,23.275831 L12.360941,23.7031097 L12.3658947,23.7234994 L12.3769048,23.7357139 L12.4804777,23.8096931 L12.4953491,23.8136134 L12.4953491,23.8136134 L12.5071152,23.8096931 L12.6106902,23.7357139 L12.6232938,23.7196733 L12.6232938,23.7196733 L12.6266527,23.7031097 L12.609561,23.275831 C12.6075724,23.2657013 12.6010112,23.2592993 12.5934901,23.257841 L12.5934901,23.257841 Z M12.8583906,23.1452862 L12.8445485,23.1473072 L12.6598443,23.2396597 L12.6498822,23.2499052 L12.6498822,23.2499052 L12.6471943,23.2611114 L12.6650943,23.6906389 L12.6699349,23.7034178 L12.6699349,23.7034178 L12.678386,23.7104931 L12.8793402,23.8032389 C12.8914285,23.8068999 12.9022333,23.8029875 12.9078286,23.7952264 L12.9118235,23.7811639 L12.8776777,23.1665331 C12.8752882,23.1545897 12.8674102,23.1470016 12.8583906,23.1452862 L12.8583906,23.1452862 Z M12.1430473,23.1473072 C12.1332178,23.1423925 12.1221763,23.1452606 12.1156365,23.1525954 L12.1099173,23.1665331 L12.0757714,23.7811639 C12.0751323,23.7926639 12.0828099,23.8018602 12.0926481,23.8045676 L12.108256,23.8032389 L12.3092106,23.7104931 L12.3186497,23.7024347 L12.3186497,23.7024347 L12.3225043,23.6906389 L12.340401,23.2611114 L12.337245,23.2485176 L12.337245,23.2485176 L12.3277531,23.2396597 L12.1430473,23.1473072 Z","fill-rule":"nonzero"},null,-1)),m("path",{id:"形状",d:"M20,14 C20.5523,14 21,14.4477 21,15 C21,15.51285 20.613973,15.9355092 20.1166239,15.9932725 L20,16 L6.41421,16 L8.70711,18.2929 C9.09763,18.6834 9.09763,19.3166 8.70711,19.7071 C8.34662077,20.0675615 7.77939355,20.0952893 7.38709848,19.7902834 L7.29289,19.7071 L3.4636,15.8778 C2.7983584,15.212616 3.2240608,14.0940048 4.12621381,14.0055802 L4.24142,14 L20,14 Z M15.2929,4.29289 C15.6533615,3.93241 16.2206207,3.90468077 16.6128973,4.20970231 L16.7071,4.29289 L20.5364,8.12218 C21.20168,8.7874312 20.7759699,9.90599901 19.8738074,9.99442003 L19.7586,10 L4,10 C3.44772,10 3,9.55228 3,9 C3,8.48716857 3.38604429,8.06449347 3.88337975,8.0067278 L4,8 L17.5858,8 L15.2929,5.70711 C14.9024,5.31658 14.9024,4.68342 15.2929,4.29289 Z",fill:e.color},null,8,s0)])])])],8,Zp))}}),r0=["fill","width","height"],i0=Re({__name:"IconArrowLeft",props:{color:{default:"#fafafa"},size:{default:"250px"}},setup(t){const e=t;return(s,r)=>(V(),J("svg",{id:"Layer_1",fill:e.color,version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:e.size,height:e.size,viewBox:"0 0 72 72","enable-background":"new 0 0 72 72","xml:space":"preserve"},r[0]||(r[0]=[m("g",null,[m("path",{d:`M48.252,69.253c-2.271,0-4.405-0.884-6.011-2.489L17.736,42.258c-1.646-1.645-2.546-3.921-2.479-6.255
		c-0.068-2.337,0.833-4.614,2.479-6.261L42.242,5.236c1.605-1.605,3.739-2.489,6.01-2.489c2.271,0,4.405,0.884,6.01,2.489
		c3.314,3.314,3.314,8.707,0,12.021L35.519,36l18.743,18.742c3.314,3.314,3.314,8.707,0,12.021
		C52.656,68.369,50.522,69.253,48.252,69.253z M48.252,6.747c-1.202,0-2.332,0.468-3.182,1.317L21.038,32.57
		c-0.891,0.893-0.833,2.084-0.833,3.355c0,0.051,0,0.101,0,0.151c0,1.271-0.058,2.461,0.833,3.353l24.269,24.506
		c0.85,0.85,1.862,1.317,3.063,1.317c1.203,0,2.273-0.468,3.123-1.317c1.755-1.755,1.725-4.61-0.03-6.365L31.292,37.414
		c-0.781-0.781-0.788-2.047-0.007-2.828L51.438,14.43c1.754-1.755,1.753-4.61-0.001-6.365C50.587,7.215,49.454,6.747,48.252,6.747z`})],-1)]),8,r0))}}),n0={class:"container"},o0={class:"header"},a0=["disabled"],c0={class:"btn-group"},l0=["disabled"],d0=["disabled"],u0={class:"btn-group"},h0=["disabled"],f0=["disabled"],g0={class:"desc"},p0={class:"btn-group"},m0=["disabled"],v0=["disabled"],b0=Re({__name:"TransferCall",props:{call:{},isShow:{type:Boolean}},emits:["hide"],setup(t,{emit:e}){const s=t,r=e,i=De(),n=Bt(),o=se("choose"),a=se(),c=se(),d=se(),l=wt(()=>o.value==="choose"),u=wt(()=>{var I;const A=!!c.value,f=((I=d.value)==null?void 0:I.type)!=="error";return A&&f}),p=async A=>{a.value=A,A==="unintended"&&o.value==="choose"||A==="unintended"&&o.value==="confirm"?o.value="confirm":o.value="wait"},y=async()=>{const A=c.value;let f;await et(),a.value==="unintended"?f=await n.blindTransfer(A):f=await n.attendendTransfer(A),f&&a.value==="unintended"&&r("hide")},w=Qr(()=>{const A=c.value||"",f=/^[\+0-9]+$/,I=/^(?:\+?\d+)$/;return f.test(A)?I.test(A)?d.value={type:"success",msg:""}:d.value={type:"error",msg:"+ only allowed on the at the start"}:d.value={type:"error",msg:"value must be a number"}},350),C=async({wait:A=!1})=>{A&&console.log("stop handshake"),await et(),o.value="choose"};return ht(()=>s.isShow,async()=>{}),(A,f)=>{var I,j;return V(),J("div",n0,[m("div",o0,[m("a",{class:"btn-pointer",onClick:f[0]||(f[0]=R=>r("hide"))},f[8]||(f[8]=[m("img",{class:"hide-img",src:al},null,-1)])),f[9]||(f[9]=m("p",{class:"title"}," TRANSFER TO ",-1)),f[10]||(f[10]=m("div",null,null,-1))]),m("div",{class:Te(["content",`${o.value}`]),style:ae(q(i).cssVars)},[mt(m("input",{"onUpdate:modelValue":f[1]||(f[1]=R=>c.value=R),disabled:!l.value,placeholder:"+6285XXXXX....",onInput:f[2]||(f[2]=(...R)=>q(w)&&q(w)(...R))},null,40,a0),[[Os,c.value]]),o.value==="choose"?(V(),J(pe,{key:0},[mt(m("p",{class:Te(["msg-info",`${(I=d.value)==null?void 0:I.type}`])},Ie(((j=d.value)==null?void 0:j.msg)||""),3),[[tr,d.value&&d.value.msg]]),f[11]||(f[11]=m("p",{class:"desc italic"}," pick one of the following method ",-1)),m("div",c0,[m("button",{disabled:!u.value,class:"button intended",onClick:f[3]||(f[3]=ye(R=>p("intended"),["stop","prevent"]))}," intended ",8,l0),m("button",{disabled:!u.value,class:"button unintended",onClick:f[4]||(f[4]=ye(R=>p("unintended"),["stop","prevent"]))}," unintended ",8,d0)])],64)):o.value==="wait"?(V(),J(pe,{key:1},[f[12]||(f[12]=m("p",{class:"desc italic"}," please wait for other to respond... ",-1)),m("div",u0,[m("button",{disabled:!u.value,class:"button cancel",onClick:f[5]||(f[5]=ye(R=>C({wait:!0}),["stop","prevent"]))}," cancel ",8,h0),m("button",{disabled:!q(i).transfer.intended.handshake,class:Te([[{disabled:!q(i).transfer.intended.handshake}],"button confirm"]),onClick:f[6]||(f[6]=R=>p("unintended"))}," confirm ",10,f0)])],64)):o.value==="confirm"?(V(),J(pe,{key:2},[m("p",g0,[f[13]||(f[13]=Oe(" call will be transfered to ")),m("span",{style:ae(q(i).cssVars),class:"bold underlined info"},Ie(c.value),5),f[14]||(f[14]=Oe(" using ")),m("span",{style:ae(q(i).cssVars),class:"bold underlined info"},Ie(a.value),5),f[15]||(f[15]=Oe(" transfer mode "))]),m("div",p0,[m("button",{disabled:!u.value,class:"button cancel",onClick:f[7]||(f[7]=ye(R=>C({wait:!1}),["stop","prevent"]))}," cancel ",8,m0),m("button",{disabled:!u.value,class:Te(["button confirm",[{disabled:!u.value}]]),onClick:ye(y,["stop","prevent"])}," confirm ",10,v0)])],64)):Ge("",!0)],6)])}}}),w0=os(b0,[["__scopeId","data-v-4b8fc2ca"]]),y0={class:"right-sidebar-wrapper"},x0={class:"header"},C0={class:"hide-btn-wrapper"},T0={class:"title"},E0={class:"content"},S0={class:"calling-profile"},_0={class:"call-number"},R0={class:"call-status"},$0={class:"status"},A0={key:0,class:"button-group"},I0={key:1,class:"button-group"},D0={key:0,class:"button-group"},H0={class:"button-group"},P0={class:"input-phone-call-wrapper"},k0=["onKeydown"],O0={class:"button-group"},L0=["disabled"],M0=["isShow"],F0=Re({__name:"RightContent",props:{call:{},displayMode:{}},emits:["hide","update:displayType"],setup(t,{expose:e,emit:s}){const r=De(),i=Bt(),n=s,o=t,a=se(!1),c=se(!1),d=se(),l=se(),u=se(),p=async()=>{await et(),a.value=!1,n("hide")},y=async({type:j="cancel"})=>{await et(),await i.endCall(),d.value=void 0,n("hide")},w=async()=>{await i.answerCall()},C=wt(()=>o.displayMode==="activeCall"&&o.call?o.call.type:o.displayMode==="newCall"?"New Call":o.displayMode||""),A=wt(()=>{if(!r.activeCall)return!0;const j=r.activeCall.type==="outgoing",R=["dialing"].includes(r.activeCall.status),W=typeof l.value=="string";return j&&R&&W}),f=async()=>{var j;if(l.value=void 0,await et(),!r.activeCall){if(((j=i.sipStatus.registerStatus)==null?void 0:j.toLocaleLowerCase())!=="registered")return l.value="SIP server not connected";if(!i.localMediaPermission)return i.InitiateLocalMedia(),l.value="please allow audio access";await i.initiateCall(d.value)}},I=Qr(()=>{const j=(d.value||"").trim(),R=/^[\+0-9]+$/,W=/^(?:\+?\d+)$/;if(!R.test(j))return l.value="value must be a number.";if(!W.test(j))return l.value="+ only allowed at the start.";d.value=j,l.value=void 0},350);return e({inputNumberRef:u}),(j,R)=>{var W,xe,he,h,ee,we,b;return V(),J("div",y0,[m("div",x0,[m("div",C0,[ue(i0,{class:"hide-btn",color:"#1b1b1b",size:18,onClick:ye(p,["stop"])})]),m("div",{class:Te(["header-title",[`${(W=o.call)==null?void 0:W.type}`,`${o.displayMode}`]])},[m("span",T0,Ie(C.value),1),o.displayMode==="activeCall"&&((xe=o.call)==null?void 0:xe.type)==="incoming"?(V(),Xe(xn,{key:0,color:q(r).cssVars["--success"],size:"24px"},null,8,["color"])):o.displayMode==="activeCall"&&((he=o.call)==null?void 0:he.type)==="outgoing"?(V(),Xe(nl,{key:1,color:q(r).cssVars["--error"],size:"24px"},null,8,["color"])):o.displayMode==="newCall"?(V(),Xe(Zc,{key:2,color:q(r).cssVars["--primary"],size:"18px"},null,8,["color"])):Ge("",!0)],2),R[15]||(R[15]=m("div",{class:"hide-btn-wrapper"},null,-1))]),m("div",E0,[o.displayMode==="activeCall"?(V(),J(pe,{key:0},[m("div",S0,[m("span",_0,Ie((h=o.call)==null?void 0:h.number),1),R[16]||(R[16]=m("img",{src:Qc},null,-1))]),m("div",R0,[m("span",$0,Ie((ee=o.call)==null?void 0:ee.status),1),mt(m("span",{class:"time-elapsed"},Ie(q(i).formatedTimeElapsed),513),[[tr,o.call&&!["dialing","rejected"].includes(o.call.status)]])]),((we=o.call)==null?void 0:we.type)==="outgoing"?(V(),J(pe,{key:0},[o.call.status==="connected"?(V(),J("div",A0,[m("button",{class:"hangup",style:ae(q(r).cssVars),onClick:R[0]||(R[0]=ye(T=>y({}),["stop"]))},[ue(Fr,{color:"#fafafa",size:"18px"}),R[17]||(R[17]=Oe(" hang up "))],4),m("button",{class:"transfer",style:ae(q(r).cssVars),onClick:R[1]||(R[1]=ye(T=>c.value=!c.value,["stop"]))},[ue(Ki,{color:"#fafafa",size:"18px"}),R[18]||(R[18]=Oe(" Transfer "))],4),Ge("",!0)])):o.call.status==="dialing"?(V(),J("div",I0,[m("button",{class:"hangup",style:ae(q(r).cssVars),onClick:R[3]||(R[3]=ye(T=>y({}),["stop"]))},[ue(Fr,{color:"#fafafa",size:"18px"}),R[20]||(R[20]=Oe(" cancel "))],4)])):Ge("",!0)],64)):Ge("",!0),((b=o.call)==null?void 0:b.type)==="incoming"?(V(),J(pe,{key:1},[o.call.status==="incoming"?(V(),J("div",D0,[m("button",{class:"hangup",style:ae(q(r).cssVars),onClick:R[4]||(R[4]=ye(T=>y({type:"reject"}),["stop"]))},[ue(zp,{color:"#fafafa",size:"18px"}),R[21]||(R[21]=Oe(" Reject "))],4),m("button",{class:"answer",style:ae(q(r).cssVars),onClick:ye(w,["stop","prevent"])},[ue(Jp,{color:"#fafafa",size:"18px"}),R[22]||(R[22]=Oe(" Answer "))],4),m("button",{class:"transfer",style:ae(q(r).cssVars),onClick:R[5]||(R[5]=ye(T=>c.value=!c.value,["stop"]))},[ue(Ki,{color:"#fafafa",size:"18px"}),R[23]||(R[23]=Oe(" Transfer "))],4)])):o.call.status==="connected"?(V(),J(pe,{key:1},[m("div",H0,[m("button",{class:"hangup",style:ae(q(r).cssVars),onClick:R[6]||(R[6]=ye(T=>y({type:"hangup"}),["stop","stop"]))},[ue(Fr,{color:"#fafafa",size:"18px"}),R[24]||(R[24]=Oe(" hang up "))],4),m("button",{class:"transfer",style:ae(q(r).cssVars),onClick:R[7]||(R[7]=ye(T=>c.value=!c.value,["stop"]))},[ue(Ki,{color:"#fafafa",size:"18px"}),R[25]||(R[25]=Oe(" Transfer "))],4),Ge("",!0)]),a.value?(V(),J("div",{key:0,class:Te(["dialpad",[{show:a.value}]])},[ue(ea,{onHide:R[9]||(R[9]=T=>a.value=!1)})],2)):Ge("",!0)],64)):Ge("",!0)],64)):Ge("",!0)],64)):o.displayMode==="newCall"?(V(),J(pe,{key:1},[m("div",P0,[mt(m("input",{ref_key:"inputNumberRef",ref:u,"onUpdate:modelValue":R[10]||(R[10]=T=>d.value=T),placeholder:"Input number",onInput:R[11]||(R[11]=ye((...T)=>q(I)&&q(I)(...T),["prevent"])),onKeydown:cn(ye(f,["stop","prevent"]),["enter"])},null,40,k0),[[Os,d.value]]),m("p",{style:ae(q(r).cssVars),class:"err-msg"},Ie(l.value),5)]),m("div",O0,[m("button",{class:"hangup",style:ae(q(r).cssVars),onClick:R[12]||(R[12]=ye(T=>y({}),["stop"]))}," Cancel ",4),m("button",{class:"answer",style:ae(q(r).cssVars),disabled:!A.value,onClick:ye(f,["stop"])},[ue(xn,{color:"#fafafa",size:"18px"}),R[27]||(R[27]=Oe(" Call "))],12,L0)])],64)):Ge("",!0),mt(m("div",null,[ue(w0,{class:Te([{show:c.value},"transfer popup"]),call:o.call,"is-show":c.value,onHide:R[13]||(R[13]=T=>c.value=!1)},null,8,["class","call","is-show"])],512),[[tr,c.value]]),mt(m("div",{class:Te(["dialpad",[{show:a.value}]]),isShow:a.value},[ue(ea,{onHide:R[14]||(R[14]=T=>a.value=!1)})],10,M0),[[tr,a.value]])])])}}}),N0=os(F0,[["__scopeId","data-v-aee62584"]]),q0={class:"container"},B0={class:"content-form"},U0=["onKeydown"],j0=["onKeydown"],V0={class:"btn-field"},W0=Re({__name:"LoginPage",setup(t){const e=De(),s=se(),r=se({extension:"",secret:""}),i=se(!1),n=se(!1),o=async d=>{if(d.preventDefault(),!e.isLoading.submitLogin){if(!r.value)return console.error("user data not valid");await e.signInWidget(r.value)}},a=()=>{r.value&&(i.value=!r.value.extension.trim())},c=()=>{r.value&&(n.value=!r.value.secret.trim())};return ht(()=>[i.value,n.value],()=>{(i.value||n.value)&&(s.value="Please provide the required field")},{immediate:!1}),(d,l)=>(V(),J(pe,null,[l[7]||(l[7]=m("div",{class:"login-header"},[m("span",{class:"title-header"}," C-ICare WebRTC ")],-1)),m("div",q0,[l[5]||(l[5]=m("div",{class:"description"},[m("span",{class:"desc-text"},"Please fill in the form below to access autodial")],-1)),m("div",B0,[m("div",{class:Te([{error:i.value},"field-input-widget"])},[l[3]||(l[3]=m("label",{class:"label"},[Oe("Name"),m("span",{class:"required"},"*")],-1)),mt(m("input",{"onUpdate:modelValue":l[0]||(l[0]=u=>r.value.extension=u),style:ae(q(e).cssVars),type:"text",class:"input-widget",placeholder:"Extensions",onInput:ye(a,["prevent","stop"]),onKeydown:cn(ye(o,["prevent","stop"]),["enter"])},null,44,U0),[[Os,r.value.extension]])],2),m("div",{class:Te([{error:n.value},"field-input-widget"])},[l[4]||(l[4]=m("label",{class:"label"},[Oe("Email"),m("span",{class:"required"},"*")],-1)),mt(m("input",{"onUpdate:modelValue":l[1]||(l[1]=u=>r.value.secret=u),style:ae(q(e).cssVars),type:"text",class:"input-widget",placeholder:"Password / Secret",onInput:ye(c,["prevent","stop"]),onKeydown:cn(ye(o,["prevent","stop"]),["enter"])},null,44,j0),[[Os,r.value.secret]])],2)]),m("div",V0,[m("button",{class:Te(["submit-button-form-widget",{"is-loading":q(e).isLoading.submitLogin}]),onClick:l[2]||(l[2]=ye((...u)=>o&&o(...u),["stop","prevent"]))},[q(e).isLoading.submitLogin?(V(),Xe(ol,{key:0,size:18,color:q(e).cssVars["--info"]},null,8,["color"])):(V(),J(pe,{key:1},[Oe(" Submit ")],64))],2)]),m("div",{class:Te([{error:!!s.value},"error-message-widget"])},[m("span",null,Ie(s.value),1)],2)]),m("div",{style:ae(q(e).cssVars),class:"footer"},l[6]||(l[6]=[m("pre",null,"© 2024",-1)]),4)],64))}}),Y0=os(W0,[["__scopeId","data-v-6be86080"]]),K0={class:"content"},G0={class:"sidebar-container left"},z0=Re({__name:"MainApp",emits:["hide"],setup(t,{emit:e}){const s=e,r=De(),i=se(!1),n=se(),o=se(),a=se(),c=wt(()=>r.activeCall?"activeCall":"newCall"),d=wt(()=>r.isActiveCallAvailable&&!i.value),l=()=>{const y=n.value;y&&y.scrollTop+y.clientHeight>=y.scrollHeight-1/100*y.scrollHeight&&o.value.loadMore()},u=async({displayType:y})=>{console.info("opening",y),await et(),i.value=!0},p=async()=>{await et(),i.value=!1};return ht(()=>[i.value,c.value],()=>{i.value&&c.value==="newCall"&&et().then(()=>a.value.inputNumberRef.focus())},{immediate:!1}),(y,w)=>(V(),J("div",{style:ae(q(r).cssVars),class:"main-wrapper"},[m("div",K0,[m("div",G0,[q(r).isUserLoggedIn?(V(),J(pe,{key:0},[ue(Tg,{"is-show-preview-banner":d.value,class:"the-header",call:q(r).activeCall,onClose:w[0]||(w[0]=C=>s("hide")),onShowRightContent:w[1]||(w[1]=C=>u({displayType:C.displayType}))},null,8,["is-show-preview-banner","call"]),m("div",{ref_key:"theScrollbarCustomRef",ref:n,class:"sidebar-list",onScroll:l},[ue(Mp,{ref_key:"leftContentRef",ref:o},null,512)],544),m("div",{style:ae(q(r).cssVars),class:"footer"},w[3]||(w[3]=[m("pre",null,"© C-ICare 2025",-1)]),4)],64)):(V(),Xe(Y0,{key:1}))]),mt(m("div",{class:Te(["sidebar-container right",{visible:i.value}])},[ue(N0,{ref_key:"theRigtContentRef",ref:a,call:q(r).activeCall,"display-mode":c.value,onHide:p,"onUpdate:displayType":w[2]||(w[2]=C=>c.value=C)},null,8,["call","display-mode"])],2),[[tr,i.value]])])],4))}}),X0=os(z0,[["__scopeId","data-v-4444ee06"]]),J0=Re({__name:"App",props:{token:{default:"U2FsdGVkX18u3JgG5dxk9o3jUQ/gJwvQFjuVcDYnNQkFShP2TX03kvSTfkv9+4nhFHvVEDYnsoJm9yYK2SmOYD5lOJIKvxqLPWV6zmVTMlpkF9br+bBYvc7+YatwDImb"},extension:{default:"20001"},secret:{default:"20001_pr3D!x143"}},setup(t){uu(u=>({a9218508:q(s).cssVars["--primary-bg"],"0641310a":q(s).cssVars["--secondary-bg"],"15fc596b":q(s).cssVars["--grey"],"31cdc29a":q(s).cssVars["--white"],"7a33768c":q(s).cssVars["--primary"],"5ebb9bbc":q(s).cssVars["--light-front"],"3d259e1e":q(s).cssVars["--dark-front"],"20672c4d":q(s).cssVars["--success"],"407628d2":q(s).cssVars["--error"],"022a4484":q(s).cssVars["--secondary"],"68c9b38c":q(s).cssVars["--accent-1"],"192dfb7a":q(s).cssVars["--info"]}));const e=t,s=De(),r=fr(),i=Bt(),n=se(!1),o=se(!0),a=se(),c=se(),d=u=>{a.value&&!a.value.contains(u.target)&&(n.value=!1)},l=wt(()=>{var y;const u=!!s.activeCall,p=((y=i.sipStatus.registerStatus)==null?void 0:y.toLocaleLowerCase())==="registered";return!u&&p});return ht(()=>[l.value,r.idleInterval],()=>{const u=l.value,p=!!r.idleInterval;u&&!p&&r.fetchPhoneDataOnInterval()},{immediate:!1}),ht(()=>s.activeCall,u=>{u&&!n.value&&(n.value=!0)}),pr(async()=>{i.InitiateLocalMedia(),await s.validateWidget({token:e.token}),await et(),r.idleInterval&&r.fetchPhoneDataOnInterval(),await s.signInWidget({extension:e.extension,secret:e.secret}),document.addEventListener("click",d)}),di(()=>{removeEventListener("click",d)}),(u,p)=>(V(),J("div",{ref_key:"widgetContainer",ref:a,class:"widget right"},[ue(X0,{class:Te(["main-content",{open:n.value}]),onHide:p[0]||(p[0]=y=>n.value=!1)},null,8,["class"]),o.value?(V(),J("div",{key:0,ref_key:"theWidgetIconRef",ref:c,style:ae(q(s).cssVars),class:Te(["widget-icon-wrapper chat-toggle",[{"active-call":!!q(s).activeCall},{"mic-not-allowed":!q(i).localMediaPermission}]]),onClick:p[1]||(p[1]=y=>n.value=!n.value)},[ue(Fr,{class:"widget-icon",color:"#fafafa"})],6)):Ge("",!0)],512))}}),Z0=os(J0,[["__scopeId","data-v-13d4732f"]]),Gi=document.querySelector("#c-dialer"),Yn=Iu(Z0,{...Gi==null?void 0:Gi.dataset});Yn.use(df());Yn.use(Mg);Yn.mount("#call-widget-app");
